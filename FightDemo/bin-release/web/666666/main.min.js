function debug(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n]}function sayError(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n]}var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},DLG;!function(e){var t=function(t){function n(){return t.call(this)||this}return __extends(n,t),Object.defineProperty(n.prototype,"skinName",{get:function(){var e=this;return e.$Component[1]},set:function(e){var t=this,n=t.$Component;if(n[5]=!0,n[1]!=e){if(e)n[1]=e;else if(t.$stage){var a=t.$stage.getImplementation("eui.Theme");if(a){var r=a.getSkinName(t);r&&(n[1]=r)}}t.$parseSkinName()}},enumerable:!0,configurable:!0}),n.prototype.setSkinName=function(e){this.skinName=e},n.prototype.setData=function(e){var t=this;t._data=e},n.prototype.getData=function(e){var t=this;return t._data},n.prototype.removeFromParent=function(){var e=this;e.parent&&e.parent.removeChild(e)},n.prototype.onDestroy=function(){var t=this;return t._data=null,void 0!=t.UUID?void e.FactoryUtils.onReturnComp(this):(e.Utils.onDestroy(t),t.setSkin(null),void(t.$Component[1]=null))},n}(eui.Component);t.CLASSNAME="DLG.CComponent",e.CComponent=t,__reflect(t.prototype,"DLG.CComponent",["DLG.IComponent","eui.UIComponent","egret.DisplayObject"]);var n=function(t){function n(){return t.call(this)||this}return __extends(n,t),n.prototype.setSkinName=function(e){},n.prototype.setData=function(e){var t=this;t._data=e},n.prototype.getData=function(e){var t=this;return t._data},n.prototype.removeFromParent=function(){var e=this;e.parent&&e.parent.removeChild(this)},n.prototype.onDestroy=function(){var t=this;return t._data=null,1!=t.alpha&&(t.alpha=1),0!=t.x&&(t.x=0),0!=t.y&&(t.y=0),0!=t.anchorOffsetX&&(t.anchorOffsetX=0),0!=t.anchorOffsetY&&(t.anchorOffsetY=0),1!=t.scaleX&&(t.scaleX=1),1!=t.scaleY&&(t.scaleY=1),t.layout&&(t.layout=void 0),void 0!=t.UUID?void e.FactoryUtils.onReturnComp(this):void e.Utils.onDestroy(this)},n}(eui.Group);e.CGroup=n,__reflect(n.prototype,"DLG.CGroup",["DLG.IComponent","eui.UIComponent","egret.DisplayObject"]);var a=function(t){function n(e,n,a){var r=t.call(this,e,n,a)||this,o=r;return o.touchEnabled=!1,r}return __extends(n,t),n.prototype.setSkinName=function(e){this.skinName=e},n.prototype.setData=function(e){},n.prototype.getData=function(e){return null},n.prototype.removeFromParent=function(){var e=this;e.parent&&e.parent.removeChild(this)},n.prototype.onDestroy=function(){var t=this;return void 0!=t.UUID?void e.FactoryUtils.onReturnComp(this):void 0},n}(eui.Rect);e.CRect=a,__reflect(a.prototype,"DLG.CRect",["DLG.IComponent","eui.UIComponent","egret.DisplayObject"]);var r=function(t){function n(){var e=t.call(this)||this,n=e;return n.touchEnabled=!1,e}return __extends(n,t),n.prototype.setSkinName=function(e){this.skinName=e},n.prototype.setData=function(e){},n.prototype.getData=function(e){return null},n.prototype.removeFromParent=function(){var e=this;e.parent&&e.parent.removeChild(this)},n.prototype.onDestroy=function(){var t=this;return void 0!=t.UUID?void e.FactoryUtils.onReturnComp(this):void 0},n}(eui.TextInput);e.CTextInput=r,__reflect(r.prototype,"DLG.CTextInput",["DLG.IComponent","eui.UIComponent","egret.DisplayObject"]);var o=function(t){function n(){var e=t.call(this)||this,n=e;return n.touchEnabled=!1,e}return __extends(n,t),n.prototype.setSkinName=function(e){},n.prototype.setData=function(e){var t=this;t._data=e},n.prototype.getData=function(e){var t=this;return t._data},n.prototype.removeFromParent=function(){var e=this;e.parent&&e.parent.removeChild(this)},n.prototype.onDestroy=function(){var t=this;return t._data=null,void 0!=t.UUID?void e.FactoryUtils.onReturnComp(this):void 0},n}(eui.Label);e.CLabel=o,__reflect(o.prototype,"DLG.CLabel",["DLG.IComponent","eui.UIComponent","egret.DisplayObject"]);var i=function(t){function n(){var e=t.call(this)||this,n=e;return n.liveDragging=!0,e}return __extends(n,t),n.prototype.setSkinName=function(e){},Object.defineProperty(n.prototype,"skinName",{get:function(){var e=this;return e.$Component[1]},enumerable:!0,configurable:!0}),n.prototype.setData=function(e){},n.prototype.getData=function(e){},n.prototype.removeFromParent=function(){var e=this;e.parent&&e.parent.removeChild(this)},n.prototype.onTrackTouchBegin=function(e){t.prototype.onTrackTouchBegin.call(this,e);var n=this;n.thumb.once(egret.TouchEvent.TOUCH_MOVE,n.onThumbTouchBegin,this)},n.prototype.onDestroy=function(){var t=this;return t._data=null,void 0!=t.UUID?void e.FactoryUtils.onReturnComp(this):(t.$SliderBase=null,e.Utils.onDestroy(this),t.setSkin(null),void(t.$Component[1]=null))},n}(eui.HSlider);e.CHSlider=i,__reflect(i.prototype,"DLG.CHSlider",["DLG.IComponent","eui.UIComponent","egret.DisplayObject"]);var l=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.prototype.setSkinName=function(e){},n.prototype.setData=function(e){throw new Error("请使用dataProvider方法")},n.prototype.getData=function(e){throw new Error("请使用dataProvider方法")},n.prototype.removeFromParent=function(){var e=this;e.parent&&e.parent.removeChild(this)},n.prototype.onDestroy=function(){var t=this;if(t._data=null,void 0!=t.UUID)return void e.FactoryUtils.onReturnComp(this);var n=t.dataProvider;n&&(n.removeAll(),t.itemRenderer=null,t.dataProvider=null),e.Utils.onDestroy(this)},n}(eui.List);e.CList=l,__reflect(l.prototype,"DLG.CList",["DLG.IComponent","eui.UIComponent","egret.DisplayObject"]);var s=function(e){function t(){var t=e.call(this)||this;t._selected=!1,t.itemIndex=-1,t.isInitView=!1,t.touchCaptured=!1;var n=t;return n.addEventListener(egret.TouchEvent.TOUCH_BEGIN,n.onTouchBegin,t),n.addEventListener(eui.UIEvent.CREATION_COMPLETE,n.createCompleteEvent,t),t}return __extends(t,e),Object.defineProperty(t.prototype,"data",{get:function(){var e=this;return e._data},set:function(e){var t=this;t.setData(e)},enumerable:!0,configurable:!0}),t.prototype.setData=function(e){var t=this;t._data=e,eui.PropertyEvent.dispatchPropertyEvent(t,eui.PropertyEvent.PROPERTY_CHANGE,"data"),egret.callLater(t.dataChanged,t)},t.prototype.dataChanged=function(){var e=this;0==e.isInitView},Object.defineProperty(t.prototype,"selected",{get:function(){var e=this;return e._selected},set:function(e){var t=this;t._selected!=e&&(t._selected=e,t.invalidateState())},enumerable:!0,configurable:!0}),t.prototype.onTouchCancle=function(e){var t=this;t.touchCaptured=!1;var n=e.$currentTarget;n.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,t.onTouchCancle,this),n.removeEventListener(egret.TouchEvent.TOUCH_END,t.onStageTouchEnd,this),t.invalidateState()},t.prototype.onTouchBegin=function(e){var t=this;t.$stage.addEventListener(egret.TouchEvent.TOUCH_CANCEL,t.onTouchCancle,this),t.$stage.addEventListener(egret.TouchEvent.TOUCH_END,t.onStageTouchEnd,this),t.touchCaptured=!0,t.invalidateState(),e.updateAfterEvent()},t.prototype.onStageTouchEnd=function(e){var t=this,n=e.$currentTarget;n.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,t.onTouchCancle,this),n.removeEventListener(egret.TouchEvent.TOUCH_END,t.onStageTouchEnd,this),t.touchCaptured=!1,t.invalidateState()},t.prototype.invalidateState=function(){e.prototype.invalidateState.call(this);var t=this;t.select_mc&&(t.select_mc.visible=t.selected),t.up_mc&&(t.up_mc.visible=!t.selected)},t.prototype.getCurrentState=function(){var e="up",t=this;if(t.enabled||(e="disabled"),t.touchCaptured&&(e="down"),t._selected){var n=e+"AndSelected",a=t.skin;return a&&a.hasState(n)?n:"disabled"==e?"disabled":"down"}return e},t.prototype.createCompleteEvent=function(e){var t=this;t.removeEventListener(eui.UIEvent.CREATION_COMPLETE,t.createCompleteEvent,this),t.isInitView=!0,egret.callLater(t.dataChanged,this),t.invalidateState()},t.prototype.$onAddToStage=function(t,n){e.prototype.$onAddToStage.call(this,t,n);var a=this;a.addEventListener(eui.UIEvent.CREATION_COMPLETE,a.createCompleteEvent,this)},t.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this);var t=this;t.removeEventListener(eui.UIEvent.CREATION_COMPLETE,t.createCompleteEvent,this)},t.prototype.onDestroy=function(){var t=this;t.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,t.onTouchBegin,this),e.prototype.onDestroy.call(this)},t}(t);e.CItemRenderer=s,__reflect(s.prototype,"DLG.CItemRenderer",["eui.IItemRenderer"])}(DLG||(DLG={}));var DLG;!function(e){var t=function(t){function n(){return t.call(this)||this}return __extends(n,t),n.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.setScaleClick(!1),this.m_bEnable=!0,egret.callLater(this.renderDraw,this)},n.prototype.setScaleClick=function(t){var n;n=this,e.DLGCore.event.removeEventListener(n),t?e.DLGCore.event.addTouchScaleListener(n,this,this.onClick):e.DLGCore.event.addTouchTapListener(n,this,this.onClick)},n.prototype.setLabel=function(e){throw new Error("CBmpButton不能使用此方法")},n.prototype.setOnClickListener=function(e,t,n){this.m_pListenerObj=e,this.m_pListenerFunc=t,this.m_parame=n},n.prototype.onClick=function(){this.m_bEnable&&this.m_pListenerFunc&&(void 0==this.m_parame?this.m_pListenerFunc.call(this.m_pListenerObj):this.m_pListenerFunc.call(this.m_pListenerObj,this.m_parame))},n.prototype.setEnable=function(e){this.m_bEnable=e},n.prototype.setGray=function(e){this.m_gray=e,egret.callLater(this.renderDraw,this)},n.prototype.setDisabled=function(e){this.m_bEnable=this.m_gray=e,egret.callLater(this.renderDraw,this)},n.prototype.renderDraw=function(){this.up_mc&&(this.m_gray&&null==this.up_mc.filters?this.up_mc.filters=[e.DLGConfig.grayColorFlilter]:this.up_mc.filters=null)},n.prototype.onDestroy=function(){var n;n=this,e.DLGCore.event.removeEventListener(n),this.up_mc&&(this.up_mc.filters=null),this.m_pListenerFunc=null,this.m_pListenerObj=null,this.m_parame=null,t.prototype.onDestroy.call(this)},n}(e.CComponent);e.CBmpButton=t,__reflect(t.prototype,"DLG.CBmpButton",["DLG.IButton"])}(DLG||(DLG={}));var DLG;!function(e){var t=function(){function t(){}return t.init=function(){},t.analysis=function(t){if(void 0==this._table){if(!t)throw new Error("配置文件不存在："+name);this._table=new e.Table,this._table.setData(t)}},t.getCfgById=function(e){var t=this;t._table||t.init();var n;if(n=t._table.getObjById(e),!n)throw new Error("配置文件不存在："+e);return n},t.getDataVec=function(){var e=this;e._table||e.init();var t;return t=e._table.getDatavec()},t}();e.BaseTable=t,__reflect(t.prototype,"DLG.BaseTable")}(DLG||(DLG={}));var game;!function(e){var t=function(t){function n(e){var n=t.call(this)||this;n._loadEnd=!1,n._totalFrame=0,n._playFrame=0;var a=n;return a.touchEnabled=!1,a.setShowMovie(e),n}return __extends(n,t),n.prototype.setShowMovie=function(e){var t=this;1==e&&(t._skinRenderBmp||(t._skinRenderBmp=new egret.Bitmap,t.addChild(t._skinRenderBmp)),t._renderTexture||(t._renderTexture=new egret.RenderTexture),t._rect||(t._rect=new egret.Rectangle),t._skinBitMap||(t._skinBitMap=new egret.Bitmap))},n.prototype.setDirection=function(e){var t=this;t._direction=e},n.prototype.setAction=function(e){var t=this;t._action!=e&&(t._action=e)},n.prototype.goToAndStop=function(e){var t=this;t._isStop=!0,t._playFrame=e,0!=t._loadEnd&&(t.renderSkin(e,!0),t.onPlayFrameCallBack&&t.onPlayFrameCallBack.call(t.onPlayFrameTaget,e,t._totalFrame))},n.prototype.nextFrame=function(){var e=this;if(1!=e._isStop){if(0==e._loadEnd)return void e._playFrame++;var t=e._playFrame;t++,t>e._totalFrame&&(t=1),e.renderSkin(t),e.onPlayFrameCallBack&&e.onPlayFrameCallBack.call(e.onPlayFrameTaget,e._playFrame,e._totalFrame)}},n.prototype.renderSkin=function(e,t){void 0===t&&(t=!0);var n=this;if(n._skinRenderBmp&&(0!=t||n._playFrame!=e)){n._playFrame=e;var a=n._poses[n._playFrame-1],r=a.frame;if(n._rect.x!=r.x||n._rect.y!=r.y){var o=a.spriteSourceSize,i=a.sourceSize;n._rect.x=r.x,n._rect.y=r.y,1==a.rotated?(n._rect.width=r.h,n._rect.height=r.w):(n._rect.width=r.w,n._rect.height=r.h),n._renderTexture.drawToTexture(n._skinBitMap,n._rect);var l=n._skinRenderBmp;l.bitmapData&&l.bitmapData.$dispose(),l.texture&&(l.texture=null),l.texture=n._renderTexture,1==a.rotated?(l.rotation=-90,l.x=o.x-i.w/2,l.y=o.y-i.h/2+r.h):(l.rotation=0,l.x=o.x-i.w/2,l.y=o.y-i.h/2),l.width=n._rect.width,l.height=n._rect.height}}},n.prototype.setMovieName=function(e,t){var n=this;(n._path!=e||n._movieName!=t)&&(n._movieName=t,n._path=e,n._playFrame=0,n._totalFrame=0)},n.prototype.loadMovie=function(){var t,a=this;if(t=0==a._action?a._path+a._movieName+"/"+a._direction:a._path+a._movieName+"/"+n.getActionPath(a._action)+"/"+a._direction,t!=a._url){a._url=t,a._loadEnd=!1,a._rect&&(a._rect.x=-1);var r=e.MovieLoadManager.getInstance(),o=r.getRes(t);o?a.onLoadComplete(a._url,o[0],o[1]):e.MovieLoadManager.getInstance().load(t,a.onLoadComplete,a)}},n.prototype.onLoadComplete=function(e,t,n){var a=this;e==a._url&&(a.unbindJosn(t),a._skinBitMap&&(a._skinBitMap.bitmapData=n),a._loadEnd=!0,0!=a._playFrame?(a._playFrame>a._totalFrame&&(a._playFrame=a._playFrame%a._totalFrame,0==a._playFrame&&(a._playFrame=1)),a.renderSkin(a._playFrame,!0)):a.nextFrame())},n.prototype.unbindJosn=function(e){var t=this;t._totalFrame=0;var n=e.frames,a=0,r=n.length;for(t._poses&&(t._poses.length=0),t._poses=[],a=0;r>a;a++)t._poses[t._totalFrame]=n[a],t._totalFrame++},n.getActionPath=function(t){return t==e.ENUM_DriverAction.attack?"attack":t==e.ENUM_DriverAction.run?"run":t==e.ENUM_DriverAction.stand?"stand":""},n.prototype.destroy=function(){var e=this;e.onPlayFrameCallBack=void 0,e.onPlayFrameTaget=void 0,e._poses=void 0,e._playFrame=0,e._totalFrame=0,e._url=void 0,e._path=void 0,e._movieName=void 0,e._direction=void 0,e._action=void 0,e._isStop=void 0},n}(egret.DisplayObjectContainer);e.MovieSkin=t,__reflect(t.prototype,"game.MovieSkin")}(game||(game={}));var DLG;!function(e){var t=function(t){function n(){return t.call(this)||this}return __extends(n,t),n.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.label_txt&&(this._text=this.label_txt.text)},n.prototype.onClick=function(){if(this.m_bEnable){var e=this._isSelect?this._isSelect:!1;e=!e,this.setSelect(e),this.m_pListenerFunc&&this.m_pListenerFunc.call(this.m_pListenerObj,this.m_parame)}},n.prototype.setLabel=function(e){this._text=e,egret.callLater(this.renderDraw,this)},n.prototype.setLabelColor=function(t){this.textColorArr=e.Utils.strToNumberArray(t.split(",")),egret.callLater(this.renderDraw,this)},n.prototype.setStrokeColor=function(t){this.strokeColorArr=e.Utils.strToNumberArray(t.split(",")),egret.callLater(this.renderDraw,this)},n.prototype.setStroke=function(e){this.stroke=e,egret.callLater(this.renderDraw,this)},n.prototype.setSelect=function(e){this._isSelect=e,egret.callLater(this.renderDraw,this)},n.prototype.isSelect=function(){return this._isSelect},n.prototype.renderDraw=function(){void 0==this._isSelect&&(this._isSelect=!1);var t=this._isSelect;if(t?(this.up_mc&&(this.up_mc.filters=null),this.select_mc&&(this.m_gray&&null==this.select_mc.filters?this.select_mc.filters=[e.DLGConfig.grayColorFlilter]:this.select_mc.filters=null)):(this.up_mc&&(this.m_gray&&null==this.up_mc.filters?this.up_mc.filters=[e.DLGConfig.grayColorFlilter]:this.up_mc.filters=null),this.select_mc&&null!=this.select_mc.filters&&(this.select_mc.filters=null)),this.up_mc&&this.up_mc.visible==t&&(this.up_mc.visible=!t),this.select_mc&&this.select_mc.visible==!t&&(this.select_mc.visible=t),this.label_txt){var n=this.label_txt;this.textColorArr&&(n.textColor=t?this.textColorArr[1]:this.textColorArr[0]),this.strokeColorArr&&(n.strokeColor=t?this.strokeColorArr[1]:this.strokeColorArr[0]),this.stroke&&(n.stroke=this.stroke),n.text=this._text}},n.prototype.onDestroy=function(){this.select_mc&&(this.select_mc.filters=null),this.textColorArr=null,this.strokeColorArr=null,this._text=null,t.prototype.onDestroy.call(this)},n}(e.CBmpButton);e.CButton=t,__reflect(t.prototype,"DLG.CButton",["DLG.ISelect","DLG.IComponent","eui.UIComponent","egret.DisplayObject"])}(DLG||(DLG={}));var DLG;!function(e){var t=function(){function t(){}return t.prototype.createSocket=function(){this.m_socket=e.DLGCore.socket},t.prototype.createClock=function(){this.m_clock=e.DLGCore.clock},t.prototype.createEvent=function(){this.m_event=e.DLGCore.event},t.prototype.createLan=function(){this.m_lan=e.DLGCore.lan},t.prototype.createSound=function(){this.m_sound=e.DLGCore.sound},t.prototype.createPanelMar=function(){this.m_panelMar=e.DLGCore.panel},t.prototype.onExecute=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.onDestroy=function(){var e=this;e.m_socket&&(e.m_socket=null),e.m_clock&&(e.m_clock=null),e.m_event&&(e.m_event=null),e.m_lan&&(e.m_lan=null),e.m_sound&&(e.m_sound=null),e.m_panelMar&&(e.m_panelMar=null)},t}();e.BaseAction=t,__reflect(t.prototype,"DLG.BaseAction",["DLG.IBaseAction"])}(DLG||(DLG={}));var DLG;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.changeDataTouchListener=!0,t.selectIndex=-1,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.toggleArr=[];var t=this.toggleArr,n=0,a=this.numChildren;for(n=0;a>n;n++){var r=this.getChildAt(n);t.push(r),r.setOnClickListener(this,this.selectHandler,t.length-1)}},t.prototype.setOnChangeListener=function(e,t,n){this.m_pListenerObj=e,this.m_pListenerFunc=t,this.m_parame=n},t.prototype.setIndex=function(e,t){var n,a=this.toggleArr,r=0,o=a.length,i=(this.selectIndex,this._checkCanClickFunc);if(i){var l=i.call(this._checkCanClickFuncObj,t);if(0==l)return}for(r=0;o>r;r++)n=a[r],r==t?((0==n.isSelect()||0==this.changeDataTouchListener)&&this.m_pListenerFunc&&this.m_pListenerFunc.call(this.m_pListenerObj,t,this.m_parame),this.selectIndex=r,n.setSelect(!0)):n.setSelect(!1)},t.prototype.push=function(e){var t=this.toggleArr;t.push(e),e.setOnClickListener(this,this.selectHandler,t.length-1)},t.prototype.getItem=function(e){var t=this.toggleArr[e];return t},t.prototype.checkCanClickFuncArr=function(e,t){this._checkCanClickFunc=e,this._checkCanClickFuncObj=t},t.prototype.selectHandler=function(e){this.setIndex(!0,e)},t.prototype.onDestroy=function(){for(var t,n=this.toggleArr;n.length>0;)this.parent,t=n.shift(),t.parent&&this.removeChild(t);n=null,this.m_pListenerFunc=null,this.m_pListenerObj=null,this.m_parame=null,this._checkCanClickFunc=null,this._checkCanClickFuncObj=null,e.prototype.onDestroy.call(this)},t}(e.CGroup);e.CRadioGroup=t,__reflect(t.prototype,"DLG.CRadioGroup")}(DLG||(DLG={}));var DLG;!function(e){var t=function(t){function n(e,n,a){var r=t.call(this)||this;return r.lan=null,r.m_panelId=e,r.m_subPanelId=n,r.m_subPanelId?r.name="View_"+r.m_panelId+"_"+r.m_subPanelId:r.name="View_"+r.m_panelId,r.m_fromPanelId=a,r}return __extends(n,t),n.prototype.onShow=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.lan=e.DLGCore.lan},n.prototype.initView=function(){var e=this;e.isInitView=!0,egret.callLater(e.onRefresh,e)},n.prototype.setCloseBtn=function(t){var n=this;n.isInitView&&e.DLGCore.event.addScaleListener(t,.9,n,n.onBack)},n.prototype.onBack=function(t){if(this.m_fromPanelId){var n=this.m_fromPanelId.split("_"),a=e.DLGCore.panel.show(parseInt(n[0]));a instanceof e.VTabPanel&&a.onOpenIndex(parseInt(n[1])),n.length=0,n=null}else e.DLGCore.panel.close(this.m_panelId)},n.prototype.onRefresh=function(){var e=this;e.isInitView&&e.renderViews()},n.prototype.renderViews=function(){},n.prototype.setMask=function(e){this.m_showMask=e},n.prototype.getMask=function(){return this.m_showMask},n.prototype.getPanelId=function(){return this.m_panelId},n.prototype.onDestroy=function(){var n=this;n.m_subPanelId=void 0,n.m_panelId=void 0,n.isInitView=void 0,n.lan=null,e.DLGCore.event.removeEventListeners(n),t.prototype.onDestroy.call(this)},n}(e.CComponent);e.VPanel=t,__reflect(t.prototype,"DLG.VPanel",["DLG.IPanel"])}(DLG||(DLG={}));var game;!function(e){var t=function(){function t(){}return t.prototype.clearBuff=function(){var t=this;if(t.buffs){var n=0,a=t.buffs.length;for(n=0;a>n;n++)for(var r=t.buffs[n];r.length>0;)e.BuffData.returnBuffData(r.shift())}t.buffsAttr&&t.buffsAttr.clear()},t.prototype.clear=function(){var e=this;e.x=void 0,e.y=void 0,e.id=void 0,e.name=void 0,e.movieName=void 0,e.skills&&e.skills.length>0&&(e.skills.length=0),e.skills=void 0,e.attr&&(e.attr.clear(),e.attr=void 0),e.clearBuff(),e.buffs&&(e.buffs=void 0),e.buffsAttr&&(e.buffsAttr.clear(),e.buffsAttr=void 0)},t}();e.DriverData=t,__reflect(t.prototype,"game.DriverData",["game.IDriverData"])}(game||(game={}));var game;!function(e){var t=function(t){function n(){var n=t.call(this)||this,a=n;return a.touchEnabled=!1,a._direction=e.ENUM_DriverDirection.down,a._bodySkin=new e.MovieSkin(e.GAME_CORE.SHOW_MAP_MOVIE),a._bodySkin.filters=void 0,a._bodySkin.onPlayFrameCallBack=a.onPlayFrameCallBack,a._bodySkin.onPlayFrameTaget=a,a.addChild(a._bodySkin),n}return __extends(n,t),n.prototype.init=function(){var t=this;t._bodySkin.setDirection(t._direction),t._bodySkin.setMovieName(e.GAME_PATH.MOVIE_MONSTER_PATH,t._data.movieName),t.stand(),t.update(),t.stand()},n.prototype.showHpBar=function(t){var n=this;t&&!n._hpBar&&(n._hpBar=new e.HpBar,n._hpBar.showStyle()),n._hpBar&&(t?null==n._hpBar.parent&&n.addChild(n._hpBar):n._hpBar.parent&&n.removeChild(n._hpBar))},n.prototype.showEffect=function(t,n){void 0===n&&(n=1);var a=this;if(0!=t){var r,o=e.EffectTable.getCfgById(t),i=o.movie;if(a._data.driverType==e.ENUM_DriverType.monster){var l=a._data;if(l.isBoss){"0"!=o.bigmovie&&(i=o.bigmovie)}}var s;if(1==o.layer?(a._effectDownSprite||(a._effectDownSprite=new egret.Sprite,a.addChild(a._effectDownSprite)),s=a._effectDownSprite.getChildByName(i)):(a._effectUpSprite||(a._effectUpSprite=new egret.Sprite,a.addChild(a._effectUpSprite)),s=a._effectUpSprite.getChildByName(i)),!s){if(s=e.EffectMovie.createEffectMovie(i),1==o.layer?a._effectDownSprite.addChild(s):a._effectUpSprite.addChild(s),a._data.driverType==e.ENUM_DriverType.monster&&(1==o.site?s.y=a._data.byAttackRangeY+a._data.byAttackRangeH:2==o.site?s.y=a._data.byAttackRangeY:3==o.site&&(s.y=0)),0!=o.py&&(s.y+=o.py),o.range&&r){var c=DLG.Utils.random(-o.range,o.range),u=DLG.Utils.random(-o.range,o.range);s.y+=u,s.x+=c}s.play(n),s.name=i,s.onPlayEndCallBack=a.removeEffectCallBack,s.onPlayEndTaget=a}}},n.prototype.showHitEffect=function(){var e=this;void 0===e._bodySkin.filters&&(e._bodySkin.filters=[DLG.DLGConfig.lightColorFlilter],e.hitEffectID=DLG.DLGCore.clock.addTime(150,1,e.removeHitEffect,e,null))},n.prototype.removeHitEffect=function(){var e=this;e.hitEffectID&&(DLG.DLGCore.clock.removeTime(e.hitEffectID),e.hitEffectID=void 0),e._bodySkin.filters&&(e._bodySkin.filters=[],e._bodySkin.filters=void 0)},n.prototype.removeEffectCallBack=function(){},n.prototype.stand=function(){var t=this;t._actionState=e.ENUM_DriverAction.stand,t._bodySkin.setAction(t._actionState),t._bodySkin.loadMovie()},n.prototype.attack=function(t,n,a,r){var o=this,i=o._data;if(i&&!i.isSwoonTime&&(0==o.isAttack()&&(o._actionState=e.ENUM_DriverAction.attack,o._bodySkin.setAction(o._actionState),o._bodySkin.loadMovie()),i.driverType==e.ENUM_DriverType.monster)){var l=DLG.FactoryUtils.getClass(e.UseSkillAction);l.useSkill(o,t,r)}},n.prototype.run=function(){var t=this;t._data.isSwoonTime||(t._actionState=e.ENUM_DriverAction.run,t._bodySkin.setAction(t._actionState),t._bodySkin.loadMovie())},n.prototype.isAttack=function(){var t=this;return t._actionState==e.ENUM_DriverAction.attack?!0:!1},n.prototype.update=function(){var t=this,n=t._data;n&&(t.x!=n.x&&(t.x=n.x),t.y!=n.y&&(t.y=n.y),t._hpBar&&t._hpBar.parent&&t._hpBar.setValue(n.attr.getValue(e.Enum_Attr.hp),n.attr.getValue(e.Enum_Attr.totalHp)))},n.prototype.nextFrame=function(){var e=this;e._data.isSwoonTime||e._bodySkin.nextFrame()},n.prototype.onPlayFrameCallBack=function(t,n){var a=this;a._actionState==e.ENUM_DriverAction.attack&&t==n&&a.stand()},n.prototype.move=function(){var t=this,n=t._data;if(n&&!n.isSwoonTime){var a=t._data.attr.getValue(e.Enum_Attr.speed);t._direction==e.ENUM_DriverDirection.down?(n.y+=a,t.y=t._data.y):t._direction==e.ENUM_DriverDirection.up&&(n.y-=a,t.y=t._data.y)}},n.prototype.setData=function(e){var t=this;t._data?(t._data=e,t.update()):(t._data=e,t.init())},n.prototype.getData=function(){return this._data},n.prototype.clear=function(){var e=this;e.rotation=0,e.removeHitEffect(),e.showHpBar(!1)},n}(egret.Sprite);e.MonsterDriver=t,__reflect(t.prototype,"game.MonsterDriver",["game.IDriver"])}(game||(game={}));var game;!function(e){var t=function(t){function n(e,n){return t.call(this,e)||this}return __extends(n,t),n.prototype.onShow=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.prototype.onShow.apply(this,e);var a=this;a.main=new SkillVmcView,a.addChild(a.main),a.main.onLoadCallBack=a.initView,a.main.onLoadCallTarget=a,a._timeOutKeyArr=[]},n.prototype.initView=function(){t.prototype.initView.call(this),this._timeOutKeyArr.length=0,this._allVmcNum=0;for(var a=Math.random()<.5?0:1,r=n.VmcConfig[a],o=0;o<r.length;o++){var i=r[o];this._allVmcNum++;var l=new e.VMCView;l.updatePose(i.path,90,!1,!0,"",this.vmcPlayEnd,this),l.play(),this.main.vmc_box.addChild(l),l.x=i.x,l.y=i.y,l.scaleX=i.scaleX,l.scaleY=i.scaleY,this._timeOutKeyArr.push(egret.setTimeout(l.play,l,i.dalay))}},n.prototype.vmcPlayEnd=function(){this._allVmcNum--,this._allVmcNum<=0&&(this.main&&this.main.vmc_box&&this.main.vmc_box.removeChildren(),DLG.DLGCore.panel.close(e.PanelClassConfig.ID_SkillVmcPanel))},n.prototype.onDestroy=function(){for(this.main.vmc_box.removeChildren();this._timeOutKeyArr.length>0;){var e=this._timeOutKeyArr.pop();egret.clearTimeout(e)}t.prototype.onDestroy.call(this);var n=this;n._loadCompeltedFun=null,n._loadCompeltedObj=null,n.main&&(n.main.onLoadCallBack=void 0,n.main.onLoadCallTarget=void 0,n.main.onDestroy()),n.main=void 0},n}(DLG.VPanel);t.VmcConfig=[[{path:"anqi_xj_01",x:300,y:400,dalay:0,scaleX:2,scaleY:2},{path:"anqi_xj_02",x:300,y:400,dalay:0,scaleX:2,scaleY:2},{path:"anqi_xj_03",x:300,y:400,dalay:0,scaleX:2,scaleY:2}],[{path:"anqi_lxz_01",x:300,y:400,dalay:0,scaleX:2,scaleY:2},{path:"anqi_lxz_02",x:300,y:400,dalay:0,scaleX:2,scaleY:2},{path:"anqi_lxz_03",x:300,y:400,dalay:0,scaleX:2,scaleY:2}]],e.SkillVmcPanel=t,__reflect(t.prototype,"game.SkillVmcPanel")}(game||(game={}));var DLG;!function(e){var t=function(){function e(){this.isTapBegin=!1,this.target=null,this.type="",this.listener=null,this.thisObject=null,this.argObject=null,this.useCapture=!1,this.isStopBubble=!1}return e.create=function(t,n,a,r,o,i,l){var s=new e;return s.target=t,s.type=n,s.listener=a,s.thisObject=r,s.argObject=o,s.isStopBubble=i,s.useCapture=l,s},e.prototype.dispose=function(){this.target=null,this.listener=null,this.thisObject=null,this.argObject=null},e}();e.CustomEvent=t,__reflect(t.prototype,"DLG.CustomEvent");var n=function(){function e(){this.m_pEventLists={},this.m_pNotifies={}}return e.prototype.listener=function(e){var t=e.currentTarget;if(this.m_pEventLists[t.hashCode]&&this.m_pEventLists[t.hashCode][e.type]){var n=this.m_pEventLists[t.hashCode][e.type];n.listener.call(n.thisObject,e)}},e.prototype.pushEventList=function(e,n,a,r,o,i,l){this.m_pEventLists[e.hashCode]||(this.m_pEventLists[e.hashCode]={}),this.m_pEventLists[e.hashCode][n]=t.create(e,n,a,r,o,i,l)},e.prototype.addNotify=function(e,n,a,r,o,i){e.addEventListener(n,a,r,o,i),this.m_pNotifies[e.hashCode]||(this.m_pNotifies[e.hashCode]=[]),this.m_pNotifies[e.hashCode].push(t.create(e,n,a,r,null,o))},e.prototype.addEventListener=function(e,t,n,a,r,o,i){this.addNotify(e,t,this.listener,this,r,o),this.pushEventList(e,t,a,n,i,!1,r)},e.prototype.doAnimScale=function(e,t){var n=egret.Tween.get(e),a=t.argObject?t.argObject:1,r=1.1*Number(a);n.to({scaleX:r,scaleY:r},100).to({scaleX:a,scaleY:a},100).call(function(e){e.isTapBegin=!1},this,[t])},e.prototype.onScaleTouch=function(e){var t=e.currentTarget,n=this.m_pEventLists[t.hashCode];if(n&&n[e.type]){var a=n[e.type];a.isStopBubble&&e.stopImmediatePropagation();var r=n[egret.TouchEvent.TOUCH_BEGIN];switch(e.type){case egret.TouchEvent.TOUCH_BEGIN:var o=egret.Tween.get(e.currentTarget);a.isTapBegin=!0,o.to(a.argObject,100);break;case egret.TouchEvent.TOUCH_MOVE:var i=a.argObject?a.argObject:1;if(!a||a.isTapBegin||!r.isTapBegin||e.currentTarget.scaleX==i)return;a.isTapBegin=!0,this.doAnimScale(e.currentTarget,a),r.isTapBegin=!1;break;case egret.TouchEvent.TOUCH_END:case egret.TouchEvent.TOUCH_RELEASE_OUTSIDE:var i=a.argObject?a.argObject:1;if(!a||a.isTapBegin||!r.isTapBegin||e.currentTarget.scaleX==i)return;a.isTapBegin=!0,this.doAnimScale(e.currentTarget,a),r.isTapBegin=!1,a.listener&&a.thisObject&&a.listener.call(a.thisObject,e)}}},e.prototype.addItemRenderAnim=function(e,t){void 0===t&&(t=.9),this.addScaleListener(e,t,null,null,1,!0)},e.prototype.addScaleListener=function(e,t,n,a,r,o,i){void 0===t&&(t=.9),this.addNotify(e,egret.TouchEvent.TOUCH_BEGIN,this.onScaleTouch,this),this.addNotify(e,egret.TouchEvent.TOUCH_END,this.onScaleTouch,this),o&&this.addNotify(e,egret.TouchEvent.TOUCH_MOVE,this.onScaleTouch,this),this.addNotify(e,egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onScaleTouch,this),this.pushEventList(e,egret.TouchEvent.TOUCH_BEGIN,a,n,{scaleX:t,scaleY:t},i),this.pushEventList(e,egret.TouchEvent.TOUCH_END,a,n,r,i),o&&this.pushEventList(e,egret.TouchEvent.TOUCH_MOVE,a,n,r,i),this.pushEventList(e,egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,a,n,r,i)},e.prototype.removeEventListener=function(e){var t,n=e.hashCode,a=this.m_pNotifies[n],r=this.m_pEventLists[n];if(a){for(var o=0;o<a.length;o++)t=a[o],e.removeEventListener(t.type,t.listener,t.thisObject,t.useCapture),t.dispose(),t=null;for(var i in r)t=r[i],t.dispose(),t=null,delete r[i]}this.m_pNotifies[n]=null,this.m_pEventLists[n]=null,delete this.m_pNotifies[n],delete this.m_pEventLists[n]},e.prototype.removeEventListeners=function(e){for(var t in this.m_pEventLists){var n=this.m_pEventLists[t];if(n)for(var a in n){var r=n[a];r.thisObject&&r.thisObject.hashCode==e.hashCode&&this.removeEventListener(r.target)}}},e.prototype.addTouchTapListener=function(e,t,n,a,r,o){this.addEventListener(e,egret.TouchEvent.TOUCH_TAP,t,n,a,r)},e.prototype.addTouchScaleListener=function(e,t,n,a,r,o){this.addScaleListener(e,.9,t),this.addEventListener(e,egret.TouchEvent.TOUCH_TAP,t,n,a,r)},e}();e.EventManager=n,__reflect(n.prototype,"DLG.EventManager")}(DLG||(DLG={}));var DLG;!function(e){var t=function(){function e(){this.isListening=!1;var e=this;e.list=[]}return e.getInstance=function(){var t=this;return t._instance||(t._instance=new e),t._instance},e.prototype.onKeyDown=function(t){var n=e.getInstance(),a=0,r=n.list.length;for(a=0;r>a;a++){var o=n.list[a];o.keyCode==t.keyCode&&o.callback.call(o.target,t)}},e.prototype.addListener=function(t,a,r){var o=egret.getQualifiedClassName(a),i=new n(o,a,t,r),l=e.getInstance();l.list.push(i),0==l.isListening&&(l.isListening=!0,document.addEventListener("keydown",l.onKeyDown))},e}();e.KeyBoardManager=t,__reflect(t.prototype,"DLG.KeyBoardManager");var n=function(){function e(e,t,n,a){this.name="",this.name=e,this.target=t,this.callback=n,this.keyCode=a}return e}();__reflect(n.prototype,"KeyVo")}(DLG||(DLG={}));var DLG;!function(e){var t=function(){function e(){this.m_pLanguage={}}return e.prototype.getLanguage=function(e){var t,n=(e+"").substring(0,3),a=(e+"").substring(3,6),r=this.m_pLanguage[n];return r&&(t=r[a]),t?(t=t.replace(/c@(.+)@/g,'color="$1"'),t=t.replace(/s@(.+)@/g,'size="$1"'),t=t.replace(/f@(.+)@/g,'fontFamily="$1"'),t=t.replace(/</g,"<font "),t=t.replace(/\//g,"</font")):"##Not Exist##"},e.prototype.getLanguageFormat=function(t){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var r=this.getLanguage(t);if("##Not Exist##"==r)return r;r=r.replace(/%%/g,"%");for(var o in n){var i=n[o];
e.SD_REG.test(r)&&(r=r.replace(RegExp.$1,i))}return r},e.prototype.initData=function(e){for(var t=2;t<e.length;t++){var n=e[t][0]+"",a=n.substring(0,3),r=n.substring(3,6);0==this.m_pLanguage.hasOwnProperty(a)&&(this.m_pLanguage[a]={}),this.m_pLanguage[a][r]=e[t][1]}},e.prototype.onLoaded=function(){this.m_iLoadCount+=1,2==this.m_iLoadCount&&(this.m_pLoadedCallback.call(this.m_pCallInstance),this.m_pLoadedCallback=null,this.m_pCallInstance=null)},e}();t.REPLACE_REG=/{[a-zA-Z0-9]+}/,t.SD_REG=new RegExp("(%s|%d)"),e.LanguageManager=t,__reflect(t.prototype,"DLG.LanguageManager")}(DLG||(DLG={}));var DLG;!function(e){var t=function(){function t(){this.init()}return t.prototype.init=function(){var e=this;e._loadVoPoolArr=[],e._movieLoadMap={},e._bmpDataMap={}},t.prototype.getRes=function(e){var t=this;return t._bmpDataMap.hasOwnProperty(e)?t._bmpDataMap[e]:null},t.prototype.load=function(t,n,a){var r=this;if(r._bmpDataMap.hasOwnProperty(t))return void n.call(a,t,r._bmpDataMap[t]);var o;return r._movieLoadMap.hasOwnProperty(t)?(o=r._movieLoadMap[t],void o.addCallBack(n,a)):(o=r._loadVoPoolArr.length>0?r._loadVoPoolArr.pop():new e.LoadVo,o.load(t,n,a),void(r._movieLoadMap[t]=o))},t.prototype.addData=function(e,t){var n=this;n._bmpDataMap[e]=t},t.prototype.returnLoadVo=function(e){this._loadVoPoolArr.push(e)},t}();e.LoadManager=t,__reflect(t.prototype,"DLG.LoadManager")}(DLG||(DLG={}));var DLG;!function(e){var t=function(){function t(){}return t.prototype.init=function(e,t,n){var a=this;a.parentLayer=e,a.openPanelMap={},a.panel_class=t,a.panelModule=n},t.prototype.showDialog=function(t,n,a,r,o,i){var l,s=this;l=new e.VDialog,l.onShow(t,n,a,r,o),void 0==i&&(i=!0),i&&l.setMask(i);var c=s.parentLayer.numChildren-1;return s.parentLayer.getChildAt(c).addChild(l),l},t.prototype.show=function(e,t,n,a,r,o,i){void 0===t&&(t=0);var l,s=this,c=e+"";if(s.openPanelMap.hasOwnProperty(c))return l=s.openPanelMap[c];var u=s.panel_class.getObjById(parseInt(c)),p=s.panelModule[u.classpath];if("ITabPanel"==u.superclass?(l=new p(e,n,r),l.onOpenIndex(t,a)):"IPanel"==u.superclass&&(l=new p(e,n,r)),void 0==l)throw new Error("panel没有实例化");void 0==i&&(i=!0),i&&l.onShow(),o&&l.setMask(o);var m=parseInt(u.layer);return s.parentLayer.getChildAt(m).addChild(l),s.openPanelMap[c]=l,s.checkMask(),l},t.prototype.checkMask=function(){var t,n,a=this;if(!a.m_pMask){var r=e.DLGCore.stage;a.m_pMask=new e.CRect(r.stageWidth,r.stageHeight,0),a.m_pMask.alpha=.5}var o,i=a.m_pMask;i.parent&&(o=i.parent.getChildIndex(i));var l,s=a.parentLayer,c=s.numChildren-1;for(c;c>=0;c--)for(t=s.getChildAt(c),l=t.numChildren-1;l>=0;l--)if(n=t.getChildAt(l),1==n.getMask()){o&&i.parent==t?o!=l&&t.setChildIndex(i,l):t.addChildAt(i,l);break}},t.prototype.close=function(e){var t,n=this,a=e+"";n.openPanelMap.hasOwnProperty(a)&&(t=n.openPanelMap[a]),t&&(t.removeFromParent(),t.onDestroy(),t=null,delete n.openPanelMap[a],n.checkMask())},t.prototype.closeAll=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n,a=this,r=a.openPanelMap,o=[];for(var i in r)if(r.hasOwnProperty(i)){if(e&&-1!=e.indexOf(parseInt(i)))continue;if(n=r[i]){var l=a.panel_class.getObjById(n.getPanelId());1==l.canClose&&(n.removeFromParent(),n.onDestroy(),n=null,r[i]=null,o.push(i))}}for(var s=0;s<o.length;s++)delete a.openPanelMap[o[s]];a.checkMask()},t.prototype.getPanelById=function(e){var t,n=this,a=e+"";return n.openPanelMap.hasOwnProperty(a)&&(t=n.openPanelMap[a]),t},t}();e.PanelManager=t,__reflect(t.prototype,"DLG.PanelManager")}(DLG||(DLG={}));var DLG;!function(e){var t=function(){function e(){this.soundLoad=new RES.SoundAnalyzer,this.soundList={},this.lastClickTime=0}return e.prototype.initSoundList=function(){for(var e=RES.getGroupByName("Sound"),t=0;t<e.length;t++){var n=e[t],a=n.url;-1!=a.indexOf("/sound/Effect/")?n.soundType="effect":-1!=a.indexOf("/sound/Music/")&&(n.soundType="music"),this.soundList[n.name]=n}RES.destroyRes("Sound")},e.prototype.loadSound=function(e,t,n,a,r,o){return void 0===t&&(t=!1),this.isLoad(e)?(t&&this.play(e,n,a),void(r&&(o?r.call(o):r()))):this.soundList[e+"_mp3"]?void this.soundLoad.loadFile(this.soundList[e+"_mp3"],function(){var i=this.soundLoad.getRes(e+"_mp3");this.soundList[e+"_mp3"].sound=i,t&&this.play(e,n,a),r&&(o?r.call(o):r())},this):void sayError("unfind "+e+"_mp3")},e.prototype.isLoad=function(e){return!this.soundLoad.hasRes(e+"_mp3")&&sayError(e+" unload!"),this.soundLoad.hasRes(e+"_mp3")},e.prototype.play=function(t,n,a){if(void 0===t&&(t=e.curMusic),this.isLoad(t)){var r=this.soundList[t+"_mp3"];r.sound&&(r.soundType===egret.Sound.MUSIC&&(e.curMusic=t),r.soundType===egret.Sound.EFFECT&&(a=void 0==a?1:a),r.channel=r.sound.play(n,a),r.isPlay=!0,r.loops=a)}},e.prototype.isPlay=function(t){return void 0===t&&(t=e.curMusic),this.isLoad(t)?this.soundList[t+"_mp3"].isPlay:void 0},e.prototype.stop=function(t){if(void 0===t&&(t=e.curMusic),this.isLoad(t)){var n=this.soundList[t+"_mp3"];n.isPlay&&(n.channel.stop(),n.channel=null,n.isPlay=!1)}},e.prototype.stopAllEffect=function(){for(var e in this.soundList){var t=this.soundList[e];if(t.sound&&t.soundType===egret.Sound.EFFECT){var n=t.name.slice(0,-4);this.stop(n)}}},e.prototype.pause=function(t){if(void 0===t&&(t=e.curMusic),this.isLoad(t)){var n=this.soundList[t+"_mp3"];n.isPlay&&(n.position=n.channel.position,this.stop(t))}},e.prototype.resume=function(t){if(void 0===t&&(t=e.curMusic),this.isLoad(t)){var n=this.soundList[t+"_mp3"];if(!n.isPlay&&void 0!==n.isPlay){var a=n.loops,r=n.position;this.play(t,r,a)}}},e.prototype.position=function(e){return this.isLoad(e)?this.soundList[e+"_mp3"].channel.position:void 0},e.prototype.setVolume=function(e,t){this.isLoad(e)&&(this.soundList[e+"_mp3"].channel.volume=t>1?1:t)},e.prototype.getVolume=function(e){return this.isLoad(e)?this.soundList[e+"_mp3"].channel.volume:void 0},e.prototype.removeSound=function(e){if(this.isLoad(e)){var t=this.soundList[e+"_mp3"];t.sound.close(),this.stop(e),this.soundLoad.destroyRes(e+"_mp3")}},e}();e.SoundManager=t,__reflect(t.prototype,"DLG.SoundManager")}(DLG||(DLG={}));var DLG;!function(e){var t=function(){function e(e){void 0===e&&(e=null),e&&(this.serverUrl=e)}return e.prototype.paramsBuilder=function(e){var t=[];if("object"==typeof e){var n;for(n in e)t.push(n+"="+e[n]);return t.join("&")}return"string"==typeof e?e:""},e.prototype.send=function(e,t,n,a){this.returnFunc=t,this.target=n,this.request=new egret.HttpRequest;var r=this.request,o=this.paramsBuilder(a);e==egret.HttpMethod.POST?r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"):(this.serverUrl+="?"+o,o=""),debug("serverUrl:"+this.serverUrl),r.responseType=egret.HttpResponseType.TEXT,r.open(this.serverUrl,e),r.send(a),r.addEventListener(egret.Event.COMPLETE,this.onGetComplete,this),r.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this),r.addEventListener(egret.ProgressEvent.PROGRESS,this.onGetProgress,this)},e.prototype.onGetComplete=function(e){var t=e.currentTarget,n="JSON"==this.responseType?JSON.parse(t.response):t.response;null!=this.returnFunc&&this.returnFunc.call(this.target,n),this.destory()},e.prototype.onGetIOError=function(e){sayError("get error : "+e),this.destory()},e.prototype.onGetProgress=function(e){debug("get progress : "+Math.floor(100*e.bytesLoaded/e.bytesTotal)+"%")},e.prototype.destory=function(){var e=this.request;e.removeEventListener(egret.Event.COMPLETE,this.onGetComplete,this),e.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this),e.removeEventListener(egret.ProgressEvent.PROGRESS,this.onGetProgress,this),this.returnFunc=null,this.request=null},e}();e.HttpClient=t,__reflect(t.prototype,"DLG.HttpClient")}(DLG||(DLG={}));var DLG;!function(e){var t=function(){function e(){this.m_bIsConnected=!1,this.analysisSymbolArr=["$","%","^","&"]}return e.prototype.onConnectByUrl=function(e,t,n,a){var r=this;r.m_pIp=e,r.m_pRequestDataCalls={},r.m_pRequestViewCalls={},r.m_pSocket=new egret.WebSocket,r.m_pSocket.addEventListener(egret.ProgressEvent.SOCKET_DATA,r.onReceive,r),r.m_pSocket.addEventListener(egret.Event.CONNECT,r.onConnected,r),r.m_pSocket.addEventListener(egret.Event.CLOSE,r.onClose,r),r.m_pSocket.addEventListener(egret.IOErrorEvent.IO_ERROR,r.onError,r),r.m_pConnectedObj=a,r.m_pConnectedCallback=t,r.m_pConnectedClose=n,r.m_pSocket.connectByUrl(r.m_pIp)},e.prototype.onConnect=function(e,t,n,a,r){var o=this;o.m_pIp=e,o.m_iPort=t,o.m_pRequestDataCalls={},o.m_pRequestViewCalls={},o.m_pSocket=new egret.WebSocket,o.m_pSocket.addEventListener(egret.ProgressEvent.SOCKET_DATA,o.onReceive,o),o.m_pSocket.addEventListener(egret.Event.CONNECT,o.onConnected,o),o.m_pSocket.addEventListener(egret.Event.CLOSE,o.onClose,o),o.m_pSocket.addEventListener(egret.IOErrorEvent.IO_ERROR,o.onError,o),o.m_pConnectedObj=r,o.m_pConnectedCallback=n,o.m_pConnectedClose=a,o.m_pSocket.connect(o.m_pIp,o.m_iPort)},e.prototype.onClose=function(){var e=this;debug("csocket onClose"),e.m_bIsConnected=!1,e.stopHeartbeat(),e.onClear(),e.m_pConnectedClose&&e.m_pConnectedClose.call(e.m_pConnectedObj)},e.prototype.onReceive=function(){var e,t=this,n=t.m_pSocket.readUTF(),a=Number(n.substr(0,5))-5-1e4,r=null;if(2e5>=a&&a>2){if(e=Number(n.substr(5,4)),1e3>e||e>9e3)return;r=n.substr(9,a-4)}debug("接收服务器的数据----->"+e,r);var o,i,l,s=0;if(-1==r.indexOf(">")){if(i="",o=t.m_pRequestDataCalls[e+"_"+i],o&&o[0].call(o[1],JSON.parse(r)),o=t.m_pRequestViewCalls[e+"_"+i])for(a=o.length,s=0;a>s;s++){var c=o[s],u=c[2];u?egret.callLater(c[0],c[1]):c[0].call(c[1])}}else{var p=r.split(">");i=p[0],l=p[1];var m=p[2].split("#");if(t.analysisData(m,t.analysisSymbolArr[0]),o=t.m_pRequestDataCalls[e+"_"+i],o&&o[0].call(o[1],l,m),o=t.m_pRequestViewCalls[e+"_"+i])for(a=o.length,s=0;a>s;s++){var c=o[s],u=c[2];u?egret.callLater(c[0],c[1]):c[0].call(c[1])}}n=null,r=null},e.prototype.analysisData=function(e,t){var n,a=this,r=0,o=e.length,i=a.analysisSymbolArr.indexOf(t);if("&"!=t){a.analysisSymbolArr[i+1]}for(r=0;o>r;r++)if(-1!=e[r].indexOf(t)&&(e[r]=e[r].split(t),n)){var l=-1==e[r].indexOf(n)?!1:!0;l&&a.analysisData(e[r],n)}},e.prototype.onConnected=function(){var e=this;debug("csocket onConnected ok"),e.m_bIsConnected=!0,e.startHeartbeat(),e.m_pConnectedCallback&&e.m_pConnectedCallback.call(e.m_pConnectedObj)},e.prototype.onClear=function(){var e=this;e.m_pSocket&&(e.m_pSocket.removeEventListener(egret.ProgressEvent.SOCKET_DATA,e.onReceive,e),e.m_pSocket.removeEventListener(egret.Event.CONNECT,e.onConnected,e),e.m_pSocket.removeEventListener(egret.Event.CLOSE,e.onClose,e),e.m_pSocket.removeEventListener(egret.IOErrorEvent.IO_ERROR,e.onError,e),e.m_pSocket=null)},e.prototype.onError=function(){var t=this;if(e.tryErrNum<1&&t.m_bIsConnected){sayError("csocket onError");var n=(t.m_pIp,t.m_iPort);void 0==n?t.m_pSocket.connectByUrl(t.m_pIp):t.m_pSocket.connect(t.m_pIp,t.m_iPort),e.tryErrNum+=1}else t.onClose()},e.prototype.onSend=function(e,t,n){var a=this;if(0!=a.m_bIsConnected){var r=JSON.stringify(t);r=r.slice(1,r.length-1),r=e.toString()+r;var o=1e3+r.length+4;r=o.toString()+r+"`~`~",a.m_pSocket.writeUTF(r),debug("发送数据：   "+e,r.toString()),a.m_pSocket.flush(),r=null}},e.prototype.isConnected=function(){var e=this;return e.m_bIsConnected},e.prototype.setHeartbeatPack=function(e,t){var n=this;n.m_pHeartbeatTimerCallback=e,n.m_pHeartbeatTimerObj=t},e.prototype.onDataCallback=function(e,t,n,a){var r=this;if(r.m_pRequestDataCalls[e+"_"+t])throw new Error("重复注册协议");r.m_pRequestDataCalls[e+"_"+t]=[];var o=r.m_pRequestDataCalls[e+"_"+t];o.push(n,a)},e.prototype.onViewCallback=function(e,t,n,a,r,o){void 0===o&&(o=!0);var i=this;i.m_pRequestViewCalls[e+"_"+t]||(i.m_pRequestViewCalls[e+"_"+t]=[]);var l=i.m_pRequestViewCalls[e+"_"+t],s=[n,a,o,r.name];l.push(s)},e.prototype.onRemoveCallBackByView=function(e){},e.prototype.onRemoveCallBack=function(e,t,n){void 0===n&&(n=!0);var a,r,o=this,i=0;if(0==n?(r=o.m_pRequestDataCalls[e+"_"+t],o.m_pRequestDataCalls[e+"_"+t]=null):r=o.m_pRequestViewCalls[e+"_"+t],r){for(a=r.length,i=0;a>i;i++){var l=r[i];l[0]=null,r[i]=null}r=[]}},e.prototype.startHeartbeat=function(){var t=this;debug("startHeartbeat"),null==t.m_pHeartbeatTimer&&(t.m_pHeartbeatTimer=new egret.Timer(1e3*e.TIMER,0),t.m_pHeartbeatTimer.addEventListener(egret.TimerEvent.TIMER,t.checkTimer,t),t.m_pHeartbeatTimer.start())},e.prototype.checkTimer=function(){var e=this;e.m_pHeartbeatTimerCallback&&e.m_pHeartbeatTimerCallback.call(e.m_pHeartbeatTimerObj)},e.prototype.stopHeartbeat=function(){var e=this;e.m_pHeartbeatTimer&&(e.m_pHeartbeatTimer.removeEventListener(egret.TimerEvent.TIMER,e.checkTimer,e),e.m_pHeartbeatTimer.stop(),e.m_pHeartbeatTimer=null),e.m_pRequestDataCalls={},e.m_pRequestViewCalls={}},e}();t.TIMER=30,t.tryErrNum=0,e.Socket=t,__reflect(t.prototype,"DLG.Socket")}(DLG||(DLG={}));var DLG;!function(e){var t=function(){function e(){}return e.getClass=function(e){var t=e.prototype.__class__,n=this.classMap[t];return n||(n=new e,this.classMap[t]=n),n},e.removeClass=function(e){var t=e.prototype.__class__,n=this.classMap[t];n&&(delete this.classMap[t],n.onDestroy())},e.onCreateComp=function(e){var t,n,a=e.prototype.__class__;if(this._uiPoolVec.hasOwnProperty(a)){var r=this._uiPoolVec[a];if(r.length>0)return t=r.shift()}return this._poolUUIDVec.hasOwnProperty(a)?(n=this._poolUUIDVec[a],n++):n=1,this._poolUUIDVec[a]=n,t=new e,t.UUID=a+"_"+n,t},e.onReturnComp=function(e){if(void 0!=e.UUID){var t=e.UUID.split("_");0==this._uiPoolVec.hasOwnProperty(t[0])&&(this._uiPoolVec[t[0]]=[]);var n=this._uiPoolVec[t[0]];n.push(e),t.length=0,t=null}},e}();t.classMap=new Object,t._uiPoolVec={},t._poolUUIDVec={},e.FactoryUtils=t,__reflect(t.prototype,"DLG.FactoryUtils")}(DLG||(DLG={}));var DLG;!function(e){var t=function(){function e(){}return e.setData=function(e,t){egret.localStorage&&egret.localStorage.setItem(this.HEAD_KEY+e,t)},e.getData=function(e){var t;return egret.localStorage&&(t=egret.localStorage.getItem(this.HEAD_KEY+e)),t?t:""},e.removeData=function(e){egret.localStorage&&egret.localStorage.removeItem(this.HEAD_KEY+e)},e}();t.HEAD_KEY="",e.LocalData=t,__reflect(t.prototype,"DLG.LocalData")}(DLG||(DLG={}));var DLG;!function(e){var t=function(){function e(){}return e.MoreKeysSorter=function(e,t,n){var a=0,r=function(e,o){var i=t[a],l=n[a];return e[i]==o[i]?(a+=1,a>t.length?(a=0,0):r(e,o)):(a=0,l==ArraySort.UPPER?e[i]-o[i]:o[i]-e[i])};e.sort(r)},e.sortMap=function(e,t,n){void 0===n&&(n=!0),e.sort(function(e,a){return n?e[t]-a[t]:a[t]-e[t]})},e}();e.SortTools=t,__reflect(t.prototype,"DLG.SortTools")}(DLG||(DLG={}));var DLG;!function(e){var t=function(){function t(){}return t.FormatTime1=function(e,t,n){void 0===n&&(n=!0);var a=t/86400,r=t%86400/3600,o=t%3600/60,i=t%60;new RegExp("(d+)").test(e)||(r+=24*a),new RegExp("(h+)").test(e)||(o+=60*r);var l={"d+":a,"h+":r,"m+":o,"s+":i};for(var s in l)new RegExp("("+s+")").test(e)&&(e=n?e.replace(RegExp.$1,1==RegExp.$1.length?l[s]:1==(""+l[s]).length?"0"+l[s]:l[s]):e.replace(RegExp.$1,l[s]));return e},t.FormatTime2=function(t,n,a){void 0===n&&(n=1),void 0===a&&(a="秒"),n=n||1;var r=t;if(1==n)return e.Utils.stringFormat(a,t);if(2==n){var o=Math.floor(t/60),i=Math.floor(t%60),l=e.Utils.stringFormat(a.slice(0,1),o),s=e.Utils.stringFormat(a.slice(1,2),i);return l+s}if(3==n){var c=Math.floor(t/3600),u=e.Utils.stringFormat(a.slice(0,1),c);r=t%3600;var o=Math.floor(r/60),l=e.Utils.stringFormat(a.slice(1,2),o),i=Math.floor(t%60),s=e.Utils.stringFormat(a.slice(2,3),i);return u+l+s}if(4==n){var p=Math.floor(r/86400),m=e.Utils.stringFormat(a.slice(0,1),p);r=t%86400;var c=Math.floor(r/3600),u=e.Utils.stringFormat(a.slice(1,2),c);r=t%3600;var o=Math.floor(r/60),l=e.Utils.stringFormat(a.slice(2,3),o),i=Math.floor(t%60),s=e.Utils.stringFormat(a.slice(3,4),i);return m+u+l+s}},t.FormatTime3=function(t,n){void 0===n&&(n="天时分秒");var a=t,r=Math.floor(a/86400);a=l%86400;var o=Math.floor(a/3600);a=l%3600;var i=Math.floor(a/60);a=l%60;var l=Math.floor(a)%60;return 0!=r?e.Utils.stringFormat(n.slice(0,1),r)+e.Utils.stringFormat(n.slice(1,2),o):0!=o?e.Utils.stringFormat(n.slice(1,2),o)+e.Utils.stringFormat(n.slice(2,3),i):0!=i?e.Utils.stringFormat(n.slice(2,3),i)+e.Utils.stringFormat(n.slice(3,4),l):(0==l&&(l=1),e.Utils.stringFormat(n.slice(3,4),l))},t}();e.TimeUtil=t,__reflect(t.prototype,"DLG.TimeUtil")}(DLG||(DLG={}));var ArraySort;!function(e){e[e.UPPER=1]="UPPER",e[e.LOWER=2]="LOWER"}(ArraySort||(ArraySort={}));var DLG;!function(e){var t=function(){function e(){}return e.stringFormatArr=function(e,t){var n=e;for(var a in t){var r=t[a];new RegExp("(%s|%d)").test(n)&&(n=n.replace(RegExp.$1,r))}return n},e.stringFormat=function(t){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];return t=t.replace(/%%/g,"%"),e.stringFormatArr(t,n)},e.random=function(e,t){var n=Math.floor(Math.random()*(t-e+1))+e;return n},e.getZipResByUrl=function(e,t,n,a){RES.getResByUrl(e,function(e){if(e){var a=new JSZip(e);t.call(n,a.files)}},this,a)},e.transformResUrl=function(e){return e},e.objectLenght=function(e){var t=Object.keys(e);return t.length},e.strToNumberArray=function(e){var t=[],n=0,a=e.length;for(n=0;a>n;n++)t.push(parseInt(e[n]));return t},e.parseLanRich=function(e){var t=new RegExp("(.*)<color=(.*?)>(.*?)</color>(.*)"),n=null;do if(n=t.exec(e)){var a=RegExp.$2;a=-1==a.indexOf("#")?"#"+a.substr(0,6):a.substr(0,7);var r=RegExp.$1+"<font color='"+a+"'>"+RegExp.$3+"</font>"+RegExp.$4;e=r}while(null!=n);return e},e.parseClickRich=function(e){var t=new RegExp("(.*)<clk=(.*?)>(.*?)</clk>(.*)"),n=null;do if(n=t.exec(e)){var a=RegExp.$2,r=RegExp.$1+"<u><a href='event:"+a+"'>"+RegExp.$3+"</a></u>"+RegExp.$4;e=r}while(null!=n);return e},e.distance=function(e,t,n,a){var r=e-n,o=t-a;return Math.sqrt(r*r+o*o)},e.onDestroy=function(e){for(;e.numChildren>0;){var t=e.removeChildAt(0);if(egret.is(t,"DLG.IComponent"))t.onDestroy();else if(egret.is(t,"eui.Group"))for(;t.numChildren>0;){var n=t.removeChildAt(0);egret.is(n,"IComponent")?n.onDestroy():egret.is(n,"eui.Rect")||sayError("删除了不是CComponent的对象")}else egret.is(n,"eui.Rect")||sayError("删除了不是CComponent的对象")}},e.probabilityIndex=function(e,t,n){if(void 0===t&&(t="|"),void 0===n&&(n=1e4),"0"==e||void 0==e)return-1;var a,r,o,i=e.split(t),l=Math.random(),s=l*n,c=-1;a=0;var u=i.length;for(o=0;u>o;o++)if(r=void 0==i[o]?0:parseInt(i[o]),0!=r){if(s>=a&&r>=s){c=o;break}a+=r}return i.length=0,i=null,c},e}();e.Utils=t,__reflect(t.prototype,"DLG.Utils")}(DLG||(DLG={}));var DLG;!function(e){var t=function(t){function n(e){var n=t.call(this,e)||this;return n.resArr=[],n}return __extends(n,t),Object.defineProperty(n.prototype,"source",{set:function(e){-1==this.resArr.indexOf(e)&&this.resArr.push(e),egret.superSetter(n,this,"source",e)},enumerable:!0,configurable:!0}),n.prototype.setSkinName=function(e){},n.prototype.setData=function(e){throw new Error("请使用source")},n.prototype.getData=function(e){throw new Error("请使用source")},n.prototype.removeFromParent=function(){var e=this;e.parent&&e.parent.removeChild(this),e.onDestroy()},n.prototype.onDestroy=function(){var t=this;if(t.resArr){var n=0,a=t.resArr.length;for(n=0;a>n;n++)RES.destroyRes(t.resArr[n]);t.resArr.length=0,t.resArr=void 0}return void 0!=t.UUID?void e.FactoryUtils.onReturnComp(this):void e.Utils.onDestroy(this)},n}(eui.Image);e.CBigImage=t,__reflect(t.prototype,"DLG.CBigImage",["DLG.IComponent","eui.UIComponent","egret.DisplayObject"])}(DLG||(DLG={}));var DLG;!function(e){var t=function(){function t(){}return t.init=function(t){var n=this;n.stage=t,n.event=new e.EventManager,n.sound=new e.SoundManager,n.sound.initSoundList(),n.lan=new e.LanguageManager,n.socket=new e.Socket,n.panel=new e.PanelManager,n.clock=new e.ClockManager,n.loader=new e.LoadManager},t}();e.DLGCore=t,__reflect(t.prototype,"DLG.DLGCore")}(DLG||(DLG={}));var ApplicationManager=function(){function e(){}return e}();ApplicationManager.CONTENT_W=640,ApplicationManager.CONTENT_H=960,__reflect(ApplicationManager.prototype,"ApplicationManager");var DLG;!function(e){var t=function(t){function n(){return t.call(this)||this}return __extends(n,t),n.prototype.createChildren=function(){var e=this;e.setScaleClick(!1),this.m_bEnable=!0,t.prototype.createChildren.call(this),egret.callLater(this.renderDraw,this)},n.prototype.setScaleClick=function(t){var n;n=this,e.DLGCore.event.removeEventListener(n),t?e.DLGCore.event.addTouchScaleListener(n,this,this.onClick):e.DLGCore.event.addTouchTapListener(n,this,this.onClick)},n.prototype.onClick=function(){this.m_bEnable&&this.m_pListenerFunc&&this.m_pListenerFunc.call(this.m_pListenerObj,this.m_parame)},n.prototype.setOnClickListener=function(e,t,n){this.m_pListenerObj=e,this.m_pListenerFunc=t,this.m_parame=n},n.prototype.setLabel=function(e){throw new Error("CButtonCustom不能使用此方法")},n.prototype.setEnable=function(e){this.m_bEnable=e},n.prototype.setGray=function(e){this.m_gray=e,egret.callLater(this.renderDraw,this)},n.prototype.setDisabled=function(e){this.m_bEnable=this.m_gray=e,egret.callLater(this.renderDraw,this)},n.prototype.isSelect=function(){return this._isSelect},n.prototype.setSelect=function(e){this._isSelect=e,egret.callLater(this.renderDraw,this)},n.prototype.renderDraw=function(){var t=this._isSelect;t?(this.up_Group&&(this.up_Group.filters=null),this.select_Group&&(this.m_gray&&null==this.select_Group.filters?this.select_Group.filters=[e.DLGConfig.grayColorFlilter]:this.select_Group.filters=null)):(this.up_Group&&(this.m_gray&&null==this.up_Group.filters?this.up_Group.filters=[e.DLGConfig.grayColorFlilter]:this.up_Group.filters=null),this.select_Group&&null!=this.select_Group.filters&&(this.select_Group.filters=null)),this.up_Group&&0==this.up_Group.visible&&(this.up_Group.visible=!t),this.select_Group&&1==this.select_Group.visible&&(this.select_Group.visible=t)},n.prototype.onDestroy=function(){var n;n=this,e.DLGCore.event.removeEventListener(n),this.select_Group&&(this.select_Group.filters=null),this.up_Group&&(this.up_Group.filters=null),this.m_pListenerFunc=null,this.m_pListenerObj=null,this.m_parame=null,t.prototype.onDestroy.call(this)},n}(e.CComponent);e.CButtonCustom=t,__reflect(t.prototype,"DLG.CButtonCustom",["DLG.ISelect","DLG.IButton"])}(DLG||(DLG={}));var DLG;!function(e){var t=function(){function e(){}return e}();t.grayMatrix=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],t.grayColorFlilter=new egret.ColorMatrixFilter(t.grayMatrix),t.lightmat=[1,0,0,0,150,0,1,0,0,150,0,0,1,0,150,0,0,0,1,0],t.lightColorFlilter=new egret.ColorMatrixFilter(t.lightmat),e.DLGConfig=t,__reflect(t.prototype,"DLG.DLGConfig")}(DLG||(DLG={}));var DLG;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e._totalFrame=0,e._playIndex=-1,e}return __extends(n,t),n.prototype.setEffectMovie=function(e){var t=this;t._effectName!=e&&RES.getResByUrl(t._effectName,t.onComplete,t,RES.ResourceItem.TYPE_SHEET),t._effectName=e},n.prototype.play=function(t,n,a){void 0===n&&(n=150),void 0===a&&(a=!1);var r=this;r._currentTimes=0,r._totalPlayTimes=t,r._timeId&&(e.DLGCore.clock.removeTime(r._timeId,!1),r._timeId=void 0),r.nextFrameTimes=n,r._playEndRemove=a,r._timeId=e.DLGCore.clock.addTime(r.nextFrameTimes,0,r.nextFrame,r,null)},n.prototype.setPlayEndRemove=function(e){this._playEndRemove=e},n.prototype.getTotalPlayTimes=function(){return this._totalPlayTimes},n.prototype.nextFrame=function(){var e=this;if(e._loadEnd)return void e._playIndex++;var t=e._playIndex;t++,t>=e._totalFrame&&(t=0),e.renderEffect(t),e._playIndex==e._totalFrame-1&&e._totalPlayTimes>0&&(e._currentTimes++,e._currentTimes==e._totalPlayTimes&&(e._playEndRemove&&e.removeFromParent(),e.onPlayEndCallBack&&e.onPlayEndCallBack.call(e.onPlayEndTaget)))},n.prototype.renderEffect=function(e,t){void 0===t&&(t=!0);var n=this;if(0!=t||n._playIndex!=e){n._playIndex=e;var a=e+"";a.length<2&&(a="0"+a);var r=RES.getRes(n._effectName);n._bmp.texture=r.getTexture(a),a=void 0}},n.prototype.onComplete=function(e){var t=this;t._loadEnd=!0,-1!=t._playIndex?(t._playIndex=t._playIndex%t._totalFrame,t.renderEffect(t._playIndex,!0)):t.nextFrame()},n.prototype.destroy=function(){var t=this;t._effectName&&RES.destroyRes(t._effectName),t._timeId&&(e.DLGCore.clock.removeTime(t._timeId,!1),t._timeId=void 0),t._totalPlayTimes=void 0,t._currentTimes=void 0,t._effectName=void 0,t._playIndex=-1},n}(e.CGroup);e.CEffect=t,__reflect(t.prototype,"DLG.CEffect")}(DLG||(DLG={}));var DLG;!function(e){var t=function(t){function n(e,n){var a=t.call(this)||this,r=a;return r._w=e,r._h=n,a}return __extends(n,t),n.prototype.onLoad=function(t){var n=this;n._url!=t&&(n._url=t,n._bmp||(n._bmp=new egret.Bitmap,n.addChild(n._bmp)),n._w&&(n._bmp.width=n._w),n._h&&(n._bmp.height=n._h),e.DLGCore.loader.load(t,n.showBmp,n))},Object.defineProperty(n.prototype,"width",{set:function(e){var t=this;t._w=e,t._bmp&&(t._bmp.width=e)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{set:function(e){var t=this;t._h=e,t._bmp&&(t._bmp.height=e)},enumerable:!0,configurable:!0}),n.prototype.showBmp=function(e,t){var n=this;e==n._url&&(n._bmp.bitmapData=t,n._w||(n.width=t.width),n._h||(n.height=t.height))},n.prototype.setSkinName=function(e){},n.prototype.setData=function(e){var t=this;t._data=e},n.prototype.getData=function(e){var t=this;return t._data},n.prototype.removeFromParent=function(){var e=this;e.parent&&e.parent.removeChild(e)},n.prototype.onDestroy=function(){var t=this;return t._url=void 0,t._w=void 0,t._h=void 0,t._bmp&&(t.removeChild(t._bmp),t._bmp.bitmapData&&(t._bmp.bitmapData=void 0)),void 0!=t.UUID?(e.FactoryUtils.onReturnComp(t),void(t.UUID=void 0)):void e.Utils.onDestroy(t)},n}(e.CComponent);e.CIcon=t,__reflect(t.prototype,"DLG.CIcon")}(DLG||(DLG={}));var DLG;!function(e){var t=function(t){function n(e){return t.call(this,e)||this}return __extends(n,t),Object.defineProperty(n.prototype,"source",{set:function(e){egret.superSetter(n,this,"source",e)},enumerable:!0,configurable:!0}),n.prototype.setSkinName=function(e){},n.prototype.setData=function(e){throw new Error("请使用source")},n.prototype.getData=function(e){throw new Error("请使用source")},n.prototype.removeFromParent=function(){var e=this;e.parent&&e.parent.removeChild(this)},n.prototype.onDestroy=function(){var t=this;return t.texture&&t.texture.bitmapData&&(t.texture=void 0),void 0!=t.UUID?(e.FactoryUtils.onReturnComp(this),t.UUID=void 0,void(t.source=void 0)):void e.Utils.onDestroy(this)},n}(eui.Image);e.CImage=t,__reflect(t.prototype,"DLG.CImage",["DLG.IComponent","eui.UIComponent","egret.DisplayObject"])}(DLG||(DLG={}));var DLG;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e._selectIndex=-1,e}return __extends(n,t),n.prototype.createChildren=function(){t.prototype.createChildren.call(this);for(var e=this;e.numChildren>0;)e.removeChildAt(0);e.setLayout(new eui.VerticalLayout)},n.prototype.setOnChangeListener=function(e,t,n){this.m_pListenerObj=e,this.m_pListenerFunc=t,this.m_parame=n},n.prototype.onShowScroll=function(e){this.m_showScroll=e},n.prototype.setItemRenderer=function(e){this._itemRender=e},n.prototype.dataProvider=function(t){for(var n=this;n.numChildren>0;)e.FactoryUtils.onReturnComp(n.removeChildAt(0));n._data=t;var a=0,r=t.length;for(a=0;r>a;a++){var o=e.FactoryUtils.onCreateComp(n._itemRender);o.setData(t[a]),n.addChild(o),o.setOnClickListener(n,n.selectHandler,a)}},n.prototype.selectHandler=function(e){this.selectedIndex=e},Object.defineProperty(n.prototype,"selectedIndex",{get:function(){return this._selectIndex},set:function(e){var t=this;t._selectIndex=e;var n,a=0,r=t.numChildren;for(a=0;r>a;a++)n=t.getChildAt(a),a==e?(this.m_pListenerFunc&&this.m_pListenerFunc.call(this.m_pListenerObj,e,this.m_parame),n.setSelect(!0)):n.setSelect(!1)},enumerable:!0,configurable:!0}),n.prototype.setLayout=function(e){var t=this;t.layout=e},n.prototype.setAlign=function(e){var t=this,n=t.layout;n.horizontalAlign=e},n.prototype.setGap=function(e){var t=this,n=t.layout;n.gap=e},n.prototype.renderDraw=function(){},n.prototype.onDestroy=function(){var e=this;e.m_pListenerFunc=null,e.m_pListenerObj=null,e.m_parame=null,e._itemRender=null,t.prototype.onDestroy.call(this)},n}(e.CGroup);e.CNewList=t,__reflect(t.prototype,"DLG.CNewList")}(DLG||(DLG={}));var DLG;!function(e){var t=function(t){function n(){var e=t.call(this)||this;e._num=-1;var n=e;n.touchEnabled=!1,n.touchChildren=!1;var a=new eui.HorizontalLayout;return n.layout=a,n._numbmp=[],e}return __extends(n,t),n.prototype.createChildren=function(){t.prototype.createChildren.call(this);var e,n=this;e=n.getChildAt(0);var a=e.source;n._soureUrl=a.slice(0,a.length-1),egret.callLater(n.renderDraw,n)},n.prototype.setAlign=function(e){var t=this,n=t.layout;n.horizontalAlign=e},n.prototype.setGap=function(e){var t=this,n=t.layout;n.gap=e},n.prototype.setValue=function(e){var t=this;t._num=e,egret.callLater(t.renderDraw,t)},n.prototype.renderDraw=function(){var t=this;if(t._soureUrl){var n=t._num+"",a=n.length,r=void 0,o=t.numChildren,i=void 0;for(i=0;a>i;i++)o>i?r=t.getChildAt(i):(r=t._numbmp.length>0?t._numbmp.shift():new e.CImage,t.addChild(r)),r.source=t._soureUrl+n.slice(i,i+1)+"_png";for(;t.numChildren>a;)r=t.getChildAt(i),t._numbmp.push(r)}},n.prototype.onDestroy=function(){var e=this;e._soureUrl=null,e.layout=null;for(var n;e._numbmp.length>0;)n=e._numbmp.shift(),n.onDestroy(),n.removeFromParent();e._numbmp=null,e.layout=null,t.prototype.onDestroy.call(this)},n}(e.CGroup);e.CNumClip=t,__reflect(t.prototype,"DLG.CNumClip")}(DLG||(DLG={}));var DLG;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.thumbInitX=0,e.thumbInitY=0,e._direction=eui.Direction.LTR,e._labelFunction=null,e}return __extends(n,t),n.prototype.createChildren=function(){t.prototype.createChildren.call(this);var e=this.thumb;this.thumbInitX=e.x,this.thumbInitY=e.y;var n=this.getChildIndex(this.thumb);this.thumbMask=new eui.Rect,n>=this.numChildren?this.addChild(this.thumbMask):this.addChildAt(this.thumbMask,n+1),this.invalidateDisplayList()},Object.defineProperty(n.prototype,"direction",{get:function(){return this._direction},set:function(e){this._direction!=e&&(this._direction=e,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),n.prototype.updateDisplayList=function(e,n){t.prototype.updateDisplayList.call(this,e,n),egret.callLater(this.updateSkinDisplayList,this)},n.prototype.updateSkinDisplayList=function(){var e=this.value,t=this.maximum,n=this.thumb,a=this.thumbMask,r=this.followThumb;if(n&&a){var o=n.width,i=n.height,l=Math.round(e/t*o);(0>l||l===1/0)&&(l=0);var s=Math.round(e/t*i);switch((0>s||s===1/0)&&(s=0),this._direction){case eui.Direction.LTR:a.width=l,a.height=i,a.x=this.thumbInitX,a.y=this.thumbInitY,r&&(r.x=l+this.thumbInitX);break;case eui.Direction.RTL:a.width=l,a.height=i,a.x=o-l,a.y=this.thumbInitY,r&&(r.x=a.x-r.width);break;case eui.Direction.TTB:a.height=s,a.width=o,a.x=this.thumbInitX,a.y=this.thumbInitY,r&&(r.y=s+this.thumbInitY);break;case eui.Direction.BTT:a.height=s,a.width=o,a.x=this.thumbInitX,a.y=i-s,r&&(r.y=a.y-r.height)}}this.label&&(this.label.text=this.valueToLabel(e,t))},Object.defineProperty(n.prototype,"labelFunction",{get:function(){return this._labelFunction},set:function(e){this._labelFunction!=e&&(this._labelFunction=e,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),n.prototype.valueToLabel=function(e,t){return null!=this.labelFunction?this._labelFunction(e,t):e+" / "+t},n.prototype.renderDraw=function(){},n.prototype.setSkinName=function(e){},n.prototype.setData=function(e){this._data=e},n.prototype.getData=function(e){return this._data},n.prototype.removeFromParent=function(){this.parent&&this.parent.removeChild(this)},n.prototype.onDestroy=function(){if(this._data=null,void 0!=this.UUID)return void e.FactoryUtils.onReturnComp(this);for(;this.numChildren>0;)this.removeChildAt(0)},n}(eui.Range);e.CProgressBar=t,__reflect(t.prototype,"DLG.CProgressBar",["DLG.IComponent","eui.UIComponent","egret.DisplayObject"])}(DLG||(DLG={}));var DLG;!function(e){var t;!function(e){e[e.text=0]="text",e[e.image=1]="image"}(t||(t={}));
var n=function(t){function n(){var e=t.call(this)||this;return e.label=null,e.m_pIsCenter=!1,e.m_pX=0,e.m_pY=0,e.m_pOldText="",e}return __extends(n,t),n.prototype.createChildren=function(){t.prototype.createChildren.call(this);var e=this,n=e.getChildAt(0);e.horizontalCenter=n.horizontalCenter,e.verticalCenter=n.verticalCenter,e.top=n.top,e.bottom=n.bottom,e.left=n.left,e.right=n.right,e.label=new r(n.width),e.setStyle(n),e.addChild(e.label),n.parent&&(n.onDestroy(),n.parent.removeChild(n),n=null)},n.prototype.onDestroy=function(){var e=this;e.label&&(e.label.onDestroy(),e.label=null),e.m_pOldText=null,t.prototype.onDestroy.call(this)},n.prototype.setStyle=function(e){var t=this;t.m_pWidth=e.width,t.m_pHeight=e.height,t.m_pX=e.x,t.m_pY=e.y,t.label.setStyle(e),t.setPosition(e.x,e.y),t.label.setText(e.text)},n.prototype.getLabel=function(){var e=this;return e.label},Object.defineProperty(n.prototype,"textAlign",{set:function(e){var t=this;t.m_pIsCenter=e,t.setPosition(t.m_pX,t.m_pY)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"subText",{set:function(e){var t=this;t.label&&(t.label.isSubStr=!0,t.text=e)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"lineNum",{get:function(){var e=this;return e.label?e.label.lineNum:0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"text",{set:function(t){var n=this;t=e.Utils.parseLanRich(t),t=e.Utils.parseClickRich(t),n.m_pOldText!=t&&(n.label.setText(t),n.width=n.label.textWidth,n.height=n.label.textHeight,n.setPosition(n.m_pX,n.m_pY),n.m_pOldText=t)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageScale",{set:function(e){var t=this;t.label.imageScale=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imgOffsetX",{set:function(e){var t=this;t.label.imgOffsetX=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imgOffsetY",{set:function(e){var t=this;t.label.imgOffsetY=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textWidth",{get:function(){var e=this;return null==e.label?0:e.label.textWidth},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textHeight",{get:function(){var e=this;return null==e.label?0:e.label.textHeight},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textColor",{set:function(e){var t=this;t.label.textColor=e},enumerable:!0,configurable:!0}),n.prototype.setWidth=function(e){var t=this;t.m_pWidth=e},n.prototype.setPosition=function(e,t){var n=this;if(n.m_pIsCenter){var a=e+n.m_pWidth/2,r=t+n.m_pHeight/2;n.x=a-n.label.textWidth/2,n.y=r-n.label.height/2}else n.x=e,n.y=t},n.prototype.limitHeight=function(e){var t=this;t.label.limitLines=e},n}(e.CGroup);e.CRichText=n,__reflect(n.prototype,"DLG.CRichText");var a=function(e){function t(t,n,a,r){void 0===n&&(n=!1),void 0===a&&(a=!1);var o=e.call(this,t,n,a)||this;o.text="";var i=o;return i.text=r,o}return __extends(t,e),t}(egret.Event);a.Link="link",e.CRichTextEvent=a,__reflect(a.prototype,"DLG.CRichTextEvent");var r=function(n){function r(t){var a=n.call(this)||this;a.m_pTextParser=new o,a.m_pLineLabel=new e.CLabel,a.m_pLabels=[],a.m_pLabelEvents=[],a.m_pLine=0,a.m_pImages={},a.lineWidth=300,a.m_pWidth=0,a.callFunc=null,a.lineSpacing=0,a.size=0,a.strokeColor=0,a.textWidth=0,a.textHeight=0,a.fontFamily="",a.isSubStr=!1,a.isSubEnd=!1,a.limitLines=0,a.imageScale=1,a.imgOffsetX=0,a.imgOffsetY=0;var r=a;return t&&(r.lineWidth=t),a}return __extends(r,n),Object.defineProperty(r.prototype,"lineNum",{get:function(){var e=this;return e.numChildren},enumerable:!0,configurable:!0}),r.prototype.setCompleteFunc=function(e){var t=this;t.callFunc=e},r.prototype.genSpaceStr=function(e){for(var t="",n=this;e>0;)t+=" ",e-=n.size<10?4:n.size/3.3333;return[t,e]},r.prototype.showElement=function(e){for(var n=this,a=[],r=e.length,o=0;r>o;o++){var i=e[o];if(""!=i.text){if(i.type==t.image){var l=new egret.Bitmap(RES.getRes(i.text));l.width=l.width*n.imageScale,l.height=l.height*n.imageScale;var s=n.genSpaceStr(l.width+n.imgOffsetX);i.bitmap=l,i.offsetX=s[1],i.text=s[0],a.push(i)}if(n.appendElement(i,r-1==o),n.isSubStr&&n.isSubEnd)return}}},r.prototype.createLineLabel=function(e,t){var n=this,a={};a=e.style?{text:t,style:e.style}:{text:t},n.m_pLabels[n.m_pLine]||(n.m_pLabels[n.m_pLine]=[]),n.m_pLabels[n.m_pLine].push(a)},r.prototype.createLineImage=function(e,t,n){var a=this;a.m_pImages[t]||(a.m_pImages[t]={lineHeight:0,list:[]}),e.x=n,e.line=t,a.m_pImages[t].list.push(e),a.m_pImages[t].lineHeight<e.bitmap.height&&(a.m_pImages[t].lineHeight=e.bitmap.height)},r.prototype.appendElement=function(e,n){for(var a,r=this,o=0,i=r.m_pLineLabel.text,l=r.m_pLineLabel.width,s=e.bitmap?e.bitmap.width:0,c=e.text,u=c.split("\n"),p=u.length,m=0;p>m;m++){c=u[m];for(var _=0;_<=c.length;_++){a=c.substring(o,_),r.m_pLineLabel.text=i+a;var d=r.m_pLineLabel.textWidth;if(r.isSubStr&&r.limitLines>0&&e.type==t.image&&(d+=10),d>=r.lineWidth-10&&(r.m_pLineLabel.width>r.lineWidth?(a=c.substring(o,_-1),o=_-1):o=_,r.isSubStr&&(r.limitLines>0?r.m_pLine==r.limitLines-1&&(a=e.type==t.text?a+"...":"...",r.isSubEnd=!0):e.type==t.text&&(a+="...",r.isSubEnd=!0)),r.createLineLabel(e,a),r.m_pLine+=1,i="",r.m_pLineLabel.text="",e.type==t.image)){if(r.m_pLineLabel.width-l>s/1.5)r.createLineImage(e,r.m_pLine-1,l+s);else{if(r.isSubStr)return;var h=r.genSpaceStr(s+r.imgOffsetX);r.m_pLineLabel.text=e.text,r.createLineImage(e,r.m_pLine,s),r.createLineLabel(e,h[0])}return}}p>1&&p-1>m&&(r.createLineLabel(e,a),r.m_pLine+=1,i="",r.m_pLineLabel.text="")}e.type==t.image&&r.createLineImage(e,r.m_pLine,r.m_pLineLabel.width),a=c.substring(o),a&&r.createLineLabel(e,a)},r.prototype._textFlow=function(e){var t=this;t.m_pImages=[];var n=t.m_pTextParser.parser(e);t.showElement(n),t.displayLables(),egret.callLater(function(){t.displayImages(),t.callFunc&&t.callFunc()},t)},r.prototype.linkClick=function(e){var t=this;t.dispatchEvent(new a(a.Link,!0,!1,e.text))},r.prototype.isExistContent=function(e){var t=this,n=t.m_pLabels[e];for(var a in n){var r=n[a].text;if(!r.match(/^[ ]+$/))return!1}return!0},r.prototype.displayLables=function(){for(var e=this,t=0,n=e.m_pLabels.length,a=0;n>a&&!(e.limitLines&&a>=e.limitLines);a++){var r=e.createLabel(),o=e.m_pImages[a]?e.m_pImages[a].lineHeight:e.size,i=e.m_pLabels[a];if(i){for(var l=0;l<i.length;l++){var s=i[l];r.appendElement(s),s.style&&s.style.href&&(r.addEventListener(egret.TextEvent.LINK,e.linkClick,e),e.m_pLabelEvents.push({label:r,type:egret.TextEvent.LINK}))}t+=e.imgOffsetY?e.imgOffsetY:o>e.size?(o-e.size)/2:0,t+=e.imgOffsetY&&e.isExistContent(a)?e.lineSpacing/4*3:0,r.y=a*(e.size+e.lineSpacing),e.addChild(r),e.textWidth<r.textWidth&&(e.textWidth=r.textWidth)}}t+=e.imgOffsetY&&e.isExistContent(0)?e.lineSpacing:0,e.textHeight=n*(e.size+e.lineSpacing)+t-e.lineSpacing},r.prototype.displayImages=function(){var e=this,t=0;for(var n in e.m_pImages){if(e.limitLines&&Number(n)>=e.limitLines)break;var a=e.m_pImages[n].list,r=e.m_pImages[n].lineHeight;t+=e.imgOffsetY&&e.isExistContent(0)?e.lineSpacing:0,t+=e.imgOffsetY?e.imgOffsetY:r>e.size?(r-e.size)/2:0;for(var o=0;o<a.length;o++){var i=a[o],l=e.size,s=i.x,c=(l+e.lineSpacing)*i.line;e.getChildByName(i.bitmap.hashCode)||(e.addChild(i.bitmap),i.bitmap.name=i.bitmap.hashCode),i.bitmap.x=s-i.bitmap.width,i.bitmap.y=c+e.size-i.bitmap.height+t}}e.m_pImages={},e.m_pLabels=[]},r.prototype.createLabel=function(){var t=this,n=new e.CLabel;return n.textColor=t.textColor,n.size=t.size,n.bold=t.bold,n.stroke=t.stroke,n.strokeColor=t.strokeColor,n.fontFamily=t.fontFamily,n},r.prototype.setLineLabelStyle=function(){var e=this;e.m_pLineLabel.size=e.size,e.m_pLineLabel.bold=e.bold,e.m_pLineLabel.stroke=e.stroke,e.m_pLineLabel.strokeColor=e.strokeColor,e.m_pLineLabel.fontFamily=e.fontFamily},r.prototype.setStyle=function(e){var t=this;t.textColor=e.textColor,t.size=e.size,t.lineSpacing=e.lineSpacing,t.bold=e.bold,t.stroke=e.stroke,t.strokeColor=e.strokeColor,t.fontFamily=e.fontFamily},r.prototype.setText=function(e,t){var n=this;n.setLineLabelStyle(),n.textWidth=0,n.textHeight=0,n.isSubEnd=!1,n.m_pLabels=[],n.removeLabelEvent(),n.m_pLineLabel.text="",n.removeChildren(),n.m_pLine=0,n.m_pImages={},n._textFlow(e),n.width=t?t:n.lineWidth},r.prototype.removeLabelEvent=function(){var e,t,n=this;for(t=0;t<n.m_pLabelEvents.length;t++)e=n.m_pLabelEvents[t],e.label.removeEventListener(e.type,n.linkClick,n);n.m_pLabelEvents.length=0},r.prototype.onDestroy=function(){var e=this;e.removeLabelEvent(),e.m_pImages.length=0,e.m_pLabels.length=0,e.m_pTextParser&&(e.m_pTextParser.onDestroy(),e.m_pTextParser=null),e.callFunc=null},r}(egret.DisplayObjectContainer);e.CRichLabel=r,__reflect(r.prototype,"DLG.CRichLabel");var o=function(e){function n(){var t=e.call(this)||this;return t.m_pTexts=[],t}return __extends(n,e),n.prototype.addToResults=function(e,t,n){var a=this;n.style?a.m_pTexts.push({text:e,type:t,style:n.style}):a.m_pTexts.push({text:e,type:t})},n.prototype.parseImage=function(e){for(var n=this,a=e.text,r=0,o=a.length;o>r;){var i=a.indexOf("[img]",r);if(0>i)n.addToResults(a.substring(r),t.text,e),r=o;else{n.addToResults(a.substring(r,i),t.text,e);var l=a.indexOf("[/img]",i);-1==l?(egret.$error(1038),l=i):n.addToResults(a.substring(i+5,l),t.image,e),r=l+6}}},n.prototype.parser=function(t){var n=this;n.m_pTexts=[];for(var a=e.prototype.parser.call(this,t),r=0;r<a.length;r++)n.parseImage(a[r]);return n.m_pTexts},n.prototype.onDestroy=function(){var e=this;e.m_pTexts.length=0},n}(egret.HtmlTextParser);e.CRichLabelTextParser=o,__reflect(o.prototype,"DLG.CRichLabelTextParser")}(DLG||(DLG={}));var DLG;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.m_hideItemMap={},e}return __extends(n,t),n.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.callLater(this.renderDraw,this)},n.prototype.setItemRenderer=function(e){this.m_renderClass=e},n.prototype.setItemRenderSkin=function(e){this.m_renderSkin=e},n.prototype.dataSource=function(e){this.m_tabItemsData=e,egret.callLater(this.renderDraw,this)},n.prototype.renderDraw=function(){for(var t,n=this.toggleArr;n.length>0;)t=n.shift(),t.parent&&this.removeChild(t);if(n.length=0,this.m_tabItemsData){var a,r,o=0,i=this.m_tabItemsData.length;for(o=0;i>o;o++)a=e.FactoryUtils.onCreateComp(this.m_renderClass),a.setSkinName(this.m_renderSkin),r=this.m_tabItemsData[o],r.color&&a.setLabelColor(r.color),r.strokeColor&&a.setStrokeColor(r.strokeColor),r.stroke&&a.setStroke(r.stroke),r.label&&a.setLabel(r.label),a.setData(r.data),this.push(a)}},n.prototype.hideItemByIndex=function(e){if(0==this.m_hideItemMap.hasOwnProperty(e+"")){var t=this.toggleArr,n=t[e];this.m_hideItemMap[e+""]=n,n.removeFromParent()}},n.prototype.showItemByIndex=function(e){if(1==this.m_hideItemMap.hasOwnProperty(e+"")){var t=this.m_hideItemMap[e+""];this.addChild(t),delete this.m_hideItemMap[e+""]}},n.prototype.onDestroy=function(){this.m_tabItemsData&&(this.m_tabItemsData.length=0,this.m_tabItemsData=null);var e=this.m_hideItemMap;for(var n in e)if(e.hasOwnProperty(n)){var a=e[n];a.removeFromParent()}this.m_hideItemMap=null,t.prototype.onDestroy.call(this)},n}(e.CRadioGroup);e.CTabBarGroup=t,__reflect(t.prototype,"DLG.CTabBarGroup")}(DLG||(DLG={}));var DLG;!function(e){var t=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onClick=function(){if(this.m_bEnable){var e=!this._isSelect;if(1==e)return;this.setSelect(e),this.m_pListenerFunc&&this.m_pListenerFunc.call(this.m_pListenerObj,this.m_parame)}},t}(e.CButton);e.CTabItem=t,__reflect(t.prototype,"DLG.CTabItem",["DLG.ITabItem","DLG.IButton"])}(DLG||(DLG={}));var DLG;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.isRadio=!1,t.changeDataTouchListener=!1,t}return __extends(t,e),t.prototype.onClick=function(){if(this.m_bEnable){var e=!this.select_mc.visible,t=!0;this.isRadio&&this.select_mc.visible==e&&(t=!1),t&&this.setSelect(e),(0==this.changeDataTouchListener||1==t)&&this.m_pListenerFunc&&this.m_pListenerFunc.call(this.m_pListenerObj,this.m_parame)}},t}(e.CButton);e.CToggle=t,__reflect(t.prototype,"DLG.CToggle")}(DLG||(DLG={}));var ALERT_BUTTON;!function(e){e[e.ALERT_OK=1]="ALERT_OK",e[e.ALERT_NO=2]="ALERT_NO",e[e.ALERT_CANCEL=4]="ALERT_CANCEL"}(ALERT_BUTTON||(ALERT_BUTTON={}));var DLG;!function(e){var t=function(t){function n(){var e=t.call(this,0,null)||this;return e.btns=0,e.showClose=!1,e}return __extends(n,t),n.prototype.onShow=function(e,n,a,r,o){t.prototype.onShow.call(this),this.titleStr=a,this.btns=n,this.btnTexts=r,this.skinName=e,this.onCreate()},n.prototype.onCreate=function(){var t=this,n=t.btns;n>0&&(0==(6&n)&&(t.btnOk.removeFromParent(),t.btnOk.onDestroy()),0==(n>>1&2)&&(t.btnNo.removeFromParent(),t.btnNo.onDestroy()),n>>1==0&&(t.btncancel.removeFromParent(),t.btncancel.onDestroy())),t.btnTexts&&(t.btnOk.parent&&t.btnOk.setLabel(t.btnTexts[0]),t.btnNo.parent&&t.btnNo.setLabel(t.btnTexts[1]),t.btncancel.parent&&t.btncancel.setLabel(t.btnTexts[2])),t.m_pRichlabel.textAlign=!0,t.titleStr&&(t.titleLabel.text=this.titleStr),this.btnClose&&(this.btnClose.visible=this.showClose),e.DLGCore.event.addTouchScaleListener(this.btnOk,this,this.okClick),e.DLGCore.event.addTouchScaleListener(this.btnNo,this,this.noClick),e.DLGCore.event.addTouchScaleListener(this.btnClose,this,this.closeClick),e.DLGCore.event.addTouchScaleListener(this.btncancel,this,this.closeClick)},n.prototype.okClick=function(e){var t=this.funcCallBack;this.closeClick(),t&&t(!0)},n.prototype.noClick=function(e){var t=this.funcCallBack;this.closeClick(),t&&t(!1)},n.prototype.closeClick=function(){this.m_pRichlabel=null,this.funcCallBack=null},n.prototype.onDestroy=function(){this.m_pRichlabel=null,this.funcCallBack=null,this.btnTexts=null,t.prototype.onDestroy.call(this)},n}(e.VPanel);e.VDialog=t,__reflect(t.prototype,"DLG.VDialog")}(DLG||(DLG={}));var DLG;!function(e){var t=function(){function t(){}return t.prototype.load=function(e,t,n){var a=this;a._loadCallBack=[],a._loadCallBackTarget=[],a._url=e,a._loadCallBack.push(t),a._loadCallBackTarget.push(n),this.loadTexture()},t.prototype.addCallBack=function(e,t){var n=this;n._loadCallBack.push(e),n._loadCallBackTarget.push(t)},t.prototype.onLoadJsonError=function(){},t.prototype.loadTexture=function(){var e=this;e._imageLoader||(e._imageLoader=new egret.ImageLoader,e._imageLoader.addEventListener(egret.Event.COMPLETE,e.onLoadTextureComplete,e),e._imageLoader.addEventListener(egret.IOErrorEvent.IO_ERROR,e.onLoadTextureError,e)),e._reLoad=!1,e._imageLoader.load(e._url)},t.prototype.onLoadTextureComplete=function(t){var n=this;n._imageLoader.removeEventListener(egret.Event.COMPLETE,n.onLoadTextureComplete,n),n._imageLoader.removeEventListener(egret.IOErrorEvent.IO_ERROR,n.onLoadTextureError,n),n._imageLoader=void 0;var a=t.target,r=a.data;e.DLGCore.loader.addData(n._url,r);var o=0,i=n._loadCallBack.length;for(o=0;i>o;o++)n._loadCallBack[o].call(n._loadCallBackTarget[o],n._url,r);n._loadCallBack=null,n._loadCallBackTarget=null,e.DLGCore.loader.returnLoadVo(n)},t.prototype.onLoadTextureError=function(){var t=this;1==t._reLoad?(t._imageLoader.removeEventListener(egret.Event.COMPLETE,t.onLoadTextureComplete,t),t._imageLoader.removeEventListener(egret.IOErrorEvent.IO_ERROR,t.onLoadTextureError,t),t._imageLoader=void 0,e.DLGCore.loader.returnLoadVo(t),t._loadCallBack=null,t._loadCallBackTarget=null,sayError("加载资源出错",t._url)):(t._reLoad=!0,t._imageLoader.load(t._url))},t}();e.LoadVo=t,__reflect(t.prototype,"DLG.LoadVo")}(DLG||(DLG={}));var DLG;!function(e){var t=function(e){function t(t,n,a){var r=e.call(this,t,0,a)||this;return r.m_tabsClassMap={},r.m_tabBarPagesMap={},r}return __extends(t,e),t.prototype.onShow=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.prototype.onShow.apply(this,t)},t.prototype.setTabsClass=function(e,t){this.m_tabsClassMap[e]=t},t.prototype.setTabBarPage=function(e,t){this.m_tabBarPagesMap[e]=t},t.prototype.setTabContent=function(e){this.m_tabContent=e},t.prototype.setTabBar=function(e){this.m_tabBar=e,this.m_tabBar.setOnChangeListener(this,this.onChangePageHandler,null)},t.prototype.onChangePageHandler=function(e,t){var n=this.m_tabBar.getItem(e),a=this.m_tabBarPagesMap;for(var r in a)if(a.hasOwnProperty(r)){var o=a[r];if(o==n){this.onOpenIndex(parseInt(r));break}}},t.prototype.onOpenIndex=function(e,t){var n=this;if(n.m_tabIndex!=e){n.m_currentTab&&(n.m_currentTab.onDestroy(),n.m_currentTab.removeFromParent());var a=n.m_tabsClassMap[n.m_tabIndex];n.m_currentTab=new a(n.m_panelId,e),n.m_currentTab.onShow(),n.m_tabContent.addChild(n.m_currentTab),n.m_tabIndex=e}else sayError("调用 onOpenIndex出错,当前正打开的是第",e,"个标签")},t.prototype.onDestroy=function(){var t=this;t.m_currentTab&&(t.m_currentTab.onDestroy(),t.m_currentTab.removeFromParent()),t.m_tabIndex=void 0,t.m_tabsClassMap=void 0,t.m_tabBarPagesMap=void 0,t.m_fromPanelId=void 0,e.prototype.onDestroy.call(this)},t}(e.VPanel);e.VTabPanel=t,__reflect(t.prototype,"DLG.VTabPanel",["DLG.ITabPanel","DLG.IComponent","eui.UIComponent","egret.DisplayObject"])}(DLG||(DLG={}));var game;!function(e){var t=function(){function e(){}return e}();e.BuffCfg=t,__reflect(t.prototype,"game.BuffCfg");var n=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.init=function(){this.analysis(e.CfgData.getDataByUrl(e.CfgData.buff_json))},n}(DLG.BaseTable);e.BuffTable=n,__reflect(n.prototype,"game.BuffTable")}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e}();e.BulletCfg=t,__reflect(t.prototype,"game.BulletCfg");var n=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.init=function(){this.analysis(e.CfgData.getDataByUrl(e.CfgData.bullet_json))},n}(DLG.BaseTable);e.BulletTable=n,__reflect(n.prototype,"game.BulletTable")}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e.getDataByUrl=function(e){var t=this;return t.josnData.hasOwnProperty(e)?t.josnData[e]:null},e.setDataByUrl=function(e,t){var n=this;t=t.replace(/\r/g,""),t=t.replace(/\n/g,""),t=t.replace(/\[,(.+)]/g,""),","==t.slice(t.length-1,t.length)&&(t=t.slice(0,t.length-1)+"]");var a;debug("开始解析配置"+e);do a=t.slice(0,1),"["!=a&&"{"!=a&&(t=t.slice(1));while("["!=a&&"{"!=a);var r=JSON.parse(t);n.josnData[e]=r},e}();t.global_json="cfg_Global_json",t.lan_json="cfg_Lan_json",t.monster_json="cfg_Monster_json",t.bullet_json="cfg_Bullet_json",t.skill_json="cfg_skill_json",t.scene_json="cfg_Scene_json",t.goods_json="cfg_goods_json",t.server_json="cfg_Server_json",t.buff_json="cfg_buff_json",t.effect_json="cfg_effect_json",t.randomName_json="cfg_random_name_json",t.josnData={},e.CfgData=t,__reflect(t.prototype,"game.CfgData")}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e}();e.EffectCfg=t,__reflect(t.prototype,"game.EffectCfg");var n=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.init=function(){this.analysis(e.CfgData.getDataByUrl(e.CfgData.effect_json))},n}(DLG.BaseTable);e.EffectTable=n,__reflect(n.prototype,"game.EffectTable")}(game||(game={}));var game;!function(e){var t;!function(e){e[e.G_10001=10001]="G_10001",e[e.G_10002=10002]="G_10002",e[e.G_10003=10003]="G_10003",e[e.G_10004=10004]="G_10004"}(t=e.ENUM_GLOBAL_ID||(e.ENUM_GLOBAL_ID={}));var n=function(){function e(){}return e}();e.GlobalCfg=n,__reflect(n.prototype,"game.GlobalCfg");var a=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.init=function(){this.analysis(e.CfgData.getDataByUrl(e.CfgData.global_json))},n}(DLG.BaseTable);e.GlobalTable=a,__reflect(a.prototype,"game.GlobalTable")}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e}();e.GoodsCfg=t,__reflect(t.prototype,"game.GoodsCfg");var n=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.init=function(){this.analysis(e.CfgData.getDataByUrl(e.CfgData.goods_json))},n.findSceneArrByType=function(e){var t=this;if(t._table||t.init(),t.type_arr)return t.type_arr;t.type_arr=[];var n=t._table.getData();for(var a in n)if(n.hasOwnProperty(a)){var r=n[a];r.type==e&&t.type_arr.push(r)}return t.type_arr},n}(DLG.BaseTable);e.GoodsTable=n,__reflect(n.prototype,"game.GoodsTable")}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e}();e.LanCfg=t,__reflect(t.prototype,"game.LanCfg");var n=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.init=function(){this.analysis(e.CfgData.getDataByUrl(e.CfgData.lan_json))},n}(DLG.BaseTable);e.LanTable=n,__reflect(n.prototype,"game.LanTable")}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e}();e.MonsterCfg=t,__reflect(t.prototype,"game.MonsterCfg");var n=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.init=function(){this.analysis(e.CfgData.getDataByUrl(e.CfgData.monster_json))},n}(DLG.BaseTable);e.MonsterTable=n,__reflect(n.prototype,"game.MonsterTable")}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e}();e.RandomNameCfg=t,__reflect(t.prototype,"game.RandomNameCfg");var n=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.init=function(){this.analysis(RES.getRes(e.CfgData.randomName_json))},n}(DLG.BaseTable);e.RandomNameTable=n,__reflect(n.prototype,"game.RandomNameTable")}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e}();e.SceneCfg=t,__reflect(t.prototype,"game.SceneCfg");var n=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.init=function(){this.analysis(e.CfgData.getDataByUrl(e.CfgData.scene_json))},n.findSceneArrByType=function(e){var t=this;if(t._table||t.init(),t.type_arr)return t.type_arr;t.type_arr=[];var n=t._table.getData();for(var a in n)if(n.hasOwnProperty(a)){var r=n[a];r.type==e&&t.type_arr.push(r)}return t.type_arr},n}(DLG.BaseTable);e.SceneTable=n,__reflect(n.prototype,"game.SceneTable")}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e}();e.ServerCfg=t,__reflect(t.prototype,"game.ServerCfg");var n=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.init=function(){this.analysis(RES.getRes(e.CfgData.server_json))},n}(DLG.BaseTable);e.ServerTable=n,__reflect(n.prototype,"game.ServerTable")}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e}();e.SkillCfg=t,__reflect(t.prototype,"game.SkillCfg");var n=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.init=function(){this.analysis(e.CfgData.getDataByUrl(e.CfgData.skill_json))},n}(DLG.BaseTable);e.SkillTable=n,__reflect(n.prototype,"game.SkillTable")}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e}();t.APP_WIDTH=640,t.APP_HEIGHT=960,t.SHOW_MAP_MOVIE=!0,e.GAME_CORE=t,__reflect(t.prototype,"game.GAME_CORE")}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e}();t.TYPE_JPG=".jpg",t.TYPE_PNG=".png",t.TYPE_JSON=".json",t.BASE_PATH="resource2/",t.ZIP=t.BASE_PATH+"config.zip",t.MAP_PATH=t.BASE_PATH+"map/",t.WALL_PATH=t.BASE_PATH+"wall/",t.MOVIE_PLAYER_PATH=t.BASE_PATH+"movie/player/",t.MOVIE_MONSTER_PATH=t.BASE_PATH+"movie/monster/",t.MOVIE_BULLET_PATH=t.BASE_PATH+"movie/bullet/",t.MOVIE_EFFECT_PATH=t.BASE_PATH+"movie/effect/",e.GAME_PATH=t,__reflect(t.prototype,"game.GAME_PATH")}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this,n=t;return n.createSocket(),n.createPanelMar(),t}return __extends(t,e),t.getInstance=function(){var e=this;return e._instance||(e._instance=new t,e._instance.initBagDatas()),e._instance},t.prototype.initBagDatas=function(){var e=0;for(this._goods=[],e=0;70>e;e++)8>e?this._goods.push(e+1):20>e?this._goods.push(0):this._goods.push(-1);for(this._results=[],e=0;6>e;e++)this._results.push(10001+e)},Object.defineProperty(t.prototype,"goods",{get:function(){return this._goods},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"results",{get:function(){return this._results},enumerable:!0,configurable:!0}),t}(DLG.BaseAction);e.BagIManager=t,__reflect(t.prototype,"game.BagIManager")}(game||(game={}));var game;!function(e){var t=function(t){function n(e,n){return t.call(this,e)||this}return __extends(n,t),n.prototype.onShow=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.prototype.onShow.apply(this,e);var a=this;a.main=new BagView,a.addChild(a.main),a.main.onLoadCallBack=a.initView,a.main.onLoadCallTarget=a},n.prototype.initView=function(){t.prototype.initView.call(this);var n=this;n.initDefaultPanel(),n.main.num_txt.text=e.BagIManager.getInstance().goods.length+"/100",n.main.rong_btn.setLabel("熔炼"),n.main.rong_btn.setScaleClick(!0),n.main.rong_btn.setOnClickListener(n,n.rongHandler);var a=new eui.TileLayout;a.horizontalGap=30,a.verticalGap=25,a.requestedColumnCount=5,n.main.list.layout=a,n.main.list.itemRenderer=e.BagItem,n.main.list.dataProvider=new eui.ArrayCollection(e.BagIManager.getInstance().goods)},n.prototype.initDefaultPanel=function(){var e=this;e.main.close_btn.setScaleClick(!0),e.main.close_btn.setOnClickListener(e,e.closePanelHandler),e.main.back_btn.setScaleClick(!0),e.main.back_btn.setOnClickListener(e,e.closePanelHandler)},n.prototype.rongHandler=function(e){},n.prototype.closePanelHandler=function(e){DLG.DLGCore.panel.closeAll()},n.prototype.onDestroy=function(){t.prototype.onDestroy.call(this);var e=this;e.main&&(e.main.onLoadCallBack=void 0,e.main.onLoadCallTarget=void 0,e.main.onDestroy()),e.main=void 0},n}(DLG.VPanel);e.BagPanel=t,__reflect(t.prototype,"game.BagPanel")}(game||(game={}));var BagView=function(e){function t(){var t=e.call(this)||this,n=t;return n.skinName="resource/skins/bag/BagView.exml",n.addEventListener(eui.UIEvent.CREATION_COMPLETE,n.createCompleteEvent,n),t}return __extends(t,e),t.prototype.createCompleteEvent=function(e){var t=this;t.isLoad=!0,t.removeEventListener(eui.UIEvent.CREATION_COMPLETE,t.createCompleteEvent,t),t.onLoadCallBack&&t.onLoadCallBack.call(t.onLoadCallTarget)},t.prototype.onDestroy=function(){var t=this;t.onLoadCallBack=null,t.onLoadCallTarget=null,t.isLoad=null,e.prototype.onDestroy.call(this)},t}(DLG.CComponent);__reflect(BagView.prototype,"BagView");var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this,n=e;return n.skinName="resource/skins/bag/BagItemSkin.exml",DLG.DLGCore.event.addEventListener(e,egret.TouchEvent.TOUCH_TAP,n,n.onBtnTouchHandler),e}return __extends(n,t),n.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this;null!=e.data&&0!=e.isInitView&&(e.modelId=e.data,e.icon_lock.visible=e.modelId<0,e.modelId<0?(e.label_txt.text="",e.icon_img.source=null):0==e.modelId?(e.label_txt.text="",e.icon_img.source=null):(e.label_txt.text=e.modelId+"",e.icon_img.source="goods_"+e.modelId+"_png"))},n.prototype.onBtnTouchHandler=function(){this.modelId<=0||e.ItemTipsControl.getInstance().initTips(this.modelId,0,null,null,null)},n.prototype.onDestroy=function(){t.prototype.onDestroy.call(this)},n}(DLG.CItemRenderer);e.BagItem=t,__reflect(t.prototype,"game.BagItem")}(game||(game={}));var AddItem=function(){function e(e,t,n){this._main=e,this._onLoadCallBack=t,this._onLoadCallTarget=n,this._bgImg=this._main.bg_img,this._labTxt=this._main.lab_txt,this._btn=this._main.add_btn,this._btn.setScaleClick(!0),this._btn.setOnClickListener(this,this.clickHandler)}return e.prototype.updateView=function(e,t){this._labTxt.text=e+"/"+t},e.prototype.clickHandler=function(){this._onLoadCallBack&&this._onLoadCallBack.call(this._onLoadCallTarget)},Object.defineProperty(e.prototype,"Width",{set:function(e){this._w=e,this._main.width=this._w,this._bgImg.width=e,this._labTxt.width=e-this._btn.width,this._btn.x=this._labTxt.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Height",{set:function(e){this._h=e,this._main.height=e,this._bgImg.height=e,this._labTxt.y=(e-this._labTxt.height)/2,this._btn.y=(e-this._btn.height)/2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"btnSkin",{set:function(e){this._btn.img.source=e},enumerable:!0,configurable:!0}),e}();__reflect(AddItem.prototype,"AddItem");var BarItem=function(){function e(e){this._main=e,this._bgImg=this._main.bg_img,this._barImg=this._main.bar_img,this._bar_point=this._main.bar_point,this._labTxt=this._main.lab_txt}return e.prototype.updateView=function(e,t,n,a){void 0===n&&(n=!0),void 0===a&&(a=30),e=Math.min(e,t),this._labTxt.text=n?e+"/"+t:"",this._barImg.width=e/t*(this._bgImg.width-a),this._bar_point&&(this._bar_point.x=e/t*this._bgImg.width-28)},Object.defineProperty(e.prototype,"bgSkin",{set:function(e){this._bgImg.source=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"barSkin",{set:function(e){this._barImg.source=e},enumerable:!0,configurable:!0}),e}();__reflect(BarItem.prototype,"BarItem");var egret;!function(e){var t=function(){function e(){this.id=0,this.name="",this.quality=0}return e}();e.ItemConfig=t,__reflect(t.prototype,"egret.ItemConfig")}(egret||(egret={}));var egret;!function(e){var t=function(){function t(){}return t.getInstance=function(){return t._instance||(t._instance=new t),t._instance},t.prototype.initCfg=function(){if(!this.itemCfgs){this.itemCfgs=[];for(var n=0;n<t.ITEM_CONFIG.length;n++){var a=t.ITEM_CONFIG[n],r=a.split(","),o=new e.ItemConfig;o.id=Number(r[0]),o.name=r[1],o.quality=Number(r[2]),this.itemCfgs.push(o)}}},t.prototype.getCfg=function(e){this.initCfg();for(var t=0;t<this.itemCfgs.length;t++){var n=this.itemCfgs[t];if(n.id==e)return n}return null},t.prototype.getQuaByType=function(e){return t.ITEM_QUALITY[e]},t}();t.ITEM_QUALITY=["白色","橙色","紫色","红色","幻彩"],t.ITEM_CONFIG=["1,千钧,2","2,回旋刃,1","3,血滴子,1","4,峨眉爪,1","5,峨眉刺,1","6,峨眉刺,1","7,峨眉刺,1","8,峨眉刺,1","9,峨眉刺,1","10,峨眉刺,1","11,峨眉刺,1","12,峨眉刺,1","13,峨眉刺,3","14,峨眉刺,3","15,峨眉刺,3","16,峨眉刺,3","17,峨眉刺,3","18,峨眉刺,3","19,峨眉刺,3","20,峨眉刺,3","21,峨眉刺,3","22,峨眉刺,3","23,峨眉刺,3","24,峨眉刺,3","25,峨眉刺,3","26,峨眉刺,3"],e.ItemManager=t,__reflect(t.prototype,"egret.ItemManager")}(egret||(egret={}));var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this,n=e;return n.createSocket(),n.createPanelMar(),e}return __extends(n,t),n.getInstance=function(){var e=this;return e._instance||(e._instance=new n),e._instance},n.prototype.initTips=function(t,n,a,r,o){this.goodsId=t,this.btnType=n,this.callBackFun=a,this.callBackObj=r,this.callBackArg=o,DLG.DLGCore.panel.show(e.PanelClassConfig.ID_TipsPanel)},n}(DLG.BaseAction);e.ItemTipsControl=t,__reflect(t.prototype,"game.ItemTipsControl")}(game||(game={}));var game;!function(e){var t=function(t){function n(e,n){return t.call(this,e)||this}return __extends(n,t),n.prototype.onShow=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.prototype.onShow.apply(this,e);var a=this;a.main=new ItemTipsView,a.addChild(a.main),a.main.onLoadCallBack=a.initView,a.main.onLoadCallTarget=a},n.prototype.initView=function(){t.prototype.initView.call(this);var e=this;e.main.close_btn.img.source="common_close_btn1_png",e.main.close_btn.setScaleClick(!0),e.main.close_btn.setOnClickListener(e,e.closePanelHandler),this.main.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closePanelHandler,this),this.updateView()},n.prototype.updateView=function(){this._goodsId=e.ItemTipsControl.getInstance().goodsId,this._btnType=e.ItemTipsControl.getInstance().btnType,this._callBackFun=e.ItemTipsControl.getInstance().callBackFun,this._callBackObj=e.ItemTipsControl.getInstance().callBackObj,this._callBackArg=e.ItemTipsControl.getInstance().callBackArg;var t=195,n=410,a=e.GoodsTable.getCfgById(this._goodsId);this.main.icon_img.source="goods_"+a.id+"_png",this.main.name_txt.text=a.name,this.main.type_txt.text=a.typeName,this.main.limit_txt.text=a.limit,1==a.type?(this.main.other_box.visible=!0,this.main.hp_txt.text="生命："+a.hp,this.main.atk_txt.text="攻击："+a.atk,this.main.def_txt.text="防御："+a.atk,t=390,this.main.des_txt.y=270):(this.main.other_box.visible=!1,this.main.des_txt.y=148),this.main.des_txt.text=a.des,t=this.main.des_txt.y+this.main.des_txt.textHeight,t+=20,this.main.bg_img.height=t,this.main.btn_box.y=t-40,this.main.btn_1.setScaleClick(!1),1==this._btnType?(this.main.btn_box.visible=!0,this.main.btn_1.setScaleClick(!0),this.main.btn_1.setOnClickListener(this,this.wearHandler),this.main.btn_1.img.source="common_btn3_png",n=490,this.main.content_box.x=90):2==this._btnType?(this.main.btn_box.visible=!0,this.main.btn_1.setScaleClick(!0),this.main.btn_1.setOnClickListener(this,this.takeOffHandler),this.main.btn_1.img.source="common_btn4_png",n=490,this.main.content_box.x=90):(this.main.btn_box.visible=!1,this.main.content_box.x=127)
},n.prototype.wearHandler=function(){this._callBackFun&&this._callBackFun.call(this._callBackObj,this._callBackArg),DLG.DLGCore.panel.close(e.PanelClassConfig.ID_TipsPanel)},n.prototype.takeOffHandler=function(){this._callBackFun&&this._callBackFun.call(this._callBackObj,this._callBackArg),DLG.DLGCore.panel.close(e.PanelClassConfig.ID_TipsPanel)},n.prototype.closePanelHandler=function(t){DLG.DLGCore.panel.close(e.PanelClassConfig.ID_TipsPanel)},n.prototype.onDestroy=function(){this._goodsId=0,this._btnType=0,this._callBackFun=null,this._callBackObj=null,this._callBackArg=null,t.prototype.onDestroy.call(this);var e=this;e.main&&(e.main.onLoadCallBack=void 0,e.main.onLoadCallTarget=void 0,e.main.onDestroy()),e.main=void 0},n}(DLG.VPanel);e.ItemTipsPanel=t,__reflect(t.prototype,"game.ItemTipsPanel")}(game||(game={}));var ItemTipsView=function(e){function t(){var t=e.call(this)||this,n=t;return n.skinName="resource/skins/common/ItemTipsSkin.exml",n.addEventListener(eui.UIEvent.CREATION_COMPLETE,n.createCompleteEvent,n),t}return __extends(t,e),t.prototype.createCompleteEvent=function(e){var t=this;t.isLoad=!0,t.removeEventListener(eui.UIEvent.CREATION_COMPLETE,t.createCompleteEvent,t),t.onLoadCallBack&&t.onLoadCallBack.call(t.onLoadCallTarget)},t.prototype.onDestroy=function(){var t=this;t.onLoadCallBack=null,t.onLoadCallTarget=null,t.isLoad=null,e.prototype.onDestroy.call(this)},t}(DLG.CComponent);__reflect(ItemTipsView.prototype,"ItemTipsView");var VMCLoadVo=function(){function e(){var e=this;e._josnLoader=new egret.URLLoader,e._josnLoader.dataFormat=egret.URLLoaderDataFormat.TEXT}return e.prototype.load=function(t,n,a){var r=this;r._loadCallBack=[],r._loadCallBackTarget=[],r._url=t,r._loadCallBack.push(n),r._loadCallBackTarget.push(a),r._urlRequest?r._urlRequest.url=t+e.TYPE_JSON:r._urlRequest=new egret.URLRequest(t+e.TYPE_JSON),r._jsonReLoad=!1,r._imageReLoad=!1,r._josnLoader.addEventListener(egret.Event.COMPLETE,r.onLoadJsonComplete,r),r._josnLoader.addEventListener(egret.IOErrorEvent.IO_ERROR,r.onLoadJsonError,r),r._josnLoader.load(r._urlRequest)},e.prototype.onLoadJsonComplete=function(e){var t=this;t._josnLoader.removeEventListener(egret.Event.COMPLETE,t.onLoadJsonComplete,t),t._josnLoader.removeEventListener(egret.IOErrorEvent.IO_ERROR,t.onLoadJsonError,t);var n=e.target;t._jsonObj=JSON.parse(n.data),this.loadTexture()},e.prototype.onLoadJsonError=function(){var e=this;1==e._jsonReLoad?(e._josnLoader.removeEventListener(egret.Event.COMPLETE,e.onLoadJsonComplete,e),e._josnLoader.removeEventListener(egret.IOErrorEvent.IO_ERROR,e.onLoadJsonError,e),e._loadCallBack=null,e._loadCallBackTarget=null,sayError("加载资源出错",e._url)):(e._jsonReLoad=!0,e._josnLoader.load(e._urlRequest))},e.prototype.loadTexture=function(){var t=this;t._imageLoader||(t._imageLoader=new egret.ImageLoader,t._imageLoader.addEventListener(egret.Event.COMPLETE,t.onLoadTextureComplete,t),t._imageLoader.addEventListener(egret.IOErrorEvent.IO_ERROR,t.onLoadTextureError,t)),t._imageLoader.load(t._url+e.TYPE_PNG)},e.prototype.onLoadTextureComplete=function(e){var t=this;t._imageLoader.removeEventListener(egret.Event.COMPLETE,t.onLoadTextureComplete,t),t._imageLoader.removeEventListener(egret.IOErrorEvent.IO_ERROR,t.onLoadTextureError,t),t._imageLoader=void 0;var n=e.target,a=(n.data,0),r=t._loadCallBack.length;for(a=0;r>a;a++)t._loadCallBack[a].call(t._loadCallBackTarget[a],t._url,t._jsonObj,bitmapData);t._loadCallBack=null,t._loadCallBackTarget=null},e.prototype.onLoadTextureError=function(){var e=this;1==e._imageReLoad?(e._imageLoader.removeEventListener(egret.Event.COMPLETE,e.onLoadTextureComplete,e),e._imageLoader.removeEventListener(egret.IOErrorEvent.IO_ERROR,e.onLoadTextureError,e),e._imageLoader=void 0,MovieLoadManager.getInstance().returnMovieLoadVo(e),e._loadCallBack=null,e._loadCallBackTarget=null,sayError("加载资源出错",e._url)):(e._imageReLoad=!0,e._imageLoader.load(e._url))},e}();VMCLoadVo.TYPE_JPG=".jpg",VMCLoadVo.TYPE_PNG=".png",VMCLoadVo.TYPE_JSON=".json",__reflect(VMCLoadVo.prototype,"VMCLoadVo");var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e._interval=0,e._poseProgress=-1,e._count=0,e._isPlaying=!1,e._url=null,e._actName=null,e._direct=0,e._repeat=!1,e._lastPoseTime=0,e._poseInfo=null,e._playInterMultiple=1,e._offsetX=0,e._offsetY=0,e._vmcHeight=0,e._dirName=null,e}return __extends(n,t),n.prototype.destroy=function(){this.stop(),this._skinRenderBmp&&(this._skinRenderBmp.parent&&this._skinRenderBmp.parent.removeChild(this._skinRenderBmp),this._skinRenderBmp=null)},n.prototype.updatePose=function(t,n,a,r,o,i,l){if(t){var s=this;s._rect||(s._rect=new egret.Rectangle),s._skinRenderBmp||(s._skinRenderBmp=new egret.Bitmap),this.addChild(s._skinRenderBmp),s._renderTexture||(s._renderTexture=new egret.RenderTexture),s._autoDestory=r,s._skinBitMap||(s._skinBitMap=new egret.Bitmap),this._direct=this.getTargetAnglt(n),this._repeat=a,""==o&&(this._actName=null),this._actName=o?o.replace("90",Math.abs(this._direct).toString()):Math.abs(this._direct).toString(),this._completeFunc=i,this._completeObj=l,this._poseInfo=null,this._interval=0,this._poseProgress=-1,this._count=0,s._url="resource2/movie/effect/"+t+"/1";var c=e.MovieLoadManager.getInstance(),u=c.getRes(s._url);u?s.loadCfgComplete(s._url,u[0],u[1]):e.MovieLoadManager.getInstance().load(s._url,s.loadCfgComplete,s)}},n.prototype.loadCfgComplete=function(e,t,n){if(this._poseInfo=t,this._skinBitMap.bitmapData=n,this._poseInfo){if(this._inters=this._poseInfo.cfgs.inter,this._poseInfo.cfgs.offset instanceof Array)this.offset=this._poseInfo.cfgs.offset;else if(this.offset=this._poseInfo.cfgs.offset[this._actName],!this.offset){var a;for(var r in this._poseInfo.cfgs.offset)a=this._poseInfo.cfgs.offset[r],this.offset=a}this.offset&&this.offset.length>0&&"string"==typeof this.offset[0][0];var o=this._poseInfo.cfgs.scale?this._poseInfo.cfgs.scale:1;this._vmcHeight=Math.abs(this.offset[0][1])*o,this._dirName=this._poseInfo.dirName,this._offsetX=(this._poseInfo.cfgs.offsetX?parseFloat(this._poseInfo.cfgs.offsetX):0)*o,this._offsetY=parseFloat(this._poseInfo.cfgs.offsetY),this._framesObj=this._poseInfo.frames,this._count=this.offset.length,this.startPlay()}},n.prototype.play=function(){this._isPlaying=!0,this._poseInfo&&this.startPlay()},n.prototype.startPlay=function(){if(this._isPlaying){this._lastPoseTime=egret.getTimer(),this._poseProgress=-1;var e=DLG.DLGCore.stage;e.addEventListener(egret.Event.ENTER_FRAME,this.loop,this)}},n.prototype.loop=function(){if(this._isPlaying){var e=egret.getTimer();if(0==this._lastPoseTime||e-this._lastPoseTime>1e3)this._lastPoseTime=e,this.nextFrame();else for(var t=this._url;e-this._lastPoseTime>this._interval;)if(this._lastPoseTime+=this._interval>0?this._interval:30,this.nextFrame(),!this._isPlaying||this._url!=t)return}},n.prototype.nextFrame=function(){if(!(this._count<=0)){var e=!1;this._poseProgress<this._count-1?++this._poseProgress:this._repeat?this._poseProgress=0:e=!0,this.paint(),e&&(null!=this._completeFunc&&(this._completeFunc.apply(this._completeObj),this._completeFunc=null),this.stop(),this._autoDestory&&this.recover())}},n.prototype.recover=function(){this.stop(),this.parent&&this.parent.removeChild(this)},n.prototype.stop=function(){this._isPlaying;this._isPlaying=!1;var e=DLG.DLGCore.stage;e.removeEventListener(egret.Event.ENTER_FRAME,this.loop,this)},n.prototype.getTargetAnglt=function(e){if(isNaN(e))return e;var t=e%360;return t=(t+360)%360,t>=180&&(t-=360),t},n.prototype.paint=function(){var e=this,t=e._framesObj[this._actName+"_"+e._poseProgress+".png"],n=t?t.frame:null;e._rect.x=n?n.x:0,e._rect.y=n?n.y:0,e._rect.width=n?n.w:0,e._rect.height=n?n.h:0,e._renderTexture.drawToTexture(e._skinBitMap,e._rect);var a=e._skinRenderBmp;a.bitmapData&&a.bitmapData.$dispose(),a.texture&&(a.texture=null),a.texture=e._renderTexture,a.width=e._rect.width,a.height=e._rect.height,a.rotation=0,a.x=this.offset[e._poseProgress][0],a.y=this.offset[e._poseProgress][1],this.countInter()},n.prototype.countInter=function(){this._inters&&0!=this._inters.length&&(this._interval=this._inters[this._poseProgress],1!=this._playInterMultiple&&(this._interval=Math.ceil(this._interval*this._playInterMultiple)))},n}(egret.Sprite);e.VMCView=t,__reflect(t.prototype,"game.VMCView")}(game||(game={}));var game;!function(e){var t=function(t){function n(){return t.call(this)||this}return __extends(n,t),n.prototype.initNameConfig=function(){var t,n=this;t=e.RandomNameTable.getDataVec();var a=0,r=t.length;for(a=0;r>a;a++)1==t[a].type?n.firstNameArr.push(t[a].name):2==t[a].type?n.boyNameArr.push(t[a].name):n.girlNameArr.push(t[a].name);n.firstNameLen=n.firstNameArr.length,n.boyNameLen=n.boyNameArr.length,n.girlNameLen=n.girlNameArr.length},Object.defineProperty(n.prototype,"firtName",{get:function(){var e=this;e.firstNameArr||e.initNameConfig();var t=Math.round(Math.random()*e.firstNameLen);return(0>t||t>=e.firstNameLen)&&(t=Math.round(Math.random()*e.firstNameLen)),e.firstNameArr[t]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"boyName",{get:function(){var e=this;e.boyNameArr||e.initNameConfig();var t=Math.round(Math.random()*e.boyNameLen);return(0>t||t>=e.boyNameLen)&&(t=Math.round(Math.random()*e.boyNameLen)),e.boyNameArr[t]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"girlName",{get:function(){var e=this;e.girlNameArr||e.initNameConfig();var t=Math.round(Math.random()*e.girlNameLen);return(0>t||t>=e.girlNameLen)&&(t=Math.round(Math.random()*e.girlNameLen)),e.girlNameArr[t]},enumerable:!0,configurable:!0}),n.prototype.getRandomName=function(e){var t=this;return 1==e?t.firtName+t.boyName:t.firtName+t.girlName},n.prototype.onDestroy=function(){t.prototype.onDestroy.call(this);var e=this;e.firstNameArr&&(e.firstNameArr.length=0,e.firstNameArr=null),e.boyNameArr&&(e.boyNameArr.length=0,e.boyNameArr=null),e.girlNameArr&&(e.girlNameArr.length=0,e.girlNameArr=null)},n}(DLG.BaseAction);e.JobNameAction=t,__reflect(t.prototype,"game.JobNameAction")}(game||(game={}));var game;!function(e){var t=function(t){function n(e,n){var a=t.call(this,e)||this;return a.selectJob=1,a.selectSex=1,a}return __extends(n,t),n.prototype.onShow=function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];t.prototype.onShow.apply(this,n);var r=this;r.main=new e.CreateRoleView,r.addChild(r.main),r.main.onLoadCallBack=r.initView,r.main.onLoadCallTarget=r},n.prototype.initView=function(){t.prototype.initView.call(this);var n=this;n.main.selectJobList.itemRenderer=e.SelectJobItem;var a=[1,2];n.main.selectJobList.dataProvider=new eui.ArrayCollection(a),n.main.selectJobList.selectedIndex=0,n.main.btn_create.setOnClickListener(n,n.onCreateRole),n.main.btn_random.setOnClickListener(n,n.onRandomName)},n.prototype.renderViews=function(){var e=this,t=e.main.selectJobList.selectedIndex;0==t?(e.selectJob=1,e.selectSex=1,e.main.jobModel.source="jobMan0_png"):(e.selectJob=2,e.selectSex=2,e.main.jobModel.source="jobWoman1_png"),e.onRandomName()},n.prototype.onCreateRole=function(){var t=this;if(!(t.main.inputName.text.length<=0)){var n=new e.GCreateCharacterM;n.name=t.main.inputName.text,n.sex=t.selectSex,n.auto=t.selectJob,n.icon="brid",DLG.DLGCore.socket.onSend(e.CmdCode.REQ_CreateCharacter,n)}},n.prototype.onRandomName=function(){var t=this,n=DLG.FactoryUtils.getClass(e.JobNameAction);t.main.inputName.text=n.getRandomName(t.selectSex)},n.prototype.onDestroy=function(){t.prototype.onDestroy.call(this);var n=this;n.main&&(n.main.onLoadCallBack=void 0,n.main.onLoadCallTarget=void 0,n.main.onDestroy()),DLG.FactoryUtils.removeClass(e.JobNameAction),n.main=void 0},n}(DLG.VPanel);e.CreateRolePanel=t,__reflect(t.prototype,"game.CreateRolePanel")}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this,n=t;return n.skinName="resource/skins/createRole/CreateRole.exml",n.addEventListener(eui.UIEvent.CREATION_COMPLETE,n.createCompleteEvent,n),t}return __extends(t,e),t.prototype.createCompleteEvent=function(e){var t=this;t.isLoad=!0,t.removeEventListener(eui.UIEvent.CREATION_COMPLETE,t.createCompleteEvent,t),t.onLoadCallBack&&t.onLoadCallBack.call(t.onLoadCallTarget)},t.prototype.onDestroy=function(){var t=this;t.onLoadCallBack=null,t.onLoadCallTarget=null,t.isLoad=null,e.prototype.onDestroy.call(this)},t}(DLG.CComponent);e.CreateRoleView=t,__reflect(t.prototype,"game.CreateRoleView")}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e}();e.CreateRoleItem=t,__reflect(t.prototype,"game.CreateRoleItem")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this,n=e;return n.skinName="resource/skins/createRole/SelectJobItem.exml",DLG.DLGCore.event.addEventListener(e,egret.TouchEvent.TOUCH_TAP,n,n.onBtnTouchHandler),e}return __extends(n,t),n.prototype.dataChanged=function(){var e=this;null!=e._data&&0!=e.isInitView&&(1==e.data?e.jobIcon.source="CreateRole_json.CreateRole_HeroIcon_1_png":e.jobIcon.source="CreateRole_json.CreateRole_HeroIcon_2_png")},n.prototype.onBtnTouchHandler=function(){var t=DLG.DLGCore.panel.getPanelById(e.PanelClassConfig.ID_CreateRolePanel);t.onRefresh()},n.prototype.onDestroy=function(){t.prototype.onDestroy.call(this)},n}(DLG.CItemRenderer);e.SelectJobItem=t,__reflect(t.prototype,"game.SelectJobItem")}(game||(game={}));var game;!function(e){var t;!function(e){e[e.LOADING=6]="LOADING",e[e.GUIDE=5]="GUIDE",e[e.Dialog=4]="Dialog",e[e.TOP=3]="TOP",e[e.CENTER=2]="CENTER",e[e.BOTTOM=1]="BOTTOM",e[e.MAIN_UI=0]="MAIN_UI"}(t=e.PanelLayer||(e.PanelLayer={}));var n=function(t){function n(){var e=t.call(this)||this,n=e;return n.tipsLayer=new DLG.CGroup,n.panelLayer=new DLG.CGroup,n.panelLayer.addChild(new DLG.CGroup),n.panelLayer.addChild(new DLG.CGroup),n.panelLayer.addChild(new DLG.CGroup),n.panelLayer.addChild(new DLG.CGroup),n.panelLayer.addChild(new DLG.CGroup),n.panelLayer.addChild(new DLG.CGroup),n.panelLayer.addChild(new DLG.CGroup),n.addChild(n.panelLayer),n.addChild(n.tipsLayer),e.initData(),e}return __extends(n,t),n.prototype.initData=function(){var t=new DLG.Table;t.setData(e.PanelClassConfig.getCfg()),DLG.DLGCore.panel.init(this.panelLayer,t,e)},n}(egret.Sprite);e.GameMain=n,__reflect(n.prototype,"game.GameMain")}(game||(game={}));var game;!function(e){var t=function(t){function n(e,n){var a=t.call(this,e)||this;return a._plus=1,a}return __extends(n,t),n.prototype.onShow=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.prototype.onShow.apply(this,e);var a=this;a.main=new GuideView,a.addChild(a.main),a.main.onLoadCallBack=a.initView,a.main.onLoadCallTarget=a},n.prototype.initView=function(){t.prototype.initView.call(this);var e=this;e.main.icon_img.addEventListener(egret.TouchEvent.TOUCH_TAP,e.clickItemHandler,e),e._plus=1,e.addTween(),this.onResizeHandler();var n=DLG.DLGCore.stage;n.addEventListener(egret.Event.RESIZE,this.onResizeHandler,this)},n.prototype.onResizeHandler=function(){var e=ApplicationManager.CONTENT_H,t=document.documentElement.clientHeight,n=ApplicationManager.globalScale;this.main.content_box.y=(t+e*n)/(2*n)-147},n.prototype.clickItemHandler=function(){DLG.DLGCore.panel.show(e.PanelClassConfig.ID_MissionPanel),DLG.DLGCore.panel.close(e.PanelClassConfig.ID_GuidePanel)},n.prototype.addTween=function(){var e=this,t=e.main.arrow_img.y;e._plus*=-1;var n=t+40*e._plus;egret.Tween.get(e.main.arrow_img).to({y:n},500).call(e.addTween,e)},n.prototype.onDestroy=function(){var e=DLG.DLGCore.stage;e.removeEventListener(egret.Event.RESIZE,this.onResizeHandler,this),egret.Tween.removeTweens(this.main.arrow_img),t.prototype.onDestroy.call(this);var n=this;n.main&&(n.main.onLoadCallBack=void 0,n.main.onLoadCallTarget=void 0,n.main.onDestroy()),n.main=void 0},n}(DLG.VPanel);e.GuidePanel=t,__reflect(t.prototype,"game.GuidePanel")}(game||(game={}));var GuideView=function(e){function t(){var t=e.call(this)||this,n=t;return n.skinName="resource/skins/guide/GuidSkinView.exml",n.addEventListener(eui.UIEvent.CREATION_COMPLETE,n.createCompleteEvent,n),t}return __extends(t,e),t.prototype.createCompleteEvent=function(e){var t=this;t.isLoad=!0,t.removeEventListener(eui.UIEvent.CREATION_COMPLETE,t.createCompleteEvent,t),t.onLoadCallBack&&t.onLoadCallBack.call(t.onLoadCallTarget)},t.prototype.onDestroy=function(){var t=this;t.onLoadCallBack=null,t.onLoadCallTarget=null,t.isLoad=null,e.prototype.onDestroy.call(this)},t}(DLG.CComponent);__reflect(GuideView.prototype,"GuideView");var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this;e._quickPutOnBullet=0;var n=e;return n.createSocket(),e}return __extends(n,t),n.getInstance=function(){var e=this;return e._instance||(e._instance=new n),e._instance},n.prototype.registProtocol=function(){var t=this;t.m_socket.onDataCallback(e.CmdCode.ACK_MyInfo,"",t.initHeroInfo,t)},n.prototype.addRole=function(t,n,a,r,o){var i=e.SceneData.roleStandPoint,l=e.SceneManager.getInstance(),s=l.createDriverData(e.ENUM_DriverType.role);s.x=i[t],s.y=780,s.index=t,s.attr.clear(),s.attr=r,s.movieName=n,s.job=a,s.bulletCountMax=100,s.putOnBulletCDTime=6e3,a==e.ENUM_JOB_TYPE.job_ZS?(s.canThreeRatio=4e3,s.doubleRatio=5e3,s.bigWeaponRatio=1e3,s.bigWeaponHurtRatio=5e3,s.luckHurtExRationMin=1e3,s.luckHurtExRationkMax=5e3):a==e.ENUM_JOB_TYPE.JOB_GJS?(s.canThreeRatio=4e3,s.canFiveRatio=4e3,s.farHurtExRatio=800):a==e.ENUM_JOB_TYPE.JOB_CK?(s.canThreeRatio=4e3,s.anshaRatio=5e3,s.anshaHurtExRatio=1e4,s.anshaLiAttackExValueRatio=100):a==e.ENUM_JOB_TYPE.JOB_FS?(s.doubleRatio=5e3,s.shortHurtExRatio=1e3,s.molotovRatio=5e3):a==e.ENUM_JOB_TYPE.JOB_WS&&(s.doubleRatio=5e3,s.canFiveRatio=4e3,s.luckHurtExRationMin=1e3,s.luckHurtExRationkMax=5e3,s.baoFaHurtRatio=5e3,s.hpHurtExValueRatio=5e3,s.flamerRatio=5e3),s.skills=o,l.addDriver(s)},n.prototype.removeRoleByDirver=function(t){var n=e.SceneManager.getInstance();n.removeDriver(t)},n.prototype.setMonsterSpeedCut=function(t){e.FightManager.getInstance().monsterSpeedCut=t/1e4},n.prototype.setQuickPutOnBullet=function(e){this._quickPutOnBullet=e/1e4},n.prototype.getQuickPutOnBullet=function(){return this._quickPutOnBullet},n.prototype.setMonsterNotHit=function(t){e.FightManager.getInstance().monsterNotHit=t/1e4},n.prototype.initHeroInfo=function(e,t){},n}(DLG.BaseAction);e.HeroManager=t,__reflect(t.prototype,"game.HeroManager")}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e}();e.HeroVo=t,__reflect(t.prototype,"game.HeroVo")}(game||(game={}));var game;!function(e){var t=function(t){function n(e,n){return t.call(this,e)||this}return __extends(n,t),n.prototype.onShow=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.prototype.onShow.apply(this,e);var a=this;a.main=new LoadView,a.addChild(a.main),a.main.onLoadCallBack=a.initView,a.main.onLoadCallTarget=a},n.prototype.initView=function(){t.prototype.initView.call(this),this.onResizeHandler();var e=DLG.DLGCore.stage;e.addEventListener(egret.Event.RESIZE,this.onResizeHandler,this)},n.prototype.onResizeHandler=function(){},n.prototype.startLoad=function(e,t,n){var a=this;a._type=e,a.main.loginBg.source=0==a._type?"loginBg_jpg":"loginBg1_jpg",a.main.loginBg1.visible=0==e,a.main.loginBg2.visible=0==e,a._loadCompeltedFun=t,a._loadCompeltedObj=n,a._curTime=egret.getTimer(),a._maxTime=1500;var r=DLG.DLGCore.stage;r.addEventListener(egret.Event.ENTER_FRAME,this.loop,this)},n.prototype.loop=function(){var t=this,n=egret.getTimer()-t._curTime;t.main.bar.updateView(n,t._maxTime,!1,0),t._maxTime-n<=0&&(t._loadCompeltedFun&&t._loadCompeltedFun.call(t._loadCompeltedObj),DLG.DLGCore.panel.close(e.PanelClassConfig.ID_LoadPanel))},n.prototype.onDestroy=function(){var e=DLG.DLGCore.stage;e.removeEventListener(egret.Event.ENTER_FRAME,this.loop,this),e.removeEventListener(egret.Event.RESIZE,this.onResizeHandler,this),t.prototype.onDestroy.call(this);var n=this;n._loadCompeltedFun=null,n._loadCompeltedObj=null,n.main&&(n.main.onLoadCallBack=void 0,n.main.onLoadCallTarget=void 0,n.main.onDestroy()),n.main=void 0},n}(DLG.VPanel);e.LoadPanel=t,__reflect(t.prototype,"game.LoadPanel")}(game||(game={}));var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,n){function a(a){t.call(n,a,e)}if(RES.hasRes(e)){var r=RES.getRes(e);r?a(r):RES.getResAsync(e,a,this)}else RES.getResByUrl(e,a,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var game;!function(e){var t=function(t){function n(e,n){return t.call(this,e)||this}return __extends(n,t),n.prototype.onShow=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.prototype.onShow.apply(this,e);var a=this;a.main=new WelcomView,a.addChild(a.main),a.main.onLoadCallBack=a.initView,a.main.onLoadCallTarget=a},n.prototype.initView=function(){t.prototype.initView.call(this),this.main.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandler,this)},n.prototype.clickHandler=function(){DLG.DLGCore.panel.close(e.PanelClassConfig.ID_WelcomePanel),DLG.DLGCore.panel.show(e.PanelClassConfig.ID_GuidePanel)},n.prototype.onDestroy=function(){this.main.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandler,this),t.prototype.onDestroy.call(this);var e=this;e._loadCompeltedFun=null,e._loadCompeltedObj=null,e.main&&(e.main.onLoadCallBack=void 0,e.main.onLoadCallTarget=void 0,e.main.onDestroy()),e.main=void 0},n}(DLG.VPanel);e.WelcomPanel=t,__reflect(t.prototype,"game.WelcomPanel")}(game||(game={}));var LoadView=function(e){function t(){var t=e.call(this)||this,n=t;return n.skinName="resource/skins/loading/LoadViewSkin.exml",n.addEventListener(eui.UIEvent.CREATION_COMPLETE,n.createCompleteEvent,n),t}return __extends(t,e),t.prototype.createCompleteEvent=function(e){var t=this;t.isLoad=!0,t.removeEventListener(eui.UIEvent.CREATION_COMPLETE,t.createCompleteEvent,t),t.bar=new BarItem(this.barItem),t.onLoadCallBack&&t.onLoadCallBack.call(t.onLoadCallTarget)},t.prototype.onDestroy=function(){var t=this;t.onLoadCallBack=null,t.onLoadCallTarget=null,t.isLoad=null,e.prototype.onDestroy.call(this)},t}(DLG.CComponent);__reflect(LoadView.prototype,"LoadView");var SkillVmcView=function(e){function t(){var t=e.call(this)||this,n=t;return n.skinName="resource/skins/loading/SkillVMCSkin.exml",n.addEventListener(eui.UIEvent.CREATION_COMPLETE,n.createCompleteEvent,n),t}return __extends(t,e),t.prototype.createCompleteEvent=function(e){var t=this;t.isLoad=!0,t.removeEventListener(eui.UIEvent.CREATION_COMPLETE,t.createCompleteEvent,t),t.onLoadCallBack&&t.onLoadCallBack.call(t.onLoadCallTarget)},t.prototype.onDestroy=function(){var t=this;t.onLoadCallBack=null,t.onLoadCallTarget=null,t.isLoad=null,e.prototype.onDestroy.call(this)},t}(DLG.CComponent);__reflect(SkillVmcView.prototype,"SkillVmcView");var WelcomView=function(e){function t(){var t=e.call(this)||this,n=t;return n.skinName="resource/skins/loading/WelcomViewSkin.exml",n.addEventListener(eui.UIEvent.CREATION_COMPLETE,n.createCompleteEvent,n),t}return __extends(t,e),t.prototype.createCompleteEvent=function(e){var t=this;t.isLoad=!0,t.removeEventListener(eui.UIEvent.CREATION_COMPLETE,t.createCompleteEvent,t),t.onLoadCallBack&&t.onLoadCallBack.call(t.onLoadCallTarget)},t.prototype.onDestroy=function(){var t=this;t.onLoadCallBack=null,t.onLoadCallTarget=null,t.isLoad=null,e.prototype.onDestroy.call(this)},t}(DLG.CComponent);__reflect(WelcomView.prototype,"WelcomView");var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.createSocket(),e.createClock(),e.createPanelMar(),e}return __extends(n,t),n.prototype.onExecute=function(t){var n=this;if(t){n.m_panelMar.show(e.PanelClassConfig.ID_ServerPanel);var a=DLG.FactoryUtils.getClass(e.LoadMainResAction);a.onExecute()}else if("test"==e.LoginManager.getInstance().agent)n.m_panelMar.show(e.PanelClassConfig.ID_LoginInputPanel);else if("debug"==e.LoginManager.getInstance().agent){var a=DLG.FactoryUtils.getClass(e.LoadMainResAction);a.onExecute()}else{var r=e.ServerTable.getDataVec();n.connect(r[r.length-1].config),r.length=0,r=null}},n.prototype.connect=function(e){var t=this;t.m_socket.onConnectByUrl(e,t.onConnectSocket,t.onConnectClose,t)},n.prototype.onConnectSocket=function(){e.HeroManager.getInstance().registProtocol(),e.LoginManager.getInstance().registProtocol(),e.LoginManager.getInstance().reqloginForPlatform()},n.prototype.onConnectClose=function(){},n.prototype.onDestroy=function(){},n}(DLG.BaseAction);e.ConnectAction=t,__reflect(t.prototype,"game.ConnectAction")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.RES_MAIN="main",e.isLoadMain=!1,e}return __extends(n,t),n.prototype.onExecute=function(){var t=this;if(0==t.isLoadMain){DLG.DLGCore.panel.show(e.PanelClassConfig.ID_LoadPanel);var n=DLG.DLGCore.panel.getPanelById(e.PanelClassConfig.ID_LoadPanel);n.startLoad(0,t.loadPanelOk,t),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,t.onMainLoadComplete,t),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,t.onMainLoadError,t),RES.loadGroup(t.RES_MAIN),DLG.Utils.getZipResByUrl(e.GAME_PATH.ZIP,this.onConfigDataComplete,this,RES.ResourceItem.TYPE_BIN)}},n.prototype.onConfigDataComplete=function(t){for(var n in t)if(t.hasOwnProperty(n)){var a=t[n];if(-1!=a.name.indexOf(".")){var r=a.name.replace("config/","");r=r.replace(".json","_json"),e.CfgData.setDataByUrl(r,a.asText())}}e.LoginManager.getInstance().loadZip=!0,e.LoginManager.getInstance().checkComeInGame(),this.allOk()},n.prototype.onMainLoadComplete=function(t){var n=this;t.groupName==n.RES_MAIN&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,n.onMainLoadComplete,n),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,n.onMainLoadError,n),e.LoginManager.getInstance().loadMainRes=!0,e.LoginManager.getInstance().checkComeInGame(),this.allOk())},n.prototype.loadPanelOk=function(){e.LoginManager.getInstance().loadPanelShowOk=!0,this.allOk()},n.prototype.allOk=function(){e.LoginManager.getInstance().loadZip&&e.LoginManager.getInstance().loadMainRes&&e.LoginManager.getInstance().loadPanelShowOk&&e.SceneManager.getInstance().loadIngPanelOk()},n.prototype.onMainLoadError=function(e){sayError("Group:"+e.groupName+" has failed to load")},n}(DLG.BaseAction);e.LoadMainResAction=t,__reflect(t.prototype,"game.LoadMainResAction")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this;e.agent="debug",e.time="0",e.isadult="0",e.sign="0",e.logintype="0",e.agentPlusdata="0",e.token="0",e.qufu=new Array,e.selectServerId=1;var n=e;return n.createSocket(),n.createPanelMar(),e}return __extends(n,t),n.getInstance=function(){var e=this;return e._instance||(e._instance=new n),e._instance},n.prototype.getServerData=function(){var t=this;if(!t.serverDataArr){t.serverDataArr=[];var n=e.ServerTable.getDataVec(),a=0,r=n.length;for(a=0;r>a;a++){var o={};o={serverId:n[a].id,isNew:!1,serverIp:n[a].config},t.serverDataArr.push(o)}DLG.SortTools.sortMap(t.serverDataArr,"serverId",!0);var i=t.serverDataArr[t.serverDataArr.length-1];i.isNew=!0}return t.serverDataArr},n.prototype.registProtocol=function(){var t=this;t.m_socket.onDataCallback(e.CmdCode.ACK_LoginSuccess,"",t.loginSuccess,t),t.m_socket.onDataCallback(e.CmdCode.ACK_LoginFailed,"",t.loginFailed,t),t.m_socket.onDataCallback(e.CmdCode.ACK_Character,"",t.receiveCharacter,t),t.m_socket.onDataCallback(e.CmdCode.ACK_APersonOpt,"dinghao",t.dinghaoInfo,t)},n.prototype.reqlogin=function(t,n,a){var r=this,o=new e.GLoginM;o.name=n,o.password=a,o.serverid=t,r.m_socket.onSend(e.CmdCode.REQ_LOGIN,o)},n.prototype.reqloginForPlatform=function(){var t=this,n=new e.GLoginForPlatformM;n.serverId=t.selectServerId,n.username=t.loginUserName,n.agent=t.agent,n.time=t.time,n.isadult=t.isadult,n.sign=t.sign,n.logintype=t.logintype,n.agentPlusdata=t.agentPlusdata,n.token=t.token,t.m_socket.onSend(e.CmdCode.REQ_LoginForPlatform,n)},n.prototype.receiveCharacter=function(t){var n=this,a=Number(t.playerId);if(0>=a)n.m_panelMar.show(e.PanelClassConfig.ID_CreateRolePanel);else{var r=new e.GSelectCharacterM;r.playerId=a,n.m_socket.onSend(e.CmdCode.REQ_SelectCharacter,r)}},n.prototype.loginSuccess=function(t){var n=this;n.loginMapId=Number(t.mapId);var a=new e.GLoadFinishM;a.type=0,a.width=480,a.height=800,n.m_socket.onSend(e.CmdCode.REQ_GLoadFinish,a),n.isloginSuccess=!0,n.checkComeInGame()},n.prototype.checkComeInGame=function(){var t=this;if(t.loadZip&&t.loadMainRes){t.m_panelMar.show(e.PanelClassConfig.ID_MainUiPanel),t.loginMapId=100006,t.m_panelMar.closeAll(),t.m_panelMar.show(e.PanelClassConfig.ID_WelcomePanel),new e.SceneWindow,e.SceneManager.getInstance().changeMap(t.loginMapId,!1);var n=new e.AttrData;n.setValue(e.Enum_Attr.hp,100),n.setValue(e.Enum_Attr.totalHp,100),n.setValue(e.Enum_Attr.attack,1e3),e.HeroManager.getInstance().addRole(0,"player1",e.ENUM_JOB_TYPE.job_ZS,n,[10001,10002,10003,10004,10005,10006,10007,10008,10009,10010,10011]),e.HeroManager.getInstance().addRole(1,"player1",e.ENUM_JOB_TYPE.JOB_GJS,n,[11001,11002,11003,11004,11005,11006,11007,11008,11009,11010,11011]),Math.random()>.5&&e.HeroManager.getInstance().addRole(2,"player1",e.ENUM_JOB_TYPE.JOB_CK,n,[12001,12002,12003,12004,12005,12006,12007,12008,12009,12010,12011,12012]),Math.random()>.5&&e.HeroManager.getInstance().addRole(3,"player1",e.ENUM_JOB_TYPE.JOB_FS,n,[13001,13002,13003,13004,13005,13006,13007,13008,13009]),Math.random()>.5&&e.HeroManager.getInstance().addRole(4,"player1",e.ENUM_JOB_TYPE.JOB_WS,n,[14001,14002,14003,14004,14005,14006,14007,14008,14009,14010,14011,14012])}},n.prototype.loginFailed=function(e,t){},n.prototype.dinghaoInfo=function(e,t){},n}(DLG.BaseAction);e.LoginManager=t,__reflect(t.prototype,"game.LoginManager")}(game||(game={}));var game;!function(e){var t=function(t){function n(e,n){return t.call(this,e)||this}return __extends(n,t),n.prototype.onShow=function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];t.prototype.onShow.apply(this,n);var r=this;r.main=new e.LoginInputView,r.addChild(r.main),r.main.onLoadCallBack=r.initView,r.main.onLoadCallTarget=r},n.prototype.initView=function(){t.prototype.initView.call(this);var e=this;e.y=250,e.main.confirmBtn.setScaleClick(!0),e.main.confirmBtn.setOnClickListener(e,e.showLoginView)},n.prototype.showLoginView=function(){var t=this;if(!(t.main.userName.text.length<=0)){e.LoginManager.getInstance().loginUserName=t.main.userName.text,e.LoginManager.getInstance().agentPlusdata=t.main.password.text,DLG.DLGCore.panel.close(e.PanelClassConfig.ID_LoginInputPanel),DLG.DLGCore.panel.show(e.PanelClassConfig.ID_ServerPanel);var n=DLG.FactoryUtils.getClass(e.LoadMainResAction);n.onExecute()}},n.prototype.onDestroy=function(){t.prototype.onDestroy.call(this);var e=this;e.main&&(e.main.onLoadCallBack=void 0,e.main.onLoadCallTarget=void 0,e.main.onDestroy()),e.main=void 0},n}(DLG.VPanel);e.LoginInputPanel=t,__reflect(t.prototype,"game.LoginInputPanel")}(game||(game={}));var game;!function(e){var t=function(t){function n(e,n){var a=t.call(this,e)||this;return a.serverArr=[],a}return __extends(n,t),n.prototype.onShow=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.prototype.onShow.apply(this,e);var a=this;a.main=new SelectServerView,a.addChild(a.main),a.main.onLoadCallBack=a.initView,a.main.onLoadCallTarget=a},n.prototype.initView=function(){t.prototype.initView.call(this);var n=this;e.SelectBtnItem.onCallTarget=n,e.SelectBtnItem.onCallBack=n.onSelectClick,n.serverArr=e.LoginManager.getInstance().getServerData(),n.setCloseBtn(n.main.btn_close),n.main.serverList.itemRenderer=e.SelectServerItem,n.main.selectList.itemRenderer=e.SelectBtnItem,n.main.selectList.selectedIndex=0,n.onSelectClick()},n.prototype.renderViews=function(){for(var e=this,t=["最近登录","火爆新区"],n=Math.ceil(e.serverArr.length/10),a=0;n>a;a++)t.push(a+"1-"+10*(a+1)+"区");e.main.selectList.dataProvider=new eui.ArrayCollection(t)},n.prototype.onSelectClick=function(){var e=this,t=[];switch(e.main.selectList.selectedIndex){case 0:break;
case 1:t=e.serverArr.length<=4?e.serverArr:e.serverArr.slice(e.serverArr.length-3,e.serverArr.length);break;default:var n=e.serverArr.length,a=10*(e.main.selectList.selectedIndex-2),r=void 0;r=n>a+10?a+10:n,t=e.serverArr.slice(a,r)}e.main.serverList.dataProvider=new eui.ArrayCollection(t)},n.prototype.onDestroy=function(){t.prototype.onDestroy.call(this);var e=this;e.main&&(e.main.onLoadCallBack=void 0,e.main.onLoadCallTarget=void 0,e.main.onDestroy()),e.main=void 0},n}(DLG.VPanel);e.SelectServerPanel=t,__reflect(t.prototype,"game.SelectServerPanel")}(game||(game={}));var game;!function(e){var t=function(t){function n(e,n){return t.call(this,e)||this}return __extends(n,t),n.prototype.onShow=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.prototype.onShow.apply(this,e);var a=this;a.main=new ServerView,a.addChild(a.main),a.main.onLoadCallBack=a.initView,a.main.onLoadCallTarget=a},n.prototype.initView=function(){t.prototype.initView.call(this);var e=this;e.main.loginBg.source=String("loginBg_jpg"),e.main.btn_start.setOnClickListener(e,e.loginGame),e.main.selectServerBtn.setOnClickListener(e,e.selectServerHandle)},n.prototype.renderViews=function(){var t=this,n=e.LoginManager.getInstance().selectServerId;if(10>=n)t.main.serverName.text="内测"+n+"区(新服)";else{var a=n-10;t.main.serverName.text="公测"+a+"区(新服)"}},n.prototype.loginGame=function(){var t=e.ServerTable.getCfgById(e.LoginManager.getInstance().selectServerId),n=t.config,a=DLG.FactoryUtils.getClass(e.ConnectAction);a.connect(n)},n.prototype.selectServerHandle=function(){DLG.DLGCore.panel.show(e.PanelClassConfig.ID_SelectServerPanel)},n.prototype.onDestroy=function(){t.prototype.onDestroy.call(this);var e=this;e.main&&(e.main.onLoadCallBack=void 0,e.main.onLoadCallTarget=void 0,e.main.onDestroy()),e.main=void 0},n}(DLG.VPanel);e.ServerPanel=t,__reflect(t.prototype,"game.ServerPanel")}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this,n=t;return n.skinName="resource/skins/login/SelectBtn.exml",DLG.DLGCore.event.addEventListener(n,egret.TouchEvent.TOUCH_TAP,n,n.onSelfClick),t}return __extends(t,e),t.prototype.dataChanged=function(){var e=this;null!=e._data&&0!=e.isInitView&&(e.serverType.text=this.data+"")},t.prototype.onSelfClick=function(){t.onCallBack&&t.onCallBack.call(t.onCallTarget)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t}(DLG.CItemRenderer);e.SelectBtnItem=t,__reflect(t.prototype,"game.SelectBtnItem")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this,n=e;return n.skinName="resource/skins/login/SelectServerItem.exml",DLG.DLGCore.event.addEventListener(e,egret.TouchEvent.TOUCH_TAP,n,n.onBtnTouchHandler),e}return __extends(n,t),n.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this;null!=e.data&&0!=e.isInitView&&(e.serverId=e.data.serverId,e.data.serverId<=10?e.serverName.text="内测"+this.data.serverId+"区":e.serverName.text="公测"+(this.data.serverId-10)+"区")},n.prototype.onBtnTouchHandler=function(){var t=this;e.LoginManager.getInstance().selectServerId=t.serverId,DLG.DLGCore.panel.close(e.PanelClassConfig.ID_SelectServerPanel);var n=DLG.DLGCore.panel.getPanelById(e.PanelClassConfig.ID_ServerPanel);n.onRefresh()},n.prototype.onDestroy=function(){t.prototype.onDestroy.call(this)},n}(DLG.CItemRenderer);e.SelectServerItem=t,__reflect(t.prototype,"game.SelectServerItem")}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this,n=t;return n.skinName="resource/skins/login/LoginInput.exml",n.addEventListener(eui.UIEvent.CREATION_COMPLETE,n.createCompleteEvent,n),t}return __extends(t,e),t.prototype.createCompleteEvent=function(e){var t=this;t.isLoad=!0,t.removeEventListener(eui.UIEvent.CREATION_COMPLETE,t.createCompleteEvent,t),t.onLoadCallBack&&t.onLoadCallBack.call(t.onLoadCallTarget)},t.prototype.onDestroy=function(){var t=this;t.onLoadCallBack=null,t.onLoadCallTarget=null,t.isLoad=null,e.prototype.onDestroy.call(this)},t}(DLG.CComponent);e.LoginInputView=t,__reflect(t.prototype,"game.LoginInputView")}(game||(game={}));var SelectServerView=function(e){function t(){var t=e.call(this)||this,n=t;return n.skinName="resource/skins/login/SelectServer.exml",n.addEventListener(eui.UIEvent.CREATION_COMPLETE,n.createCompleteEvent,n),t}return __extends(t,e),t.prototype.createCompleteEvent=function(e){var t=this;t.isLoad=!0,t.removeEventListener(eui.UIEvent.CREATION_COMPLETE,t.createCompleteEvent,t),t.onLoadCallBack&&t.onLoadCallBack.call(t.onLoadCallTarget)},t.prototype.onDestroy=function(){var t=this;t.onLoadCallBack=null,t.onLoadCallTarget=null,t.isLoad=null,e.prototype.onDestroy.call(this)},t}(DLG.CComponent);__reflect(SelectServerView.prototype,"SelectServerView");var ServerView=function(e){function t(){var t=e.call(this)||this,n=t;return n.skinName="resource/skins/login/Server.exml",n.addEventListener(eui.UIEvent.CREATION_COMPLETE,n.createCompleteEvent,n),t}return __extends(t,e),t.prototype.createCompleteEvent=function(e){var t=this;t.isLoad=!0,t.removeEventListener(eui.UIEvent.CREATION_COMPLETE,t.createCompleteEvent,t),t.onLoadCallBack&&t.onLoadCallBack.call(t.onLoadCallTarget)},t.prototype.onDestroy=function(){var t=this;t.onLoadCallBack=null,t.onLoadCallTarget=null,t.isLoad=null,e.prototype.onDestroy.call(this)},t}(DLG.CComponent);__reflect(ServerView.prototype,"ServerView");var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this;e._selectTabId=0;var n=e;return n.createSocket(),n.createPanelMar(),e}return __extends(n,t),n.getInstance=function(){var e=this;return e._instance||(e._instance=new n),e._instance},Object.defineProperty(n.prototype,"selectTabId",{set:function(e){var t=this;t._selectTabId=e,t.m_panelMar.show(t._selectTabId)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"sceneId",{get:function(){return this._sceneId},set:function(t){this._sceneId=t;var n=DLG.DLGCore.panel.getPanelById(e.PanelClassConfig.ID_MainUiPanel);n.onRefresh()},enumerable:!0,configurable:!0}),n}(DLG.BaseAction);e.MainUIManager=t,__reflect(t.prototype,"game.MainUIManager")}(game||(game={}));var game;!function(e){var t=function(t){function n(e,n){return t.call(this,e)||this}return __extends(n,t),n.prototype.onShow=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.prototype.onShow.apply(this,e);var a=this;a.main=new MainUIView,a.addChild(a.main),a.main.onLoadCallBack=a.initView,a.main.onLoadCallTarget=a},n.prototype.initView=function(){t.prototype.initView.call(this);var n=this;n.mainUiArr=[{tabId:e.PanelClassConfig.ID_MissionPanel,img:"menubar_json.menubar_fight_png"},{tabId:e.PanelClassConfig.ID_WuHunPanel,img:"menubar_json.menubar_wuHun_png_png"},{tabId:e.PanelClassConfig.ID_HideWeaponPanel,img:"menubar_json.menubar_weapon_png"},{tabId:e.PanelClassConfig.ID_PvpMatchPanel,img:"menubar_json.menubar_pvp_png"},{tabId:e.PanelClassConfig.ID_BagPanel,img:"menubar_json.menubar_bag_png"}];var a=new eui.TileLayout;a.horizontalGap=-3,a.verticalGap=0,a.requestedRowCount=1,a.requestedColumnCount=5,n.main.mainList.layout=a,n.main.mainList.itemRenderer=e.MainUiItem,n.main.mainList.dataProvider=new eui.ArrayCollection(n.mainUiArr),this.onResizeHandler(),this.stage.addEventListener(egret.Event.RESIZE,this.onResizeHandler,this)},n.prototype.onResizeHandler=function(){var e=ApplicationManager.CONTENT_H,t=document.documentElement.clientHeight,n=ApplicationManager.globalScale;this.main.top_box.y=-(t-e*n)/(2*n),this.main.bottom_box.y=(t+e*n)/(2*n)-107},n.prototype.onRefresh=function(){if(!(e.MainUIManager.getInstance().sceneId<=0)){var t=e.SceneTable.getCfgById(e.MainUIManager.getInstance().sceneId);t&&(this.main.title_txt.text=t.name,this.main.des_txt.text=t.des)}},n.prototype.onDestroy=function(){this.stage.removeEventListener(egret.Event.RESIZE,this.onResizeHandler,this),t.prototype.onDestroy.call(this);var e=this;e.main&&(e.main.onLoadCallBack=void 0,e.main.onLoadCallTarget=void 0,e.main.onDestroy()),e.main=void 0},n}(DLG.VPanel);e.MainUIPanel=t,__reflect(t.prototype,"game.MainUIPanel")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this,n=e;return n.skinName="resource/skins/mainUi/MainUITabBarItem.exml",DLG.DLGCore.event.addEventListener(e,egret.TouchEvent.TOUCH_TAP,n,n.onBtnTouchHandler),e}return __extends(n,t),n.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this;null!=e.data&&0!=e.isInitView&&(e.btn.setScaleClick(!0),e.btn.setOnClickListener(e,e.onBtnTouchHandler),e.tabId=e.data.tabId,e.btn.img.source=e.data.img)},n.prototype.onBtnTouchHandler=function(){var t=this;e.MainUIManager.getInstance().selectTabId=t.tabId},n.prototype.onDestroy=function(){t.prototype.onDestroy.call(this)},n}(DLG.CItemRenderer);e.MainUiItem=t,__reflect(t.prototype,"game.MainUiItem")}(game||(game={}));var MainUIView=function(e){function t(){var t=e.call(this)||this,n=t;return n.skinName="resource/skins/mainUi/MainUIView.exml",n.addEventListener(eui.UIEvent.CREATION_COMPLETE,n.createCompleteEvent,n),t}return __extends(t,e),t.prototype.createCompleteEvent=function(e){var t=this;t.isLoad=!0,t.removeEventListener(eui.UIEvent.CREATION_COMPLETE,t.createCompleteEvent,t),t.onLoadCallBack&&t.onLoadCallBack.call(t.onLoadCallTarget)},t.prototype.onDestroy=function(){var t=this;t.onLoadCallBack=null,t.onLoadCallTarget=null,t.isLoad=null,e.prototype.onDestroy.call(this)},t}(DLG.CComponent);__reflect(MainUIView.prototype,"MainUIView");var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this;e.curTimes=7,e.maxTimes=10;var n=e;return n.createSocket(),n.createPanelMar(),e}return __extends(n,t),n.getInstance=function(){var e=this;return e._instance||(e._instance=new n,e._instance.initBagDatas()),e._instance},n.prototype.initBagDatas=function(){var e=0;this._mission=[];var t;for(e=0;5>e;e++)t=new MissionVo,t.missionId=100001+e,t.open=0==e,t.pass=!1,this._mission.push(t)},Object.defineProperty(n.prototype,"mission",{get:function(){return this._mission},enumerable:!0,configurable:!0}),n.prototype.enterMission=function(t){DLG.DLGCore.panel.closeAll(),e.SceneManager.getInstance().changeMap(t,!0)},n.prototype.updateMissionStatus=function(e){var t=0,n=this._mission.length;for(t=0;n>t;t++){var a=this._mission[t];if(a.missionId==e)return a.open=!0,a.pass=!0,a=this._mission[t+1],void(a&&(a.open=!0))}},n.prototype.getNextMission=function(e){var t=0,n=this._mission.length;for(t=0;n>t;t++){var a=this._mission[t];if(a.missionId==e){a.open=!0,a.pass=!0;var r=this._mission[t+1];return r?r.missionId:this._mission[0].missionId}}return this._mission[0].missionId},n}(DLG.BaseAction);e.MissonIManager=t,__reflect(t.prototype,"game.MissonIManager")}(game||(game={}));var game;!function(e){var t=function(t){function n(e,n){return t.call(this,e)||this}return __extends(n,t),n.prototype.onShow=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.prototype.onShow.apply(this,e);var a=this;a.main=new MissionView,a.addChild(a.main),a.main.onLoadCallBack=a.initView,a.main.onLoadCallTarget=a},n.prototype.initView=function(){t.prototype.initView.call(this);var n=this;n.initDefaultPanel(),n.main.vip_btn.setLabel(""),n.main.vip_btn.setScaleClick(!0),n.main.vip_btn.setOnClickListener(n,n.vipHandler);var a=new eui.TileLayout;a.verticalGap=-5,a.requestedColumnCount=1,n.main.list.layout=a,n.main.list.itemRenderer=e.MissionItem,n.updateView()},n.prototype.initDefaultPanel=function(){var e=this;e.main.close_btn.setScaleClick(!0),e.main.close_btn.setOnClickListener(e,e.closePanelHandler),e.main.back_btn.setScaleClick(!0),e.main.back_btn.setOnClickListener(e,e.closePanelHandler),e.main.tipLab.setLabel("目前挑战1000年及以上的魂兽，伤害前三名发放宗门宝箱")},n.prototype.updateView=function(){var t=this;t.main.initview(t.addHandler,t),t.main.addCom.updateView(e.MissonIManager.getInstance().curTimes,e.MissonIManager.getInstance().maxTimes),t.main.list.dataProvider=new eui.ArrayCollection(e.MissonIManager.getInstance().mission)},n.prototype.vipHandler=function(e){},n.prototype.addHandler=function(t){e.MissonIManager.getInstance().curTimes=Math.min(e.MissonIManager.getInstance().curTimes+1,e.MissonIManager.getInstance().maxTimes);var n=this;n.main.addCom.updateView(e.MissonIManager.getInstance().curTimes,e.MissonIManager.getInstance().maxTimes)},n.prototype.closePanelHandler=function(e){DLG.DLGCore.panel.closeAll()},n.prototype.onDestroy=function(){t.prototype.onDestroy.call(this);var e=this;e.main&&(e.main.onLoadCallBack=void 0,e.main.onLoadCallTarget=void 0,e.main.onDestroy()),e.main=void 0},n}(DLG.VPanel);e.MissionPanel=t,__reflect(t.prototype,"game.MissionPanel")}(game||(game={}));var game;!function(e){var t=function(t){function n(e,n){return t.call(this,e)||this}return __extends(n,t),n.prototype.onShow=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.prototype.onShow.apply(this,e);var a=this;a.main=new MissionResultView,a.addChild(a.main),a.main.onLoadCallBack=a.initView,a.main.onLoadCallTarget=a},n.prototype.initView=function(){t.prototype.initView.call(this);var n=this;n.initDefaultPanel(),n.main.close_btn.setLabel(""),n.main.close_btn.setScaleClick(!0),n.main.close_btn.setOnClickListener(n,n.closePanelHandler);var a=new eui.TileLayout;a.horizontalGap=35,a.verticalGap=25,a.requestedColumnCount=3,n.main.list.layout=a,n.main.list.itemRenderer=e.BagItem,n.main.list.dataProvider=new eui.ArrayCollection(e.BagIManager.getInstance().results),DLG.DLGCore.panel.close(e.PanelClassConfig.ID_WelcomePanel),DLG.DLGCore.panel.close(e.PanelClassConfig.ID_GuidePanel)},n.prototype.initDefaultPanel=function(){},n.prototype.closePanelHandler=function(t){DLG.DLGCore.panel.closeAll();var n=e.MissonIManager.getInstance().getNextMission(e.MainUIManager.getInstance().sceneId);e.SceneManager.getInstance().changeMap(n,!0)},n.prototype.onDestroy=function(){t.prototype.onDestroy.call(this);var e=this;e.main&&(e.main.onLoadCallBack=void 0,e.main.onLoadCallTarget=void 0,e.main.onDestroy()),e.main=void 0},n}(DLG.VPanel);e.MissonResultPanel=t,__reflect(t.prototype,"game.MissonResultPanel")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this;e._plus=1;var n=e;return n.skinName="resource/skins/mission/MissionItemSkin.exml",DLG.DLGCore.event.addEventListener(e,egret.TouchEvent.TOUCH_TAP,n,n.onBtnTouchHandler),e}return __extends(n,t),n.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var n=this;null!=n.data&&0!=n.isInitView&&(n.arrow_img.visible=0==n.itemIndex&&!e.MissonIManager.getInstance().clickFirstMission,n.arrow_img.visible?n.addTween():egret.Tween.removeTweens(this.arrow_img),n.vo=n.data,n.vo?(n._missionCfg=e.SceneTable.getCfgById(n.vo.missionId),n.mask_img.visible=!n.vo.open,n.label_txt1.text=n._missionCfg.name,n.label_txt2.text=n._missionCfg.age,n.bg_img.source=n.vo.pass?"mission_bg2_png":"mission_bg1_png"):(n.mask_img.visible=!1,n.label_txt1.text="",n.label_txt2.text="",n.bg_img.source="mission_bg1_png"))},n.prototype.addTween=function(){var e=this,t=e.arrow_img.x;e._plus*=-1;var n=t+30*e._plus;egret.Tween.get(e.arrow_img).to({x:n},500).call(e.addTween,e)},n.prototype.onBtnTouchHandler=function(){this.vo&&this.vo.open&&(0==this.itemIndex&&(e.MissonIManager.getInstance().clickFirstMission=!0),e.MissonIManager.getInstance().enterMission(this.vo.missionId))},n.prototype.onDestroy=function(){egret.Tween.removeTweens(this.arrow_img),t.prototype.onDestroy.call(this)},n}(DLG.CItemRenderer);e.MissionItem=t,__reflect(t.prototype,"game.MissionItem")}(game||(game={}));var MissionResultView=function(e){function t(){var t=e.call(this)||this,n=t;return n.skinName="resource/skins/mission/MissionResultViewSkin.exml",n.addEventListener(eui.UIEvent.CREATION_COMPLETE,n.createCompleteEvent,n),t}return __extends(t,e),t.prototype.createCompleteEvent=function(e){var t=this;t.isLoad=!0,t.removeEventListener(eui.UIEvent.CREATION_COMPLETE,t.createCompleteEvent,t),t.close_btn.img.source="mission_result_btn_png",t.onLoadCallBack&&t.onLoadCallBack.call(t.onLoadCallTarget)},t.prototype.onDestroy=function(){var t=this;t.onLoadCallBack=null,t.onLoadCallTarget=null,t.isLoad=null,e.prototype.onDestroy.call(this)},t}(DLG.CComponent);__reflect(MissionResultView.prototype,"MissionResultView");var MissionView=function(e){function t(){var t=e.call(this)||this,n=t;return n.skinName="resource/skins/mission/MissionViewSkin.exml",n.addEventListener(eui.UIEvent.CREATION_COMPLETE,n.createCompleteEvent,n),t}return __extends(t,e),t.prototype.createCompleteEvent=function(e){var t=this;t.isLoad=!0,t.removeEventListener(eui.UIEvent.CREATION_COMPLETE,t.createCompleteEvent,t),t.vip_btn.img.source="mission_btn_png",t.onLoadCallBack&&t.onLoadCallBack.call(t.onLoadCallTarget)},t.prototype.initview=function(e,t){var n=this;n.addCom=new AddItem(n.addItem,e,t)},t.prototype.onDestroy=function(){var t=this;t.onLoadCallBack=null,t.onLoadCallTarget=null,t.isLoad=null,e.prototype.onDestroy.call(this)},t}(DLG.CComponent);__reflect(MissionView.prototype,"MissionView");var MissionVo=function(){function e(){}return e}();__reflect(MissionVo.prototype,"MissionVo");var game;!function(e){var t=function(){function t(){}return t.getCfg=function(){var n=[["id","类路径","超类","层级"],["id","classpath","superclass","layer","canClose"],[t.ID_CreateRolePanel,"CreateRolePanel","IPanel",e.PanelLayer.CENTER,1],[t.ID_ServerPanel,"ServerPanel","IPanel",e.PanelLayer.CENTER,1],[t.ID_LoginInputPanel,"LoginInputPanel","IPanel",e.PanelLayer.CENTER,1],[t.ID_SelectServerPanel,"SelectServerPanel","IPanel",e.PanelLayer.CENTER,1],[t.ID_MissionPanel,"MissionPanel","IPanel",e.PanelLayer.CENTER,1],[t.ID_BagPanel,"BagPanel","IPanel",e.PanelLayer.CENTER,1],[t.ID_WuHunPanel,"WuHunPanel","IPanel",e.PanelLayer.CENTER,1],[t.ID_HideWeaponPanel,"WeaponPanel","IPanel",e.PanelLayer.CENTER,1],[t.ID_PvpMatchPanel,"PvpMatchPanel","IPanel",e.PanelLayer.CENTER,1],[t.ID_MainUiPanel,"MainUIPanel","IPanel",e.PanelLayer.MAIN_UI,0],[t.ID_LoadPanel,"LoadPanel","IPanel",e.PanelLayer.LOADING,0],[t.ID_GuidePanel,"GuidePanel","IPanel",e.PanelLayer.GUIDE,0],[t.ID_WelcomePanel,"WelcomPanel","IPanel",e.PanelLayer.GUIDE,0],[t.ID_SkillVmcPanel,"SkillVmcPanel","IPanel",e.PanelLayer.BOTTOM,0],[t.ID_TipsPanel,"ItemTipsPanel","IPanel",e.PanelLayer.Dialog,1],[t.ID_ResultPanel,"MissonResultPanel","IPanel",e.PanelLayer.CENTER,1]];return n},t}();t.ID_CreateRolePanel=1,t.ID_ServerPanel=2,t.ID_LoginInputPanel=3,t.ID_SelectServerPanel=5,t.ID_MainUiPanel=6,t.ID_BagPanel=7,t.ID_WuHunPanel=8,t.ID_HideWeaponPanel=9,t.ID_PvpMatchPanel=10,t.ID_MissionPanel=11,t.ID_LoadPanel=12,t.ID_GuidePanel=13,t.ID_WelcomePanel=14,t.ID_SkillVmcPanel=15,t.ID_TipsPanel=16,t.ID_ResultPanel=17,e.PanelClassConfig=t,__reflect(t.prototype,"game.PanelClassConfig")}(game||(game={}));var game;!function(e){var t=function(t){function n(e,n){return t.call(this,e)||this}return __extends(n,t),n.prototype.onShow=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.prototype.onShow.apply(this,e);var a=this;a.main=new PvpMatchView,a.addChild(a.main),a.main.onLoadCallBack=a.initView,a.main.onLoadCallTarget=a},n.prototype.initView=function(){t.prototype.initView.call(this);var e=this;e.initDefaultPanel(),e.main.vip_btn.setLabel(""),e.main.vip_btn.setScaleClick(!0),e.main.vip_btn.setOnClickListener(e,e.vipHandler),e.updateView()},n.prototype.initDefaultPanel=function(){var e=this;e.main.close_btn.setScaleClick(!0),e.main.close_btn.setOnClickListener(e,e.closePanelHandler),e.main.back_btn.setScaleClick(!0),e.main.back_btn.setOnClickListener(e,e.closePanelHandler),e.main.tipLab.setLabel("每日5点结算奖励")},n.prototype.updateView=function(){var t=this,n=e.PvpMatchManager.getInstance().pvpMsgInfo;t.main.initview(t.addHandler,t),t.main.headItem1.updateView(n.atkInfo),t.main.headItem2.updateView(n.defInfo),t.main.bar.updateView(n.curPro,n.maxPro),t.main.pvp_match_lab.text="赛季场次："+n.matchTimes,t.main.pvp_winTimes.text="赛季胜场："+n.winTimes,t.main.pvp_resTimes.text="剩余次数："+n.resTimes,t.main.addCom.updateView(n.resTimes,n.maxTimes)},n.prototype.closePanelHandler=function(e){DLG.DLGCore.panel.closeAll()},n.prototype.addHandler=function(t){var n=e.PvpMatchManager.getInstance().pvpMsgInfo;n.resTimes+=1,n.resTimes=Math.min(n.resTimes,n.maxTimes),this.main.addCom.updateView(n.resTimes,n.maxTimes)},n.prototype.vipHandler=function(t){e.MissonIManager.getInstance().enterMission(100020)},n.prototype.onDestroy=function(){t.prototype.onDestroy.call(this);var e=this;e.main&&(e.main.onLoadCallBack=void 0,e.main.onLoadCallTarget=void 0,e.main.onDestroy()),e.main=void 0},n}(DLG.VPanel);e.PvpMatchPanel=t,__reflect(t.prototype,"game.PvpMatchPanel")}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this,n=t;return n.createSocket(),n.createPanelMar(),t}return __extends(t,e),t.getInstance=function(){var e=this;return e._instance||(e._instance=new t,e._instance.initDatas()),e._instance},t.prototype.initDatas=function(){this._pvpMsgInfo=new PvpMsgInfo(!0),this._pvpMsgInfo.atkInfo},Object.defineProperty(t.prototype,"pvpMsgInfo",{get:function(){return this._pvpMsgInfo},enumerable:!0,configurable:!0}),t}(DLG.BaseAction);e.PvpMatchManager=t,__reflect(t.prototype,"game.PvpMatchManager")}(game||(game={}));var PvpHeadItem=function(){function e(e){this._main=e,this.bg_img=this._main.bg_img,this.icon_img=this._main.icon_img,this.label_txt=this._main.label_txt,this.icon_title=this._main.icon_title}return e.prototype.updateView=function(e){this._info=e,this.icon_img.source="pvp_head_"+this._info.sex+"_png",this.icon_title.source="pvp_lv_img_png",this.label_txt.text=this._info.name},e}();__reflect(PvpHeadItem.prototype,"PvpHeadItem");var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this,n=t;return n.skinName="resource/skins/weapon/PvpMathcItemSkin.exml",DLG.DLGCore.event.addEventListener(t,egret.TouchEvent.TOUCH_TAP,n,n.onBtnTouchHandler),t}return __extends(t,e),t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this;0!=t.isInitView&&(t.info=t.data,t.info?(t.label_txt.text=t.info.name,t.icon_img.source="wuHun_json.wuHun_head_"+t.info.sex+"_png"):(t.label_txt.text="",t.icon_img.source=null))},t.prototype.onBtnTouchHandler=function(){},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t}(DLG.CItemRenderer);e.PvpMathcItem=t,__reflect(t.prototype,"game.PvpMathcItem")}(game||(game={}));var PvpMatchView=function(e){function t(){var t=e.call(this)||this,n=t;return n.skinName="resource/skins/pvpMatch/PvpMatchViewSkin.exml",n.addEventListener(eui.UIEvent.CREATION_COMPLETE,n.createCompleteEvent,n),t}return __extends(t,e),t.prototype.createCompleteEvent=function(e){var t=this;t.isLoad=!0,t.removeEventListener(eui.UIEvent.CREATION_COMPLETE,t.createCompleteEvent,t),t.vip_btn.img.source="pvp_btn_png",t.bar=new BarItem(this.barItem),t.headItem1=new PvpHeadItem(t.item1),t.headItem2=new PvpHeadItem(t.item2),t.onLoadCallBack&&t.onLoadCallBack.call(t.onLoadCallTarget)},t.prototype.initview=function(e,t){var n=this;n.addCom=new AddItem(n.addItem,e,t)},t.prototype.onDestroy=function(){var t=this;t.onLoadCallBack=null,t.onLoadCallTarget=null,t.isLoad=null,e.prototype.onDestroy.call(this)},t}(DLG.CComponent);__reflect(PvpMatchView.prototype,"PvpMatchView");var FightInfo=function(){function e(){}return e}();__reflect(FightInfo.prototype,"FightInfo");var PvpMsgInfo=function(){function e(e){void 0===e&&(e=!1),e&&(this.atkInfo=new FightInfo,this.atkInfo.lv=100,this.atkInfo.name="poopy",this.atkInfo.pvpLv=1,this.atkInfo.pvpTitle="铜斗魂",this.atkInfo.sex=1,this.defInfo=new FightInfo,this.defInfo.lv=150,this.defInfo.name="愤怒的如花",this.defInfo.pvpLv=2,this.defInfo.pvpTitle="银斗魂",this.defInfo.sex=2,this.curPro=240,this.maxPro=800,this.matchTimes=3,this.winTimes=2,this.resTimes=7,this.maxTimes=10)}return e}();__reflect(PvpMsgInfo.prototype,"PvpMsgInfo");var game;!function(e){var t=function(t){function n(e,n){return t.call(this,e)||this}return __extends(n,t),n.prototype.onShow=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.prototype.onShow.apply(this,e);var a=this;a.main=new WeaponView,a.addChild(a.main),a.main.onLoadCallBack=a.initView,a.main.onLoadCallTarget=a},n.prototype.initView=function(){t.prototype.initView.call(this);var n=this;n.initDefaultPanel(),n._vmc||(n._vmc=new e.VMCView),e.WeaponItem.onCallTarget=n,e.WeaponItem.onCallBack=n.onSelectClick;var a=new eui.TileLayout;a.horizontalGap=-7,a.verticalGap=0,a.requestedColumnCount=5,n.main.list.layout=a,n.main.list.itemRenderer=e.WeaponItem,n.main.list.dataProvider=new eui.ArrayCollection(e.WeaponManager.getInstance().weaponArr),n.main.list.selectedIndex=0,n._curIndex=0,n._preIndex=0,n._curInfo=e.WeaponManager.getInstance().weaponArr[0],n.updateView()},n.prototype.initDefaultPanel=function(){var e=this;e.main.close_btn.setScaleClick(!0),e.main.close_btn.setOnClickListener(e,e.closePanelHandler),e.main.back_btn.setScaleClick(!0),e.main.back_btn.setOnClickListener(e,e.closePanelHandler),e.main.tipLab.setLabel("暗器属性对所有角色生效，暗器技能装备才生效")},n.prototype.onSelectClick=function(e,t){var n=this;return e?void(t!=n._curIndex&&(n._preIndex=n._curIndex,n._curIndex=t,n._curInfo=e,n.updateView())):void(n.main.list.selectedIndex=n._curIndex)},n.prototype.updateView=function(){var t=this;t.main.weapon_img.visible=!1,t.main.weapon_name.source="weapon_title_"+t._curInfo.weaponId+"_png",t.main.weapon_activity.visible=t._curInfo.activity,t.main.attr_hp.text="+"+t._curInfo.attrHp,t.main.attr_atk.text="+"+t._curInfo.attrAtk,t.main.attr_def.text="+"+t._curInfo.attrDef;var n=e.SkillTable.getCfgById(t._curInfo.skillId);t.main.skill_txt.text=n.desc,t._vmc.updatePose("fx_weapon_"+t._curInfo.weaponId,90,!0,!0,"",null,null),t._vmc.play(),this.main.vmc_box.addChild(t._vmc)},n.prototype.closePanelHandler=function(e){DLG.DLGCore.panel.closeAll()},n.prototype.onDestroy=function(){t.prototype.onDestroy.call(this);var e=this;e._vmc&&(e._vmc.destroy(),e._vmc=null),e.main&&(e.main.onLoadCallBack=void 0,e.main.onLoadCallTarget=void 0,e.main.onDestroy()),e.main=void 0},n}(DLG.VPanel);e.WeaponPanel=t,__reflect(t.prototype,"game.WeaponPanel")}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this,n=t;return n.skinName="resource/skins/weapon/WeaponItemSkin.exml",DLG.DLGCore.event.addEventListener(t,egret.TouchEvent.TOUCH_TAP,n,n.onBtnTouchHandler),t}return __extends(t,e),t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this;0!=t.isInitView&&(t.info=t.data,t.title_img.visible=t.info?!0:!1,t.label_txt.visible=!1,t.icon_lock.visible=t.info?!1:!0,t.info?(t.new_icon.visible=t.info.isNew,t.icon_img.source="head_icon"+t.info.weaponId+"_png",t.name_img.source="weapon_title_"+t.info.weaponId+"_png"):(t.new_icon.visible=!1,t.icon_img.source=null,t.name_img.source=null))},t.prototype.onBtnTouchHandler=function(){t.onCallBack&&t.onCallBack.call(t.onCallTarget,this.info,this.itemIndex)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t}(DLG.CItemRenderer);e.WeaponItem=t,__reflect(t.prototype,"game.WeaponItem")}(game||(game={}));var WeaponView=function(e){function t(){var t=e.call(this)||this,n=t;return n.skinName="resource/skins/weapon/WeaponView.exml",n.addEventListener(eui.UIEvent.CREATION_COMPLETE,n.createCompleteEvent,n),t}return __extends(t,e),t.prototype.createCompleteEvent=function(e){var t=this;t.isLoad=!0,t.removeEventListener(eui.UIEvent.CREATION_COMPLETE,t.createCompleteEvent,t),t.onLoadCallBack&&t.onLoadCallBack.call(t.onLoadCallTarget)},t.prototype.onDestroy=function(){var t=this;t.onLoadCallBack=null,t.onLoadCallTarget=null,t.isLoad=null,e.prototype.onDestroy.call(this)},t}(DLG.CComponent);__reflect(WeaponView.prototype,"WeaponView");var WeaponInfo=function(){function e(){}return e}();__reflect(WeaponInfo.prototype,"WeaponInfo");var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this,n=t;return n.createSocket(),n.createPanelMar(),t}return __extends(t,e),t.getInstance=function(){var e=this;return e._instance||(e._instance=new t,e._instance.initBagDatas()),e._instance},t.prototype.initBagDatas=function(){this._weaponArr=[];var e=new WeaponInfo;e.name="袖箭",e.weaponId=1,e.isNew=!0,e.activity=!0,e.attrHp=1e3,e.attrAtk=300,e.attrDef=280,e.skillId=12008,this._weaponArr.push(e),e=new WeaponInfo,e.name="龙须针",e.weaponId=2,e.activity=!1,e.attrHp=2800,e.attrAtk=440,e.attrDef=400,e.skillId=14003,this._weaponArr.push(e),e=new WeaponInfo,e.name="诸葛神弩",e.weaponId=3,e.activity=!1,e.attrHp=3501,e.attrAtk=530,e.attrDef=490,e.skillId=14009,this._weaponArr.push(e),e=new WeaponInfo,e.name="暴雨梨花针",e.weaponId=4,e.activity=!0,e.attrHp=3591,e.attrAtk=730,e.attrDef=890,e.skillId=14010,this._weaponArr.push(e),this._weaponArr.push(null)},Object.defineProperty(t.prototype,"weaponArr",{get:function(){return this._weaponArr},enumerable:!0,configurable:!0}),t}(DLG.BaseAction);e.WeaponManager=t,__reflect(t.prototype,"game.WeaponManager")}(game||(game={}));var game;!function(e){var t=function(t){function n(e,n){return t.call(this,e)||this}return __extends(n,t),n.prototype.onShow=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.prototype.onShow.apply(this,e);var a=this;a.main=new WuHunView,a.addChild(a.main),a.main.onLoadCallBack=a.initView,a.main.onLoadCallTarget=a},n.prototype.initView=function(){t.prototype.initView.call(this);var n=this;n.initDefaultPanel(),n.main.strength_btn.img.source="common_btn1_png",n.main.strength_btn.setLabel("魂核强化"),n.main.strength_btn.setScaleClick(!0),n.main.strength_btn.setOnClickListener(n,n.StrengthlHandler),n.main.bag_btn.setLabel("魂核背包"),n.main.bag_btn.setScaleClick(!0),n.main.bag_btn.setOnClickListener(n,n.openBaglHandler),n.main.item_1.myIndex=1,n.main.item_1.addEventListener(egret.TouchEvent.TOUCH_TAP,n.clickItemHandler,n),n.main.item_2.myIndex=2,n.main.item_2.addEventListener(egret.TouchEvent.TOUCH_TAP,n.clickItemHandler,n),n.main.item_3.myIndex=3,n.main.item_3.addEventListener(egret.TouchEvent.TOUCH_TAP,n.clickItemHandler,n),n.main.item_4.myIndex=4,n.main.item_4.addEventListener(egret.TouchEvent.TOUCH_TAP,n.clickItemHandler,n),n.main.item_5.myIndex=5,n.main.item_5.addEventListener(egret.TouchEvent.TOUCH_TAP,n.clickItemHandler,n),n.main.item_6.myIndex=6,n.main.item_6.addEventListener(egret.TouchEvent.TOUCH_TAP,n.clickItemHandler,n);var a=new eui.TileLayout;a.horizontalGap=0,a.verticalGap=0,a.requestedColumnCount=5,n.main.list.layout=a,n.main.list.itemRenderer=e.RoleItem,e.RoleItem.onCallTarget=n,e.RoleItem.onCallBack=n.onSelectClick,n.main.list.dataProvider=new eui.ArrayCollection(e.WuHunManager.getInstance().roleInfo),n.main.list.selectedIndex=0,n._curIndex=0,n._preIndex=0,n._curInfo=e.WuHunManager.getInstance().roleInfo[0],n.updateView()},n.prototype.initDefaultPanel=function(){var e=this;e.main.close_btn.setScaleClick(!0),e.main.close_btn.setOnClickListener(e,e.closePanelHandler),e.main.back_btn.setScaleClick(!0),e.main.back_btn.setOnClickListener(e,e.closePanelHandler),e.main.tipLab.setLabel("规则说明")},n.prototype.onSelectClick=function(e,t){var n=this;return e?void(t!=n._curIndex&&(n._preIndex=n._curIndex,n._curIndex=t,n._curInfo=e,n.updateView())):void(n.main.list.selectedIndex=n._curIndex)},n.prototype.updateView=function(){var e=this;e.main.item1.updateView(e._curInfo.open1,e._curInfo.itemId1),e.main.item2.updateView(e._curInfo.open2,e._curInfo.itemId2),e.main.item3.updateView(e._curInfo.open3,e._curInfo.itemId3),e.main.item4.updateView(e._curInfo.open4,e._curInfo.itemId4),e.main.item5.updateView(e._curInfo.open5,e._curInfo.itemId5),e.main.item6.updateView(e._curInfo.open6,e._curInfo.itemId6),e.main.attr_hp.text="+"+e._curInfo.attrHp,e.main.attr_atk.text="+"+e._curInfo.attrAtk,e.main.attr_def.text="+"+e._curInfo.attrDef,e.main.skill_icom.source="goods_99926_png",e.main.wuhun_img.source="wuHun_"+e._curInfo.modelId+"_png",this.updateScore()},n.prototype.updateScore=function(){this._curInfo.score=0,this._curInfo.open1&&(this._curInfo.score+=13),this._curInfo.open2&&(this._curInfo.score+=25),this._curInfo.open3&&(this._curInfo.score+=47),this._curInfo.open4&&(this._curInfo.score+=89),this._curInfo.open5&&(this._curInfo.score+=123),this._curInfo.open6&&(this._curInfo.score+=250);
var e=Math.floor(this._curInfo.score/100);this.main.score_100.source=e>0?"wuHun_score_"+e+"_png":null;var t=this._curInfo.score-100*Math.floor(this._curInfo.score/100);t=Math.floor(t/10),this.main.score_10.source=0>=e&&0>=t?null:"wuHun_score_"+t+"_png";var n=this._curInfo.score-10*Math.floor(this._curInfo.score/10);this.main.score_1.source="wuHun_score_"+n+"_png"},n.prototype.closePanelHandler=function(e){DLG.DLGCore.panel.closeAll()},n.prototype.StrengthlHandler=function(e){},n.prototype.openBaglHandler=function(e){},n.prototype.clickItemHandler=function(t){var n,a,r=t.currentTarget.myIndex;switch(r){case 1:n=this._curInfo.open1,a=this._curInfo.itemId1;break;case 2:n=this._curInfo.open2,a=this._curInfo.itemId2;break;case 3:n=this._curInfo.open3,a=this._curInfo.itemId3;break;case 4:n=this._curInfo.open4,a=this._curInfo.itemId4;break;case 5:n=this._curInfo.open5,a=this._curInfo.itemId5;break;case 6:n=this._curInfo.open6,a=this._curInfo.itemId6}e.ItemTipsControl.getInstance().initTips(a,n?2:1,this.clickBackFunc,this,[r])},n.prototype.clickBackFunc=function(e){var t,n,a,r=e[0];switch(r){case 1:this._curInfo.open1=!this._curInfo.open1,t=this._curInfo.open1,n=this._curInfo.itemId1,a=this.main.item1;break;case 2:this._curInfo.open2=!this._curInfo.open2,t=this._curInfo.open2,n=this._curInfo.itemId2,a=this.main.item2;break;case 3:this._curInfo.open3=!this._curInfo.open3,t=this._curInfo.open3,n=this._curInfo.itemId3,a=this.main.item3;break;case 4:this._curInfo.open4=!this._curInfo.open4,t=this._curInfo.open4,n=this._curInfo.itemId4,a=this.main.item4;break;case 5:this._curInfo.open5=!this._curInfo.open5,t=this._curInfo.open5,n=this._curInfo.itemId5,a=this.main.item5;break;case 6:this._curInfo.open6=!this._curInfo.open6,t=this._curInfo.open6,n=this._curInfo.itemId6,a=this.main.item6}a.updateView(t,n),this.updateScore()},n.prototype.onDestroy=function(){t.prototype.onDestroy.call(this);var e=this;e.main&&(e.main.onLoadCallBack=void 0,e.main.onLoadCallTarget=void 0,e.main.onDestroy()),e.main=void 0},n}(DLG.VPanel);e.WuHunPanel=t,__reflect(t.prototype,"game.WuHunPanel")}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this,n=t;return n.skinName="resource/skins/wuHun/RoleItemSkin.exml",DLG.DLGCore.event.addEventListener(t,egret.TouchEvent.TOUCH_TAP,n,n.onBtnTouchHandler),t}return __extends(t,e),t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this;0!=t.isInitView&&(t.info=t.data,t.info?(t.icon_title.source="wuHun_head_title_"+t.info.wuHunLv+"_png",t.icon_img.source="wuHun_head_"+t.info.modelId+"_png"):(t.icon_title.source=null,t.icon_img.source=null))},t.prototype.onBtnTouchHandler=function(){t.onCallBack&&t.onCallBack.call(t.onCallTarget,this.info,this.itemIndex)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t}(DLG.CItemRenderer);e.RoleItem=t,__reflect(t.prototype,"game.RoleItem")}(game||(game={}));var WuHunItem=function(){function e(e){this._main=e,this.icon_img=this._main.icon_img}return e.prototype.updateView=function(e,t){this.icon_img.source=e?"goods_"+t+"_png":"wuHun_add_icon_png"},e}();__reflect(WuHunItem.prototype,"WuHunItem");var WuHunView=function(e){function t(){var t=e.call(this)||this,n=t;return n.skinName="resource/skins/wuHun/WuHunView.exml",n.addEventListener(eui.UIEvent.CREATION_COMPLETE,n.createCompleteEvent,n),t}return __extends(t,e),t.prototype.createCompleteEvent=function(e){var t=this;t.isLoad=!0,t.removeEventListener(eui.UIEvent.CREATION_COMPLETE,t.createCompleteEvent,t),this.item1=new WuHunItem(t.item_1),this.item2=new WuHunItem(t.item_2),this.item3=new WuHunItem(t.item_3),this.item4=new WuHunItem(t.item_4),this.item5=new WuHunItem(t.item_5),this.item6=new WuHunItem(t.item_6),t.onLoadCallBack&&t.onLoadCallBack.call(t.onLoadCallTarget)},t.prototype.onDestroy=function(){var t=this;t.onLoadCallBack=null,t.onLoadCallTarget=null,t.isLoad=null,e.prototype.onDestroy.call(this)},t}(DLG.CComponent);__reflect(WuHunView.prototype,"WuHunView");var RoleVo=function(){function e(){}return e}();__reflect(RoleVo.prototype,"RoleVo");var WuhunItemInfo=function(){function e(){}return e}();__reflect(WuhunItemInfo.prototype,"WuhunItemInfo");var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this,n=t;return n.createSocket(),n.createPanelMar(),t}return __extends(t,e),t.getInstance=function(){var e=this;return e._instance||(e._instance=new t,e._instance.initBagDatas()),e._instance},t.prototype.initBagDatas=function(){var e=0;for(this._roleInfo=[],e=0;5>e;e++){var t=new RoleVo;t.lv=4*e+5,t.name="poopy"+e,t.modelId=e%5+1,t.activity=e%2==0,t.wuHunLv=e%2+1,t.itemId1=10001,t.itemId2=10002,t.itemId3=10003,t.itemId4=10004,t.itemId5=10005,t.itemId6=10006,t.open1=e%2==0,t.open2=e%3==0,t.open3=e%2==0,t.open4=e%3==0,t.open5=e%2==0,t.open6=e%1==0,t.score=100,t.attrHp=1424+10*e,t.attrAtk=859+10*e,t.attrDef=702+10*e,t.skillId=12011+e,this._roleInfo.push(t)}},Object.defineProperty(t.prototype,"roleInfo",{get:function(){return this._roleInfo},enumerable:!0,configurable:!0}),t}(DLG.BaseAction);e.WuHunManager=t,__reflect(t.prototype,"game.WuHunManager")}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e}();t.REQ_LOGIN=1201,t.REQ_LoginForPlatform=1205,t.REQ_SelectCharacter=1202,t.REQ_CreateCharacter=1203,t.REQ_GLoadFinish=1204,t.ACK_Character=1101,t.ACK_LoginSuccess=1102,t.ACK_LoginFailed=1106,t.ACK_MyInfo=2100,t.ACK_APersonOpt=2170,e.CmdCode=t,__reflect(t.prototype,"game.CmdCode")}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e}();e.MsgData=t,__reflect(t.prototype,"game.MsgData");var n=function(){function e(){}return e}();e.GLoginM=n,__reflect(n.prototype,"game.GLoginM");var a=function(){function e(){}return e}();e.GLoginForPlatformM=a,__reflect(a.prototype,"game.GLoginForPlatformM");var r=function(){function e(){}return e}();e.GSelectCharacterM=r,__reflect(r.prototype,"game.GSelectCharacterM");var o=function(){function e(){}return e}();e.GCreateCharacterM=o,__reflect(o.prototype,"game.GCreateCharacterM");var i=function(){function e(){}return e}();e.GLoadFinishM=i,__reflect(i.prototype,"game.GLoadFinishM")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var n=t.call(this)||this;n.isShowLog=!1;var a=n;a.m_sceneMar=e.SceneManager.getInstance(),a.createClock();var r=e.GlobalTable.getCfgById(e.ENUM_GLOBAL_ID.G_10001).valueStr.split("|");return a.hurtDeepMin=parseInt(r[0]),a.hurtDeepMax=parseInt(r[1]),r=e.GlobalTable.getCfgById(e.ENUM_GLOBAL_ID.G_10002).valueStr.split("|"),a.hurtImmuneMin=parseInt(r[0]),a.hurtImmuneMax=parseInt(r[1]),r=e.GlobalTable.getCfgById(e.ENUM_GLOBAL_ID.G_10003).valueStr.split("|"),a.critDamageMin=parseInt(r[0]),a.critDamageMax=parseInt(r[1]),r=e.GlobalTable.getCfgById(e.ENUM_GLOBAL_ID.G_10004).valueStr.split("|"),a.critRatioMin=parseInt(r[0]),a.critRatioMax=parseInt(r[1]),n}return __extends(n,t),n.prototype.damageBulletAttack=function(t,n){var a=this,r=DLG.Utils,o=e.HurtData.getHurtData(),i=n.getData(),l=t.attr,s=i.attr,c=0,u=0;if(t.luckHurtExRationMin&&t.luckHurtExRationkMax){var p=r.random(t.luckHurtExRationMin,t.luckHurtExRationkMax);c+=p,o.luckHurt=!0,a.isShowLog&&debug("幸运一击伤害加成"+p)}if(t.farHurtExRatio){var p=(e.SceneData.boundary-i.y)/e.SceneData.boundary*t.farHurtExRatio;0>p&&(p=0),p>t.farHurtExRatio&&(p=t.farHurtExRatio),c+=p,o.farHurt=!0,a.isShowLog&&debug("远距离攻击伤害加成"+p)}if(t.shortHurtExRatio){var p=(1-(e.SceneData.boundary-i.y)/e.SceneData.boundary)*t.shortHurtExRatio;0>p&&(p=0),p>t.shortHurtExRatio&&(p=t.shortHurtExRatio),c+=p,o.shortHurt=!0,a.isShowLog&&debug("近距离攻击伤害加成"+p)}if(t.anshaRatio&&1e4*Math.random()<=t.anshaRatio){var p=t.anshaHurtExRatio;c+=p,o.anShi=!0,a.isShowLog&&debug("暗杀伤害加成"+p),t.anshaLiSkillId}if(t.firstHurtExValue){var p=t.firstHurtExValue;c+=p,o.firstHurt=!0,a.isShowLog&&debug("先发制人伤害加成"+p)}if(t.bigWeaponHurtRatio){var p=t.bigWeaponHurtRatio;c+=p,o.bigWeaponHurt=!0,a.isShowLog&&debug("巨型武器伤害加成"+p)}if(t.mengDuHurtValueExRatio){var p=s.getValue(e.Enum_Attr.hp)*t.mengDuHurtValueExRatio;c+=p,o.mengDu=!0,a.isShowLog&&debug("猛毒伤害加成"+p)}if(t.forceSwoonRatio&&1e4*Math.random()<=t.forceSwoonRatio){o.forceSwoon=!0;var m=e.BuffManager.getInstance().onAddBuffToTargetData(i,11101,3e3,0,0);m.touch(),a.isShowLog&&debug("强打眩晕---")}if(i.isSwoonTime&&t.swoonHurtExRatio){var p=t.swoonHurtExRatio;c+=p,o.swoonHurt=!0,a.isShowLog&&debug("眩晕 伤害加成"+p)}var _;if(t.hpHurtExValueRatio&&(_=(s.getValue(e.Enum_Attr.hp)-s.getValue(e.Enum_Attr.totalHp))/s.getValue(e.Enum_Attr.totalHp)),a.isShowLog&&debug("-----------开始计算伤害--------"),a.hurtValue(o,t.job,l,s,i.buffsAttr,c,u,0,t.skillHurtDamage,t.bulletdamage),a.isShowLog&&debug("-----------伤害结果",o.hurt),t.hpHurtExValueRatio){var d=o.hurt*(1+_*(t.hpHurtExValueRatio/1e4));o.hurt=o.hurt+d,a.isShowLog&&debug("-----------失去体力额外伤害",d),a.isShowLog&&debug("-----------伤害结果",o.hurt)}if(t.isMolotov){a.isShowLog&&debug("触发火焰弹");var h=a.m_sceneMar.getNearRangeDriverByType(i.driverType,150,i.x,i.y),f=0,g=h.length;for(f=0;g>f;f++){var v=h[f],y=v.getData();if(y&&y.attr.getValue(e.Enum_Attr.hp)>0){var L=a.m_sceneMar.createDriverData(e.ENUM_DriverType.bullet);t.clone(L),L.isMolotov=void 0,a.damageBulletAttack(L,v)}}}if(t.isFlamer){a.isShowLog&&debug("触发火焰枪");var h=a.m_sceneMar.getNearRangeDriverByType(i.driverType,40,i.x,i.y,60),f=0,g=h.length;for(f=0;g>f;f++){var v=h[f],y=v.getData();if(y&&y.attr.getValue(e.Enum_Attr.hp)>0){var L=a.m_sceneMar.createDriverData(e.ENUM_DriverType.bullet);t.clone(L),L.isFlamer=void 0,a.damageBulletAttack(L,v)}}}var C=s.getValue(e.Enum_Attr.hp);if(C+=o.hurt,0>=C&&(C=0,e.BuffManager.getInstance().onActionTargetBuff(t,e.Enum_BuffTrigger.die),t.baoFaHurtRatio)){a.isShowLog&&debug("触发灵魂爆发");var h=a.m_sceneMar.getNearRangeDriverByType(i.driverType,150,i.x,i.y),f=0,g=h.length;for(f=0;g>f;f++){var v=h[f],y=v.getData();if(y&&y.attr.getValue(e.Enum_Attr.hp)>0){var L=a.m_sceneMar.createDriverData(e.ENUM_DriverType.bullet);t.clone(L),L.baoFaHurtRatio=void 0,L.skillHurtDamage=t.baoFaHurtRatio/1e4,a.damageBulletAttack(L,v)}}}a.isShowLog&&debug("==========================一次伤害结算完毕"),a.playHurtResult(n,o,t.effect),e.HurtData.returnHurtData(o)},n.prototype.playHurtResult=function(t,n,a){var r=this,o=t.getData(),i=o.attr,l=i.getValue(e.Enum_Attr.hp);l+=n.hurt,i.setValue(e.Enum_Attr.hp,l),t.showHpBar(!0),t.update(),r.showBlood(r.m_sceneMar.getEffectLayer(),o.x,o.y+o.byAttackRangeY,n.hurt),t.showEffect(a),t.showHitEffect()},n.prototype.hurtValue=function(t,n,a,r,o,i,l,s,c,u){var p,m,_,d=this;n==e.ENUM_JOB_TYPE.JOB_WS?(p=r.getValue(e.Enum_Attr.magicdefense)+o.getValue(e.Enum_Attr.magicdefense),_=o.getValue(e.Enum_Attr.magic_HurtImmune),m=a.getValue(e.Enum_Attr.magic_puncture)):(p=r.getValue(e.Enum_Attr.def)+o.getValue(e.Enum_Attr.def),_=o.getValue(e.Enum_Attr.physics_HurtImmune),m=a.getValue(e.Enum_Attr.physics_puncture));var h,f=a.getValue(e.Enum_Attr.attack),g=DLG.Utils;s/=1e4,d.isShowLog&&debug("-----------实质伤害加深",s),s<d.hurtDeepMin?s=d.hurtDeepMin:s>d.hurtDeepMax&&(s=d.hurtDeepMax),s=1+s,_/=1e4,d.isShowLog&&debug("-----------实质怪物免伤",_),_<d.hurtImmuneMin?_=d.hurtImmuneMin:_>d.hurtImmuneMax&&(_=d.hurtImmuneMax),_=1-_;var v=f*(1+i/1e4)+l,y=p-m;d.isShowLog&&(debug("-----------攻："+f+"----攻击加成比："+i+"----攻击加成值："+l),debug("-----------防："+p+"----破甲："+m)),h=(v-y)*s*_,d.isShowLog&&debug("-----------伤害值",-h);var L=a.getValue(e.Enum_Attr.crit);d.isShowLog&&debug("-----------实质暴击率",L/1e4),L<d.critRatioMin?L=d.critRatioMin:L>d.critRatioMax&&(L=d.critRatioMax);var C=r.getValue(e.Enum_Attr.resistcrit);if(L=(L-C)/1e4,L&&1e4*Math.random()<L){var E=a.getValue(e.Enum_Attr.critDamage);d.isShowLog&&debug("-----------实质暴击伤害倍数",E/1e4),E<d.critDamageMin?E=d.critDamageMin:E>d.critDamageMax&&(E=d.critDamageMax);var D=r.getValue(e.Enum_Attr.resistdamage);E=(E-D)/1e4,h*=1.5-E,d.isShowLog&&debug("-----------暴击后的伤害值",-h),t.isCrit=!0}h=h*c*u*(g.random(95,105)/100),d.isShowLog&&debug("-----------技能伤害系数",c),d.isShowLog&&debug("-----------子弹伤害系数",u),t.hurt=-Math.floor(h),d.isShowLog&&debug("-----------真实伤害值",h)},n.prototype.damageMonsterAttack=function(t,n){var a=t.getData(),r=a.attr.getValue(e.Enum_Attr.hit),o=a.buffsAttr.getValue(e.Enum_Attr.hit);if(o&&(r+=o),r-=n,1e4*Math.random()<r){var i=a.attr.getValue(e.Enum_Attr.attack);i+=a.buffsAttr.getValue(e.Enum_Attr.attack)}},n.prototype.showBlood=function(t,n,a,r){var o=e.FontBlood.createFontBlood();o.x=n,o.y=a,t.addChild(o),o.setNum(r)},n}(DLG.BaseAction);e.DamageAction=t,__reflect(t.prototype,"game.DamageAction")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var n=t.call(this)||this,a=n;return a.createClock(),a.m_sceneMar=e.SceneManager.getInstance(),a._damageAction=DLG.FactoryUtils.getClass(e.DamageAction),n}return __extends(n,t),n.prototype.bigSkillWuYingJian=function(t,n,a){var r=this;if(r.wuYingJianCount--,r.wuYingJianCount<=0)return void(r.wuYingJianTimeId&&(r.m_clock.removeTime(r.wuYingJianTimeId),r.wuYingJianTimeId=void 0));void 0==r.wuYingJianTimeId&&(r.wuYingJianTimeId=r.m_clock.addTime(100,0,r.bigSkillWuYingJian,r,[t,n,a],!0));for(var o,i=r.m_sceneMar.getAllMonster().concat(),l=!0;l&&i.length>0;){var s=DLG.Utils.random(0,i.length-1),c=i[s];o=r.m_sceneMar.getDriverById(c,e.ENUM_DriverType.monster);var u=o.getData();if(u.attr.getValue(e.Enum_Attr.hp)>0){l=!1,r.wuYingJianCount--;var p=e.HurtData.getHurtData(),m=DLG.FactoryUtils.getClass(e.DamageAction);m.hurtValue(p,t.job,t.attr,u.attr,u.buffsAttr,0,0,0,n,1),m.playHurtResult(o,p,a),e.HurtData.returnHurtData(p)}else i.splice(s,1),i.length<=0&&(r.wuYingJianCount=0,l=!1)}i.length=0,i=null},n.prototype.bigSkillJianRain=function(e,t,n){var a=this;a.swordRainCount=t;var r;a.swordRainCount>5?(r=5,a.swordRainCount-=5):(r=a.swordRainCount,a.swordRainCount=0),a.createWwordRain(e,r,n)},n.prototype.createWwordRain=function(t,n,a){var r=this,o=e.SkillTable.getCfgById(e.SkillType.JOB_GJS_11002),i=o.bullet;i=10001;var l=e.BulletTable.getCfgById(i),s=e.SceneData.roleStandPoint,c=0,u=n>s.length?s.length:n;for(c=0;u>c;c++){var p=DLG.Utils.random(-40,40);r.addBullet(t,1,0,l,!1,!1,a,s[Math.floor(c)]+p,t.y)}if(r.swordRainCount>0){var m=void 0;r.swordRainCount>5?(m=5,r.swordRainCount-=5):(m=r.swordRainCount,r.swordRainCount=0),r.m_clock.addTime(100,1,r.createWwordRain,r,[t,m,a],!0)}},n.prototype.bigSkillNahan=function(t,n){var a,r=this,o=r.m_sceneMar.getAllRoles();a=o.length;var i;for(i;a>i;i++){var l=r.m_sceneMar.getDriverById(o[i],e.ENUM_DriverType.role);if(l){var s=l.getData(),c=e.BuffManager.getInstance().onAddBuffToTargetData(s,1028,6e3,0,n);c.touch()}}},n.prototype.bigSkillChongJiBo=function(t){var n,a=this,r=a.m_sceneMar.getAllMonster(),o=0,i=r.length;for(o=0;i>o;o++)if(n=a.m_sceneMar.getDriverById(r[o],e.ENUM_DriverType.monster)){var l=n.getData();if(l.attr.getValue(e.Enum_Attr.hp)>0){var s=e.BuffManager.getInstance().onAddBuffToTargetData(l,11101,6e3,0,0);s.touch()}}},n.prototype.bigSkillBaoFeng=function(t,n,a){var r,o=this,i=o.m_sceneMar.getAllMonster(),l=0,s=i.length;for(l=0;s>l;l++)if(r=o.m_sceneMar.getDriverById(i[l],e.ENUM_DriverType.monster)){var c=r.getData();if(c.attr.getValue(e.Enum_Attr.hp)>0){var u=e.HurtData.getHurtData(),p=DLG.FactoryUtils.getClass(e.DamageAction);p.hurtValue(u,t.job,t.attr,c.attr,c.buffsAttr,0,0,0,n,1),p.playHurtResult(r,u,a),e.HurtData.returnHurtData(u)}}},n.prototype.onPutOnBullet=function(e){e.bulletCurrent=e.bulletCountMax},n.prototype.createBullet=function(t,n){var a=this;if(t.expendDoubleBulletRatio&&1e3*Math.random()<t.expendDoubleBulletRatio?t.bulletCurrent-=2:t.bulletCurrent--,0==t.bulletCurrent)if(Math.random()<e.HeroManager.getInstance().getQuickPutOnBullet())a.onPutOnBullet(t);else{var r=t.putOnBulletCDTime;r+=t.putOnBulletCDTimeEx,a.m_clock.addTime(r,1,a.onPutOnBullet,a,t)}if(t.job==e.ENUM_JOB_TYPE.job_ZS){var o=e.BulletTable.getCfgById(n),i=180*Math.atan2(t.y-t.attackPy,t.x-t.attackPx)/Math.PI-90,l=1e4*Math.random(),s=1;l>t.doubleRatio&&(s=2);var c=!1,u=1;if(t.bigWeaponHaveTimes)n=13002,c=!0,t.bigWeaponHaveTimes--;else if(-1!=t.skills.indexOf(e.SkillType.JOB_ZS_10010)){var p=1e4*Math.random();p<t.bigWeaponRatio&&(n=13002,c=!0)}var m=0,_=s;for(m=0;_>m;m++){var d=1,p=1e4*Math.random(),h=t.canThreeRatio;h>p&&(d=3),0==m?a.addBullet(t,d,i,o,!1,c):a.m_clock.addTime(50*m,1,a.addBullet,a,[t,d,i,o,!1,c],!0)}}else if(t.job==e.ENUM_JOB_TYPE.JOB_GJS){var o=e.BulletTable.getCfgById(n),i=180*Math.atan2(t.y-t.attackPy,t.x-t.attackPx)/Math.PI-90,u=1;if(t.infiniteArrowTimes)t.infiniteArrowTimes--,u=3;else{var p=1e4*Math.random(),h=t.canThreeRatio,f=t.canFiveRatio;f>p?u=5:(p=1e4*Math.random(),h>p&&(u=3))}a.addBullet(t,u,i,o)}else if(t.job==e.ENUM_JOB_TYPE.JOB_CK){var o=e.BulletTable.getCfgById(n),i=180*Math.atan2(t.y-t.attackPy,t.x-t.attackPx)/Math.PI-90,g=!1,u=1,p=1e4*Math.random(),h=t.canThreeRatio;h>p&&(u=3),a.addBullet(t,u,i,o,g)}else if(t.job==e.ENUM_JOB_TYPE.JOB_FS){var u=1,v=!1;if(-1!=t.skills.indexOf(e.SkillType.JOB_FS_13006)){var p=1e4*Math.random();p<t.molotovRatio&&(n=14001,v=!0)}var o=e.BulletTable.getCfgById(n),i=180*Math.atan2(t.y-t.attackPy,t.x-t.attackPx)/Math.PI-90;a.addBullet(t,u,i,o,!1,void 0,void 0,void 0,void 0,v)}else if(t.job==e.ENUM_JOB_TYPE.JOB_WS){var o=e.BulletTable.getCfgById(n),i=180*Math.atan2(t.y-t.attackPy,t.x-t.attackPx)/Math.PI-90,l=1e4*Math.random(),s=1;l>t.doubleRatio&&(s=2);var m=0,_=s,y=void 0;if(-1!=t.skills.indexOf(e.SkillType.JOB_WS_14011)){var p=1e4*Math.random();p<t.flamerRatio&&(n=14001,y=!0)}for(m=0;_>m;m++){var u=1,p=1e4*Math.random(),f=t.canFiveRatio;f>p&&(u=5),0==m?a.addBullet(t,u,i,o,void 0,void 0,void 0,void 0,void 0,void 0,y):a.m_clock.addTime(50*m,1,a.addBullet,a,[t,u,i,o,void 0,void 0,void 0,void 0,void 0,void 0,y],!0)}}},n.prototype.useSkill=function(t,n,a){var r=this,o=t.getData();if(o.attr.getValue(e.Enum_Attr.hp)>0)if(o.driverType==e.ENUM_DriverType.role){var i=e.SkillTable.getCfgById(n);i&&(n==e.SkillType.JOB_ZS_10002?(r.wuYingJianCount=30,r.bigSkillWuYingJian(o,5,3)):n==e.SkillType.JOB_GJS_11002?r.bigSkillJianRain(o,50,3):n==e.SkillType.JOB_CK_12002?r.bigSkillNahan(6e3,3e4):n==e.SkillType.JOB_FS_13003?r.bigSkillChongJiBo(3e3):n==e.SkillType.JOB_WS_14002?r.bigSkillBaoFeng(o,3,i.effect):r.createBullet(o,i.bullet),r.setSkillCdTime(o.id,n))}else{var i=e.SkillTable.getCfgById(n);i&&r._damageAction.damageMonsterAttack(t,a)}},n.prototype.setSkillCdTime=function(e,t){var n,a=this,r=a.m_sceneMar.getSkillCdMap();r.hasOwnProperty(e+"")?n=r[e+""]:(n={},r[e+""]=n),n[t+""]=a.m_clock.getTime()},n.prototype.checkCanUseSkill=function(t,n,a){var r=this,o=e.SkillTable.getCfgById(n);if(o&&o.distance>=a){var i=r.m_sceneMar.getSkillCdMap(),l=void 0;if(!i.hasOwnProperty(t+""))return!0;l=i[t+""];var s=o.cd,c=r.m_clock.getTime();if(l.hasOwnProperty(n+"")&&c-l[n+""]>s)return!0}return!1},n.prototype.checkSkillDistance=function(t,n){var a=e.SkillTable.getCfgById(t);return a.distance>=n?!0:!1},n.prototype.checkSkillIsCD=function(t,n,a){var r,o=this,i=o.m_sceneMar.getSkillCdMap();if(!i.hasOwnProperty(t+""))return!1;r=i[t+""];var l=e.SkillTable.getCfgById(n).cd;if(a&&(l+=a),0==l)return!1;var s=o.m_clock.getTime();return r.hasOwnProperty(n+"")?s-r[n+""]>l?!1:!0:!1},n.prototype.clearSkillCd=function(){var e=this,t=e.m_sceneMar.getSkillCdMap();t={}},n.prototype.clearDriverSkillCD=function(e){var t=this,n=t.m_sceneMar.getSkillCdMap();if(n.hasOwnProperty(e+"")){var a=n[e+""];for(var r in a)a.hasOwnProperty(r)&&(a[r]=void 0,delete[r]);n[e+""]=void 0,delete n[e+""]}},n.prototype.addBullet=function(t,n,a,r,o,i,l,s,c,u,p){var m=this,_=t.attr.getValue(e.Enum_Attr.attack),d=t.attr.getValue(e.Enum_Attr.crit),h=t.attr.getValue(e.Enum_Attr.critDamage),f=t.attr.getValue(e.Enum_Attr.physics_puncture),g=t.attr.getValue(e.Enum_Attr.magic_puncture),v=0;for(v=0;n>v;v++){var y=m.m_sceneMar.createDriverData(e.ENUM_DriverType.bullet);y.masterId=t.id,s?y.x=s:y.x=t.x,c?y.y=c:y.y=t.y-50,y.job=t.job,y.movieName=r.movieName,y.effect=r.effect,y.rotateMove=1==r.rotate,y.isPierce=1==r.penetration,y.isPierce&&(y.pierceMaxNum=r.penetrationnum),y.moveAttackRange=r.damagerange,y.attr.setValue(e.Enum_Attr.attack,_),y.attr.setValue(e.Enum_Attr.speed,r.speed),y.attr.setValue(e.Enum_Attr.crit,d),y.attr.setValue(e.Enum_Attr.critDamage,h),y.attr.setValue(e.Enum_Attr.physics_puncture,f),y.attr.setValue(e.Enum_Attr.magic_puncture,g),y.luckHurtExRationMin=t.luckHurtExRationMin,y.luckHurtExRationkMax=t.luckHurtExRationkMax,y.farHurtExRatio=t.farHurtExRatio,y.shortHurtExRatio=t.shortHurtExRatio,y.anshaRatio=t.anshaRatio,y.anshaHurtExRatio=t.anshaHurtExRatio,y.skillHurtDamage=void 0==l?1:l,y.bulletdamage=r.bulletdamage,o&&(y.firstHurtExValue=t.firstHurtExValue),y.mengDuHurtValueExRatio=t.mengDuHurtValueExRatio,i&&(y.bigWeaponHurtRatio=t.bigWeaponHurtRatio),u&&(y.isMolotov=!0),p&&(y.isFlamer=!0),y.forceSwoonRatio=t.forceSwoonRatio,y.swoonHurtExRatio=t.swoonHurtExRatio,y.baoFaHurtRatio=t.baoFaHurtRatio,y.hpHurtExValueRatio=t.hpHurtExValueRatio,y.isPierce&&(y.hitTargetIds=[]),1==n?y.rotation=a:2==n?(0==v&&(y.rotation=a-10),1==v&&(y.rotation=a+10)):3==n?(0==v&&(y.rotation=a-10),1==v&&(y.rotation=a),2==v&&(y.rotation=a+10)):3==n?(0==v&&(y.rotation=a-20),1==v&&(y.rotation=a-10),2==v&&(y.rotation=a+10),3==v&&(y.rotation=a+20)):5==n&&(0==v&&(y.rotation=a-20),1==v&&(y.rotation=a-10),2==v&&(y.rotation=a),3==v&&(y.rotation=a+10),4==v&&(y.rotation=a+20)),m.m_sceneMar.addDriver(y)}},n}(DLG.BaseAction);e.UseSkillAction=t,__reflect(t.prototype,"game.UseSkillAction")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this,n=e;return n.createClock(),n.buffTargets=[],n.m_clock.addTime(1e3,1,n.onCheckBuffHandler,n,null),e}return __extends(n,t),n.getInstance=function(){var e=this;return e._instance||(e._instance=new n),e._instance},n.prototype.onCheckBuffHandler=function(){var t,n,a=this;t=a.buffTargets.length;var r;for(n=0;t>n;){if(r=a.buffTargets[n],!r.buffs){a.buffTargets.splice(n,1);break}a.onActionTargetBuff(r,e.Enum_BuffTrigger.time),a.checkkBuffTimeOut(r),n++}},n.prototype.onAddBuffToTargetData=function(t,n,a,r,o){var i,l=this,s=e.BuffTable.getCfgById(n),c=t.buffs[s.trigger],u=0,p=c.length,m=l.m_clock.getTime(),_=!1;for(u=0;p>u;u++)if(c[u].buffId==n){_=!0;break}return i=e.BuffData.getBuffData(),i.buffId=n,c.push(i),s.trigger==e.Enum_BuffTrigger.time&&(i.nextTouchTime=m+1e3,0==_&&l.buffTargets.push(t)),i.actionType=s.actionType,i.mySelfData=t,i.trigger=s.trigger,i.buf_attack_num=r,i.buf_attack_per=o,0==a?i.endTime=m+864e5:i.endTime=m+a,i},n.prototype.onActionTargetBuff=function(t,n){var a,r=this,o=t.buffs[n],i=0,l=o.length;if(n==e.Enum_BuffTrigger.time){var s=r.m_clock.getTime();for(i=0;l>i;i++)a=o[i],s>a.nextTouchTime&&a.touch()}else if(n==e.Enum_BuffTrigger.die){if(t.attr.getValue(e.Enum_Attr.hp)<=0)for(i=0;l>i;i++)a=o[i],a.touch()}else if(n==e.Enum_BuffTrigger.shooting)for(i=0;l>i;i++)a=o[i],a.touch();else if(n==e.Enum_BuffTrigger.create)for(i=0;l>i;i++)a=o[i],a.touch()},n.prototype.checkkBuffTimeOut=function(t){var n=this,a=n.m_clock.getTime(),r=0,o=e.Enum_BuffTrigger.max;for(r=1;o>=r;r++){var i=t.buffs[o];if(void 0!=i){var l,s=0,c=i.length;if(t.attr.getValue(e.Enum_Attr.hp)<0)return;for(s=0;c>s&&(l=i[s],void 0!=l);)-1!=l.endTime&&(l.endTime<=a?(l.cancelBuff(),c=i.length):s++)}}},n.prototype.onClearSceneHeroBuff=function(){var t=e.SceneManager.getInstance(),n=t.getAllRoles(),a=0,r=n.length;for(a=0;r>a;a++){var o=t.getDriverById(n[a],e.ENUM_DriverType.role);if(o){var i=o.getData();i.clearBuff()}}},n}(DLG.BaseAction);e.BuffManager=t,__reflect(t.prototype,"game.BuffManager")}(game||(game={}));var game;!function(e){var t=function(){function t(){this.attr_dic=new Object}return t.prototype.setValue=function(e,t){this.attr_dic[e+""]=t},t.prototype.getValue=function(e){var t=this;return t.attr_dic.hasOwnProperty(e+"")?t.attr_dic[e+""]:0},t.prototype.clear=function(){var e=this;e.attr_dic=null},t.prototype.clone=function(t){var n=this;t.setValue(e.Enum_Attr.hp,n.getValue(e.Enum_Attr.hp)),t.setValue(e.Enum_Attr.totalHp,n.getValue(e.Enum_Attr.totalHp)),t.setValue(e.Enum_Attr.speed,n.getValue(e.Enum_Attr.speed)),t.setValue(e.Enum_Attr.def,n.getValue(e.Enum_Attr.def)),t.setValue(e.Enum_Attr.magicdefense,n.getValue(e.Enum_Attr.magicdefense)),t.setValue(e.Enum_Attr.attack,n.getValue(e.Enum_Attr.attack)),t.setValue(e.Enum_Attr.crit,n.getValue(e.Enum_Attr.crit)),t.setValue(e.Enum_Attr.critDamage,n.getValue(e.Enum_Attr.critDamage)),t.setValue(e.Enum_Attr.tenacity,n.getValue(e.Enum_Attr.tenacity)),t.setValue(e.Enum_Attr.physics_puncture,n.getValue(e.Enum_Attr.physics_puncture)),t.setValue(e.Enum_Attr.magic_puncture,n.getValue(e.Enum_Attr.magic_puncture)),t.setValue(e.Enum_Attr.physics_HurtImmune,n.getValue(e.Enum_Attr.physics_HurtImmune)),t.setValue(e.Enum_Attr.magic_HurtImmune,n.getValue(e.Enum_Attr.magic_HurtImmune)),t.setValue(e.Enum_Attr.hit,n.getValue(e.Enum_Attr.hit)),t.setValue(e.Enum_Attr.resistcrit,n.getValue(e.Enum_Attr.resistcrit)),t.setValue(e.Enum_Attr.resistdamage,n.getValue(e.Enum_Attr.resistdamage))},t}();e.AttrData=t,__reflect(t.prototype,"game.AttrData")}(game||(game={}));var game;!function(e){var t=function(){function t(){}return t.prototype.touch=function(){var t,n=this;t=e.SceneManager.getInstance().getDriverById(n.mySelfData.id,n.mySelfData.driverType);var a;a=t?t.getData():n.mySelfData;var r;if(n.actionType==e.ENUM_BuffEffect.HP){var o=a.attr.getValue(e.Enum_Attr.hp),i=n.getValue(o);a.attr.setValue(e.Enum_Attr.hp,o+i),t&&t.update()}else if(n.actionType==e.ENUM_BuffEffect.SPEED){var l=a.attr.getValue(e.Enum_Attr.speed),s=n.getValue(l);a.attr.setValue(e.Enum_Attr.speed,l+s)}else if(n.actionType==e.ENUM_BuffEffect.CRITIC)r=e.Enum_Attr.crit;else if(n.actionType==e.ENUM_BuffEffect.PHYSICS_DEF)r=e.Enum_Attr.def;else if(n.actionType==e.ENUM_BuffEffect.MAGIC_DEF)r=e.Enum_Attr.magicdefense;else if(n.actionType==e.ENUM_BuffEffect.ATTACK)r=e.Enum_Attr.attack;else if(n.actionType==e.ENUM_BuffEffect.HIT)r=e.Enum_Attr.hit;else if(n.actionType==e.ENUM_BuffEffect.ATTACK_SPEED);else if(n.actionType==e.ENUM_BuffEffect.PUTON_BULLET_SPEED)a.putOnBulletCDTimeEx=n.getValue(a.putOnBulletCDTime);else if(n.actionType==e.ENUM_BuffEffect.ATTACK_EXPEND_SPEED){if(a.driverType==e.ENUM_DriverType.role){var c=a.expendDoubleBulletRatio,u=n.getValue(c);a.expendDoubleBulletRatio=u}}else if(n.actionType==e.ENUM_BuffEffect.SWOON)a.driverType==e.ENUM_DriverType.monster&&(a.isSwoonTime?a.isSwoonTime<n.endTime&&(a.isSwoonTime=n.endTime):a.isSwoonTime=n.endTime);else if(n.actionType==e.ENUM_BuffEffect.HP_MAX){var p=a.attr.getValue(e.Enum_Attr.totalHp),m=n.getValue(p);a.attr.setValue(e.Enum_Attr.totalHp,p+m);var o=a.attr.getValue(e.Enum_Attr.hp);a.attr.setValue(e.Enum_Attr.hp,o+m),t&&t.update()}else n.actionType==e.ENUM_BuffEffect.MAGIC_HURT_IMMUNE?r=e.Enum_Attr.magic_HurtImmune:n.actionType==e.ENUM_BuffEffect.PHYSICS_HURT_IMMUNE?r=e.Enum_Attr.physics_HurtImmune:n.actionType==e.ENUM_BuffEffect.PHYSICS_PUNCTURE?r=e.Enum_Attr.physics_puncture:n.actionType==e.ENUM_BuffEffect.MAGIC_PUNCTURE&&(r=e.Enum_Attr.magic_puncture);if(r){var _=a.attr.getValue(r),d=a.buffsAttr.getValue(r);void 0==d&&(d=0),n.resultValue=n.getValue(_),a.buffsAttr.setValue(r,d+n.resultValue)}},t.prototype.cancelBuff=function(){var t,n=this;t=e.SceneManager.getInstance().getDriverById(n.mySelfData.id,n.mySelfData.driverType);var a;a=t?t.getData():n.mySelfData;var r;if(n.actionType==e.ENUM_BuffEffect.HP||n.actionType==e.ENUM_BuffEffect.SPEED||(n.actionType==e.ENUM_BuffEffect.CRITIC?r=e.Enum_Attr.crit:n.actionType==e.ENUM_BuffEffect.PHYSICS_DEF?r=e.Enum_Attr.def:n.actionType==e.ENUM_BuffEffect.MAGIC_DEF?r=e.Enum_Attr.magicdefense:n.actionType==e.ENUM_BuffEffect.ATTACK?r=e.Enum_Attr.attack:n.actionType==e.ENUM_BuffEffect.HIT?r=e.Enum_Attr.hit:n.actionType==e.ENUM_BuffEffect.ATTACK_SPEED||(n.actionType==e.ENUM_BuffEffect.PUTON_BULLET_SPEED?a.putOnBulletCDTimeEx=0:n.actionType==e.ENUM_BuffEffect.ATTACK_EXPEND_SPEED?a.expendDoubleBulletRatio=0:n.actionType==e.ENUM_BuffEffect.SWOON||n.actionType==e.ENUM_BuffEffect.HP_MAX||(n.actionType==e.ENUM_BuffEffect.MAGIC_HURT_IMMUNE?r=e.Enum_Attr.magic_HurtImmune:n.actionType==e.ENUM_BuffEffect.PHYSICS_HURT_IMMUNE?r=e.Enum_Attr.physics_HurtImmune:n.actionType==e.ENUM_BuffEffect.PHYSICS_PUNCTURE?r=e.Enum_Attr.physics_puncture:n.actionType==e.ENUM_BuffEffect.MAGIC_PUNCTURE&&(r=e.Enum_Attr.magic_puncture)))),r){var o=a.buffsAttr.getValue(r);if(void 0==o)return;a.buffsAttr.setValue(r,o-n.resultValue)}},t.prototype.getValue=function(e,t){void 0===t&&(t=0);var n=0,a=this;return 0==isNaN(a.buf_attack_num)&&0!=a.buf_attack_num?n=a.buf_attack_num:0==isNaN(a.buf_attack_per)&&0!=a.buf_attack_per&&(n=a.buf_attack_per/1e4*e),0==t?Math.floor(n):n},t.prototype.clear=function(){var e=this;e.endTime=void 0,e.nextTouchTime=void 0,e.effect=void 0,e.actionType=void 0,e.trigger=void 0,e.buf_attack_num=void 0,e.buf_attack_per=void 0,e.resultValue=void 0,e.mySelfData=void 0},t.getBuffData=function(){if(t._pool.length>0)return t._pool.shift();var e=new t;return e.id=t.ID,t.ID++,t.ID==Number.MAX_VALUE&&(t.ID=Number.MIN_VALUE),e},t.returnBuffData=function(e){e.clear(),t._pool.push(e)},t}();t.ID=0,t._pool=[],e.BuffData=t,__reflect(t.prototype,"game.BuffData")}(game||(game={}));var game;!function(e){var t=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.clone=function(e){var t=this;e.masterId=t.masterId,e.job=t.job,e.rotateMove=t.rotateMove,e.moveAttackRange=t.moveAttackRange,e.hittedEnlargeRange=t.hittedEnlargeRange,e.effect=t.effect,e.rotation=t.rotation,e.hitTargetIds=t.hitTargetIds,e.luckHurtExRationMin=t.luckHurtExRationMin,e.luckHurtExRationkMax=t.luckHurtExRationkMax,e.farHurtExRatio=t.farHurtExRatio,e.shortHurtExRatio=t.shortHurtExRatio,e.anshaRatio=t.anshaRatio,e.anshaHurtExRatio=t.anshaHurtExRatio,e.anshaLiSkillId=t.anshaLiSkillId,e.firstHurtExValue=t.firstHurtExValue,e.mengDuHurtValueExRatio=t.mengDuHurtValueExRatio,e.bigWeaponHurtRatio=t.bigWeaponHurtRatio,e.forceSwoonRatio=t.forceSwoonRatio,e.swoonHurtExRatio=t.swoonHurtExRatio,e.baoFaHurtRatio=t.baoFaHurtRatio,e.hpHurtExValueRatio=t.hpHurtExValueRatio,e.skillHurtDamage=t.skillHurtDamage,e.bulletdamage=t.bulletdamage},t.prototype.clear=function(){e.prototype.clear.call(this);var t=this;t.masterId=void 0,t.rotation=void 0,t.rotateMove=void 0,t.hitTargetIds&&t.hitTargetIds.length>0&&(t.hitTargetIds.length=0),t.hitTargetIds=void 0,t.isPierce=!1,t.pierceMaxNum=void 0,t.moveAttackRange=0,t.hittedEnlargeRange=0,t.effect=void 0},t}(e.DriverData);e.BulletData=t,__reflect(t.prototype,"game.BulletData")}(game||(game={}));var DLG;!function(e){var t=function(){function e(){}return e.prototype.onDestroy=function(){this.label=null,this.color=null,this.strokeColor=null,this.data=null},e}();e.TabItemData=t,__reflect(t.prototype,"DLG.TabItemData")}(DLG||(DLG={}));var game;!function(e){var t=function(){function e(){}return e.prototype.clear=function(){var e=this;e.hurt=void 0,e.luckHurt=void 0,e.farHurt=void 0,e.shortHurt=void 0,e.anShi=void 0,e.firstHurt=void 0,e.mengDu=void 0,e.bigWeaponHurt=void 0,e.forceSwoon=void 0,e.swoonHurt=void 0,e.baoFaHurt=void 0,e.isSwoon=void 0},e.getHurtData=function(){if(e._pool.length>0)return e._pool.shift();var t=new e;return t},e.returnHurtData=function(t){t.clear(),e._pool.push(t)},e}();t._pool=[],e.HurtData=t,__reflect(t.prototype,"game.HurtData")}(game||(game={}));var game;!function(e){var t=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.clear=function(){e.prototype.clear.call(this);var t=this;t.byAttackRangeW=void 0,t.byAttackRangeH=void 0,t.byAttackRangeY=void 0,t.isBoss=void 0,t.monsterCfgId=void 0,t.targetY=void 0,t.isSwoonTime=void 0},t}(e.DriverData);e.MonsterData=t,__reflect(t.prototype,"game.MonsterData")}(game||(game={}));var game;!function(e){var t=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.clear=function(){e.prototype.clear.call(this);var t=this;t.attackPx=void 0,t.attackPy=void 0,t.index=void 0,t.heroId=void 0},t}(e.DriverData);e.RoleData=t,__reflect(t.prototype,"game.RoleData")}(game||(game={}));
var game;!function(e){var t=function(){function e(){this.monsterLen=0;var e=this;e.monsterDic={},e.roleDic={},e.bulletDic={},e.monsterIdList=[],e.roleIdList=[],e.bulletIdList=[]}return e}();t.roleStandPoint=[320,210,430,100,540],t.boundary=680,t.borntBossWeight=["","","6000|4000","4000|3000|3000","3000|3000|2000|2000","3000|2000|2000|1500|1500"],e.SceneData=t,__reflect(t.prototype,"game.SceneData")}(game||(game={}));var game;!function(e){var t;!function(e){e[e.hp=1]="hp",e[e.totalHp=2]="totalHp",e[e.speed=3]="speed",e[e.def=4]="def",e[e.magicdefense=5]="magicdefense",e[e.attack=6]="attack",e[e.crit=7]="crit",e[e.critDamage=8]="critDamage",e[e.tenacity=9]="tenacity",e[e.physics_puncture=10]="physics_puncture",e[e.magic_puncture=11]="magic_puncture",e[e.physics_HurtImmune=12]="physics_HurtImmune",e[e.magic_HurtImmune=13]="magic_HurtImmune",e[e.hit=14]="hit",e[e.resistcrit=15]="resistcrit",e[e.resistdamage=16]="resistdamage"}(t=e.Enum_Attr||(e.Enum_Attr={}));var n;!function(e){e[e.job_ZS=1]="job_ZS",e[e.JOB_GJS=2]="JOB_GJS",e[e.JOB_CK=3]="JOB_CK",e[e.JOB_FS=4]="JOB_FS",e[e.JOB_WS=5]="JOB_WS"}(n=e.ENUM_JOB_TYPE||(e.ENUM_JOB_TYPE={}));var a;!function(e){e[e.stand=1]="stand",e[e.run=2]="run",e[e.attack=3]="attack"}(a=e.ENUM_DriverAction||(e.ENUM_DriverAction={}));var r;!function(e){e[e.up=1]="up",e[e.down=5]="down"}(r=e.ENUM_DriverDirection||(e.ENUM_DriverDirection={}));var o;!function(e){e[e.monster=1]="monster",e[e.role=2]="role",e[e.bullet=3]="bullet"}(o=e.ENUM_DriverType||(e.ENUM_DriverType={}));var i;!function(e){e[e.monsterLayer=1]="monsterLayer",e[e.bulletLayer=2]="bulletLayer",e[e.roleLayer=3]="roleLayer"}(i=e.ENUM_DriverRenderLayerId||(e.ENUM_DriverRenderLayerId={}));var l;!function(e){e[e.normal=1]="normal",e[e.elite=2]="elite",e[e.BOSS=3]="BOSS",e[e.minority=4]="minority"}(l=e.ENUM_Monster_type||(e.ENUM_Monster_type={}));var s;!function(e){e[e.HP=1]="HP",e[e.SPEED=2]="SPEED",e[e.CRITIC=3]="CRITIC",e[e.PHYSICS_DEF=4]="PHYSICS_DEF",e[e.MAGIC_DEF=5]="MAGIC_DEF",e[e.ATTACK=6]="ATTACK",e[e.HIT=7]="HIT",e[e.ATTACK_SPEED=8]="ATTACK_SPEED",e[e.PUTON_BULLET_SPEED=9]="PUTON_BULLET_SPEED",e[e.ATTACK_EXPEND_SPEED=10]="ATTACK_EXPEND_SPEED",e[e.SWOON=11]="SWOON",e[e.HP_MAX=12]="HP_MAX",e[e.MAGIC_HURT_IMMUNE=13]="MAGIC_HURT_IMMUNE",e[e.PHYSICS_HURT_IMMUNE=14]="PHYSICS_HURT_IMMUNE",e[e.PHYSICS_PUNCTURE=17]="PHYSICS_PUNCTURE",e[e.MAGIC_PUNCTURE=18]="MAGIC_PUNCTURE"}(s=e.ENUM_BuffEffect||(e.ENUM_BuffEffect={}));var c;!function(e){e[e.create=1]="create",e[e.shooting=2]="shooting",e[e.die=3]="die",e[e.time=4]="time",e[e.max=4]="max"}(c=e.Enum_BuffTrigger||(e.Enum_BuffTrigger={}));var u;!function(e){e[e.mySelf=1]="mySelf",e[e.target=2]="target",e[e.teammate=3]="teammate",e[e.enemys=4]="enemys"}(u=e.Enum_BuffTargetType||(e.Enum_BuffTargetType={}))}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e}();t.JOB_ZS_10001=10001,t.JOB_ZS_10002=10002,t.JOB_ZS_10003=10003,t.JOB_ZS_10004=10004,t.JOB_ZS_10005=10005,t.JOB_ZS_10006=10006,t.JOB_ZS_10007=10007,t.JOB_ZS_10008=10008,t.JOB_ZS_10009=10009,t.JOB_ZS_10010=10010,t.JOB_ZS_10011=10011,t.JOB_GJS_11001=11001,t.JOB_GJS_11002=11002,t.JOB_GJS_11003=11003,t.JOB_GJS_11004=11004,t.JOB_GJS_11005=11005,t.JOB_GJS_11006=11006,t.JOB_GJS_11007=11007,t.JOB_GJS_11008=11008,t.JOB_GJS_11009=11009,t.JOB_GJS_11010=11010,t.JOB_GJS_11011=11011,t.JOB_CK_12001=12001,t.JOB_CK_12002=12002,t.JOB_CK_12003=12003,t.JOB_CK_12004=12004,t.JOB_CK_12005=12005,t.JOB_CK_12006=12006,t.JOB_CK_12007=12007,t.JOB_CK_12008=12008,t.JOB_CK_12009=12009,t.JOB_CK_12010=12010,t.JOB_CK_12011=12011,t.JOB_CK_12012=12012,t.JOB_FS_13001=13001,t.JOB_FS_13002=13002,t.JOB_FS_13003=13003,t.JOB_FS_13004=13004,t.JOB_FS_13005=13005,t.JOB_FS_13006=13006,t.JOB_FS_13007=13007,t.JOB_FS_13008=13008,t.JOB_FS_13009=13009,t.JOB_WS_14001=14001,t.JOB_WS_14002=14002,t.JOB_WS_14003=14003,t.JOB_WS_14004=14004,t.JOB_WS_14005=14005,t.JOB_WS_14006=14006,t.JOB_WS_14007=14007,t.JOB_WS_14008=14008,t.JOB_WS_14009=14009,t.JOB_WS_14010=14010,t.JOB_WS_14011=14011,t.JOB_WS_14012=14012,e.SkillType=t,__reflect(t.prototype,"game.SkillType")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this;e._roundNum=0,e._roundMaxNum=0,e._monsterNumInRound=0,e._monsterMaxNumInRound=0,e._fightBossFailed=!1,e._isFighttingBoss=!1,e._canFightBoss=!1,e.monsterSpeedCut=0,e.monsterNotHit=0,e._maxSkillVmcTimes=2,e._curSkillVmcTimes=0,e._initGap=4e3,e.currentCount=0,e._leaderCanFight=!1;var n=e;n.createClock();var a=DLG.DLGCore.stage;return a.addEventListener(egret.Event.ENTER_FRAME,n.checkFightHandler,n),DLG.KeyBoardManager.getInstance().addListener(n.onFightBoss,n,65),DLG.KeyBoardManager.getInstance().addListener(n.test_bigSkillWuYingJian,n,81),DLG.KeyBoardManager.getInstance().addListener(n.test_wwordRain,n,87),e}return __extends(n,t),n.prototype.test_bigSkillWuYingJian=function(){var t,n=this,a=n.m_sceneMar.getAllRoles();t=a.length;var r=0;for(r;t>r;r++){var o=n.m_sceneMar.getDriverById(a[r],e.ENUM_DriverType.role);if(o){var i=o.getData();if(-1!=i.skills.indexOf(e.SkillType.JOB_ZS_10002))return void n._useSkillAction.useSkill(o,e.SkillType.JOB_ZS_10002)}}},n.prototype.test_wwordRain=function(){var t,n=this,a=n.m_sceneMar.getAllRoles();t=a.length;var r=0;for(r;t>r;r++){var o=n.m_sceneMar.getDriverById(a[r],e.ENUM_DriverType.role);if(o){var i=o.getData();if(-1!=i.skills.indexOf(e.SkillType.JOB_GJS_11002))return void n._useSkillAction.useSkill(o,e.SkillType.JOB_GJS_11002)}}},n.getInstance=function(){var e=this;return e._instance||(e._instance=new n),e._instance},n.prototype.onStop=function(){var t=this;if(t._isStart===!0){t._isStart=!1,t._canFightBoss=!1,t._fightBossFailed=!1,t.m_buffMar.onClearSceneHeroBuff(),t.m_sceneMar.clearDriversByType(e.ENUM_DriverType.bullet),t.m_sceneMar.clearDriversByType(e.ENUM_DriverType.monster);var n=DLG.DLGCore.stage;n.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,t.leaderFightHandler,t),n.removeEventListener(egret.TouchEvent.TOUCH_MOVE,t.leaderFightMoveHandler,t),n.removeEventListener(egret.TouchEvent.TOUCH_END,t.leaderStopFightHandler,t)}},n.prototype.onStart=function(){var t=this;if(t.onStop(),!t._isStart){DLG.DLGCore.panel.close(e.PanelClassConfig.ID_SkillVmcPanel),t._curSkillVmcTimes=0,t._startTime=egret.getTimer(),t._initGap=4e3,t._isStart=!0,t.m_sceneMar=e.SceneManager.getInstance(),t.m_buffMar=e.BuffManager.getInstance(),t._useSkillAction=DLG.FactoryUtils.getClass(e.UseSkillAction),t._damageAction=DLG.FactoryUtils.getClass(e.DamageAction),t.createSceneBuff();var n=e.SceneManager.getInstance(),a=n.getAllRoles(),r=0,o=a.length;for(r=0;o>r;r++){var i=n.getDriverById(a[r],e.ENUM_DriverType.role);if(i){var l=i.getData();t.onInitHeroBuff(l)}}if(t._isFighttingBoss=!1,0==t._fightBossFailed){t.m_sceneMar.getSceneCfg().roundMonsterNum.split("|");t._roundMaxNum=1;var s=e.SceneData.borntBossWeight[t._roundMaxNum];t._bossBornRound=DLG.Utils.probabilityIndex(s)+1}else t._roundMaxNum=0,t._bossBornRound=0;t._roundNum=0,t.nextRound(),t.m_sceneMar.updateWallHp(1e3,1e3);var c=DLG.DLGCore.stage;c.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.leaderFightHandler,t),c.addEventListener(egret.TouchEvent.TOUCH_END,t.leaderStopFightHandler,t),c.addEventListener(egret.TouchEvent.TOUCH_MOVE,t.leaderFightMoveHandler,t)}},n.prototype.onFightBoss=function(){var t=this;0!=t._canFightBoss&&(t.m_sceneMar.clearDriversByType(e.ENUM_DriverType.bullet),t.m_sceneMar.clearDriversByType(e.ENUM_DriverType.monster),t._isFighttingBoss=!0,t._fightBossFailed=!1,t._roundNum=0,t.nextRound())},n.prototype.createSceneBuff=function(){var e=this;e._sceneHeroBuffs=[],e._sceneMonsterBuffs=[],e._sceneHeroBuffsParame=[],e._sceneMonsterBuffsParame=[];var t,n=e.m_sceneMar.getSceneCfg(),a=n.buffIds.split("|"),r=n.buffHold.split("|"),o=n.buf_attack_num.split("|"),i=n.buf_attack_per.split("|");if(t=n.buffNum,t==a.length){var l=0,s=a.length;for(l=0;s>l;l++)"1"==r[l]?(e._sceneHeroBuffs.push(parseInt(a[l])),e._sceneHeroBuffsParame.push([o[l],i[l]])):(e._sceneMonsterBuffs.push(parseInt(a[l])),e._sceneMonsterBuffsParame.push([o[l],i[l]]))}else for(;e._sceneHeroBuffs.length+e._sceneMonsterBuffs.length<t;){var c=DLG.Utils.random(0,a.length-1),u=parseInt(a[c]);parseInt(o[c]),parseInt(i[c]);"1"==r[c]?(e._sceneHeroBuffs.push(u),e._sceneHeroBuffsParame.push([o[c],i[c]])):(e._sceneMonsterBuffs.push(u),e._sceneMonsterBuffsParame.push([o[c],i[c]])),a.splice(c,1),r.splice(c,1),o.splice(c,1),i.splice(c,1)}a.length=0,a=null},n.prototype.checkFightHandler=function(t){var n=this;if(n.m_sceneMar){var a=n.m_clock.getTime();n.currentCount++;var r=n.currentCount;if(n._curSkillVmcTimes<n._maxSkillVmcTimes)if(DLG.DLGCore.panel.getPanelById(e.PanelClassConfig.ID_GuidePanel)||DLG.DLGCore.panel.getPanelById(e.PanelClassConfig.ID_WelcomePanel))n._startTime=egret.getTimer();else{var o=egret.getTimer()-n._startTime,i=n._initGap-1e3*n._curSkillVmcTimes;i=0==n._curSkillVmcTimes?i:i+2500,i=Math.max(i,2500),o>=i&&(n._startTime=egret.getTimer(),n._curSkillVmcTimes+=1,n.createSkillVmc())}var l,s=n.m_sceneMar.getAllMonster(),c=[[],[],[],[],[],[],[],[],[],[]],u=[],p=0;if(n._isStart){l=n.m_sceneMar.getAllMonsterLen(),0==n._fightBossFailed&&0==n._canFightBoss||1==n._canFightBoss&&1==n._isFighttingBoss?(r%20==0&&n.createRoundMonster(),n._monsterNumInRound>=n._monsterMaxNumInRound&&3>=l&&(n._roundMaxNum>n._roundNum?n.nextRound():0==l&&(1==n._isFighttingBoss?(n.onStop(),n.fightBossCallBack&&n.fightBossCallBack.call(n.fightBossCallBackTarget,1),n.m_clock.addTime(3e3,1,n.onStart,n,null)):(n._canFightBoss=!0,n.canFightBossCallBack&&n.canFightBossCallBack.call(n.canFightBossCallBackTarget),n.onStop(),DLG.DLGCore.panel.show(e.PanelClassConfig.ID_ResultPanel),e.MissonIManager.getInstance().updateMissionStatus(e.MainUIManager.getInstance().sceneId))))):3>=l&&n.createRoundMonster();var m=r%25==0;for(p=0;l>p;p++){var _=n.m_sceneMar.getDriverById(s[p],e.ENUM_DriverType.monster);if(_){var d=_.getData();if(void 0==d.isSwoonTime?d.isBoss?d.y<d.targetY&&0==_.isAttack()?(_.run(),_.move()):m&&0==n._useSkillAction.checkSkillIsCD(d.id,d.skills[0])&&_.attack(d.skills[0],0,0,n.monsterNotHit):0==_.isAttack()&&(2==d.distance?m&&n._useSkillAction.checkCanUseSkill(d.id,d.skills[0],e.SceneData.boundary-d.y)?_.attack(d.skills[0],0,0,n.monsterNotHit):d.y<d.targetY&&(_.run(),_.move()):d.y<d.targetY?(_.run(),_.move()):m&&0==n._useSkillAction.checkSkillIsCD(d.id,d.skills[0])&&_.attack(d.skills[0],0,0,n.monsterNotHit)):a-d.isSwoonTime>0&&(d.isSwoonTime=void 0),d.y>0){var h=Math.floor(d.y/100);c[h].push(_)}d.y>80&&u.push(_)}}if(r%10==0){var f=0,g=c.length;for(f=0;g>f;f++)DLG.SortTools.sortMap(c[f],"y",!1);DLG.SortTools.sortMap(u,"y",!1)}var v=n.m_sceneMar.getAllRoles();for(l=v.length,p=0;l>p;p++){var y=n.m_sceneMar.getDriverById(v[p],e.ENUM_DriverType.role);if(y){var L=y.getData();if(!(L.bulletCurrent<=0))if(L.isLeader){if(1==n._leaderCanFight){0==n._useSkillAction.checkSkillIsCD(L.id,L.skills[0])&&y.attack(L.skills[0],n.touchStageX,n.touchStageY);continue}}else if(u.length>0){var C=L.skills[0];if(0==n._useSkillAction.checkSkillIsCD(L.id,C)){var _=n.getMiniNearMonster(u,L);if(_){var d=_.getData();y.attack(C,d.x,d.y)}}}}}}var E=n.m_sceneMar.getAllBullet();p=0,l=E.length;var D=e.GAME_CORE.APP_WIDTH;e:for(p=0;l>p;){var I=n.m_sceneMar.getDriverById(E[p],e.ENUM_DriverType.bullet);if(I){var T=I.getData();if(T.y=Math.floor(T.y),I.move(),T&&(T.y<-10||T.x<0||T.x>D))n.m_sceneMar.removeDriver(I),l=E.length;else{var h=Math.floor(T.y/100);0>h&&(h=0);var b=0;h=h>=c.length?c.length-1:h;var M=c[h].concat();0!=h&&(M=M.concat(c[h-1])),h!=c.length-1&&(M=M.concat(c[h+1]));var g=M.length;t:for(b=0;g>b;b++){var _=M[b];if(null!=_){var d=_.getData();if(d){var k=d.attr.getValue(e.Enum_Attr.hp);if(0>=k){n.m_sceneMar.removeDriver(_);continue t}if(T.isPierce){if(T.hitTargetIds.length>=T.pierceMaxNum)continue t;if(-1!=T.hitTargetIds.indexOf(d.id))continue t}var S=d.byAttackRangeW,B=d.byAttackRangeH,P=d.byAttackRangeY,w=T.moveAttackRange,x=d.y+P;if(x+B+w>T.y&&x-B-w<T.y&&d.x+S>T.x&&d.x-S<T.x){n._damageAction.damageBulletAttack(T,_),T.isPierce?T.hitTargetIds.push(d.id):(n.m_sceneMar.removeDriver(I),l=E.length),d.attr.getValue(e.Enum_Attr.hp)<=0&&n.m_sceneMar.removeDriver(_);continue e}}}}p++}}}c.length=0,c=null,u.length=0,u=null}},n.prototype.getMiniNearMonster=function(e,t){var n,a=620,r=0,o=999999,i=e.length>20?20:e.length;for(r=0;i>r;r++){var l=e[r],s=l.getData();if(s&&t.y-s.y<=a){var c=DLG.Utils.distance(t.x,t.y,s.x,s.y);o>c&&(n=l,o=c)}}return n},n.prototype.nextRound=function(){var e=this;e._roundNum++;var t=e.m_sceneMar.getSceneCfg().roundMonsterNum.split("|");e._monsterMaxNumInRound=parseInt(t[e._roundNum-1]),e._monsterNumInRound=0;var n=e.m_sceneMar.getSceneCfg(),a=n.monster.split("|");if(e._canFightBoss&&e._roundNum==e._bossBornRound){var r=e.bornMonsterData(!0,parseInt(a[a.length-1]));e.m_sceneMar.addDriver(r)}e.createRoundMonster()},n.prototype.createRoundMonster=function(){var e=this,t=0,n=Math.ceil(5*Math.random());if(0==e._fightBossFailed&&0==e._canFightBoss||1==e._canFightBoss&&1==e._isFighttingBoss){var a=e._monsterMaxNumInRound-e._monsterNumInRound;if(n>a&&(n=a),e._monsterNumInRound>=e._monsterMaxNumInRound)return}var r=e.m_sceneMar.getSceneCfg(),o=r.monster.split("|");for(t=0;n>t;t++){var i=e.bornMonsterData(!1,parseInt(o[Math.floor(Math.random()*(o.length-1))]));e.m_sceneMar.addDriver(i)}e._monsterNumInRound+=n,o.length=0,o=null},n.prototype.createSkillVmc=function(){DLG.DLGCore.panel.show(e.PanelClassConfig.ID_SkillVmcPanel)},n.prototype.onInitHeroBuff=function(t){var n=this,a=n._sceneHeroBuffs,r=n._sceneHeroBuffsParame,o=0,i=a.length;for(o=0;i>o;o++)11501==a[o]?t.isLeader?n.m_buffMar.onAddBuffToTargetData(t,e.ENUM_BuffEffect.ATTACK,864e5,0,-2e3):n.m_buffMar.onAddBuffToTargetData(t,e.ENUM_BuffEffect.ATTACK,864e5,0,1e3):11601==a[o]?t.isLeader?n.m_buffMar.onAddBuffToTargetData(t,e.ENUM_BuffEffect.ATTACK,864e5,0,1e3):n.m_buffMar.onAddBuffToTargetData(t,e.ENUM_BuffEffect.ATTACK,864e5,0,-2e3):n.m_buffMar.onAddBuffToTargetData(t,a[o],864e5,parseInt(r[0]),parseInt(r[1]));n.m_buffMar.onActionTargetBuff(t,e.Enum_BuffTrigger.create)},n.prototype.bornMonsterData=function(t,n){var a,r=this,o=e.SceneData.roleStandPoint,i=r.m_sceneMar.createDriverData(e.ENUM_DriverType.monster),l=DLG.Utils.random(-80,80);i.y=0;var s=e.MonsterTable.getCfgById(n);if(i.attr.setValue(e.Enum_Attr.speed,s.speed-r.monsterSpeedCut),i.movieName=s.movieName,i.monsterCfgId=s.id,i.distance=s.distance,t?(Math.random()>.5?i.x=o[1]+l:i.x=o[2]+l,i.isBoss=!0):i.x=o[Math.floor(5*Math.random())]+l,i.attr.setValue(e.Enum_Attr.hp,s.hp),i.attr.setValue(e.Enum_Attr.totalHp,s.hp),i.attr.setValue(e.Enum_Attr.def,s.def),i.attr.setValue(e.Enum_Attr.magicdefense,s.magicdefense),i.attr.setValue(e.Enum_Attr.attack,s.attack),i.attr.setValue(e.Enum_Attr.hit,s.hit),i.attr.setValue(e.Enum_Attr.resistcrit,s.resistcrit),i.attr.setValue(e.Enum_Attr.resistdamage,s.resistdamage),a=s.hitRange.split("|"),i.byAttackRangeW=parseInt(a[0]),i.byAttackRangeH=parseInt(a[1]),i.byAttackRangeY=parseInt(a[2]),i.isBoss){var c=s.monsterskills.split("|"),u=[];u.push(parseInt(c[0])),c.splice(0,1);var p=void 0;for(p=s.skillsnumber;u.length<p;){var m=DLG.Utils.random(0,c.length-1),_=parseInt(c[m]);c.splice(m,1),u.push(_)}c.length=0,c=null,i.skills=u,i.targetY=e.SceneData.boundary+DLG.Utils.random(0,15)}else{i.skills=[parseInt(s.monsterskills)];var d=e.SkillTable.getCfgById(i.skills[0]);2==s.distance?i.targetY=e.SceneData.boundary-DLG.Utils.random(.3*d.distance,.4*d.distance):i.targetY=e.SceneData.boundary+DLG.Utils.random(-15,15)}var h=(r.m_sceneMar.getSceneCfg(),r._sceneMonsterBuffs),f=r._sceneMonsterBuffsParame,g=0,v=h.length;for(g=0;v>g;g++)r.m_buffMar.onAddBuffToTargetData(i,h[g],864e5,parseInt(f[0]),parseInt(f[1]));return r.m_buffMar.onActionTargetBuff(i,e.Enum_BuffTrigger.create),a.length=0,a=null,i},n.prototype.getFightBossFailed=function(){return this._fightBossFailed},n.prototype.leaderStopFightHandler=function(e){var t=this;1==t._leaderCanFight&&DLG.DLGCore.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,t.leaderFightMoveHandler,t),t._leaderCanFight=!1},n.prototype.leaderFightHandler=function(t){var n=this;if(1==n._isStart){var a=n.m_sceneMar.getAllRoles(),r=n.m_sceneMar.getDriverById(a[0],e.ENUM_DriverType.role),o=r.getData(),i=!1;n._leaderCanFight=!0,n.touchStageX=t.stageX,n.touchStageY=t.stageY,n.touchStageY<e.SceneData.boundary&&(n.touchStageY=e.SceneData.boundary-100),0==n._useSkillAction.checkSkillIsCD(o.id,o.skills[0])&&(r.attack(o.skills[0],n.touchStageX,n.touchStageY),i=!0)}},n.prototype.leaderFightMoveHandler=function(e){var t=this;1==t._leaderCanFight&&(t.touchStageX=e.stageX,t.touchStageY=e.stageY)},n}(DLG.BaseAction);e.FightManager=t,__reflect(t.prototype,"game.FightManager")}(game||(game={}));var game;!function(e){var t=function(){function t(){this.init()}return t.getInstance=function(){var e=this;return e._instance||(e._instance=new t),e._instance},t.prototype.init=function(){var e=this;e._loadVoPoolArr=[],e._movieLoadMap={},e._movieDataMap={}},t.prototype.getRes=function(e){var t=this;return t._movieDataMap.hasOwnProperty(e)?t._movieDataMap[e]:null},t.prototype.load=function(t,n,a){var r=this;if(r._movieDataMap.hasOwnProperty(t)){var o=r._movieDataMap[t];return void n.call(a,t,o[0],o[1])}var i;return r._movieLoadMap.hasOwnProperty(t)?(i=r._movieLoadMap[t],void i.addCallBack(n,a)):(i=r._loadVoPoolArr.length>0?r._loadVoPoolArr.pop():new e.MovieLoadVo,i.load(t,n,a),void(r._movieLoadMap[t]=i))},t.prototype.addData=function(e,t,n){var a=this;a._movieDataMap[e]=[t,n]},t.prototype.returnMovieLoadVo=function(e){this._loadVoPoolArr.push(e)},t}();e.MovieLoadManager=t,__reflect(t.prototype,"game.MovieLoadManager")}(game||(game={}));var game;!function(e){var t=function(){function t(){this.count=0,this.init()}return t.getInstance=function(){var e=this;return e._instance||(e._instance=new t),e._instance},t.prototype.init=function(){var e=this;DLG.DLGCore.clock.addTime(150,0,e.renderHandler,e,null)},t.prototype.renderHandler=function(){var t=this,n=e.SceneManager.getInstance(),a=n.getAllMonster(),r=0,o=a.length;for(t.count++,r=0;o>r;r++){var i=n.getDriverById(a[r],e.ENUM_DriverType.monster);if(null!=i){i.getData();a.length>30&&i.y<300?2==t.count&&i.nextFrame():i.nextFrame()}}var l=n.getAllRoles();for(r=0,o=l.length,r=0;o>r;r++){var s=n.getDriverById(l[r],e.ENUM_DriverType.role);if(null==s)break;s.nextFrame()}var c=n.getAllBullet();for(r=0,o=c.length,r=0;o>r;r++){var u=n.getDriverById(l[r],e.ENUM_DriverType.bullet);if(null==u)break;2==t.count&&u.nextFrame()}2==t.count&&(t.count=0)},t}();e.MovieRenderManager=t,__reflect(t.prototype,"game.MovieRenderManager")}(game||(game={}));var game;!function(e){var t=function(){function t(){var t=this;t._sceneDta=new e.SceneData,t._monsterDriverPool=[],t._roleDriverPool=[],t._bulletDriverPool=[],t._skillCdMap={};var n=0,a=50;for(n=0;a>n;n++){var r=new e.MonsterDriver;t._monsterDriverPool.push(r)}for(a=5,n=0;a>n;n++){var r=new e.RoleDriver;t._roleDriverPool.push(r)}for(a=150,n=0;a>n;n++){var r=new e.BulletDriver;t._bulletDriverPool.push(r)}a=150,e.FontBlood._bloodVec=[];var o=e.FontBlood._bloodVec;for(o=[],n=0;a>n;n++){var i=new e.FontBlood;o.push(i)}}return t.getInstance=function(){var e=this;return e._instance||(e._instance=new t),e._instance},t.prototype.initLayer=function(e,t,n){var a=this;a._driverLayer=e,a._effectLayer=n,a._mapLayer=t,a._mapLayer.callBack=a.loadMapCompleteHandler,a._mapLayer.callBackTarget=this},t.prototype.loadMapCompleteHandler=function(){this._configLoadOk=!0,this.sceneReady()},t.prototype.loadIngPanelOk=function(){this._loadPanelShowOk=!0,this.sceneReady()},t.prototype.sceneReady=function(){if(e.LoginManager.getInstance().loadPanelShowOk&&this._configLoadOk&&this._loadPanelShowOk){var t=this;t._mapLayer.x=(e.GAME_CORE.APP_WIDTH-t._mapLayer.width)/2,t._mapLayer.y=e.GAME_CORE.APP_HEIGHT-t._mapLayer.height,e.FightManager.getInstance().onStart()}},t.prototype.getEffectLayer=function(){return this._effectLayer},t.prototype.getAllMonsterLen=function(){var e=this;return e._sceneDta.monsterLen},t.prototype.getAllMonster=function(){var e=this;return e._sceneDta.monsterIdList},t.prototype.getAllRoles=function(){var e=this;return e._sceneDta.roleIdList},t.prototype.getAllBullet=function(){var e=this;return e._sceneDta.bulletIdList},t.prototype.getDriverById=function(t,n){var a=this,r=t+"",o=a._sceneDta;return n!=e.ENUM_DriverType.monster&&void 0!=n||!o.monsterDic.hasOwnProperty(r)?n!=e.ENUM_DriverType.role&&void 0!=n||!o.roleDic.hasOwnProperty(r)?n!=e.ENUM_DriverType.bullet&&void 0!=n||!o.bulletDic.hasOwnProperty(r)?null:o.bulletDic[r]:o.roleDic[r]:o.monsterDic[r]},t.prototype.createDriverData=function(n){var a;if(n==e.ENUM_DriverType.bullet?a=new e.BulletData:n==e.ENUM_DriverType.monster?a=new e.MonsterData:n==e.ENUM_DriverType.role&&(a=new e.RoleData),a.attr=new e.AttrData,a.buffsAttr=new e.AttrData,a.buffs=[[],[],[],[],[]],a.driverType=n,a.id=t.ID,t.ID++,0==a.id)throw new Error("SceneManager_ID值出错");return t.ID==Number.MAX_VALUE&&(t.ID=Number.MIN_VALUE),a},t.prototype.addDriver=function(t){var n=this,a=t.driverType,r=this.getNewDriverByType(a);r.setData(t);var o,i=n._sceneDta;return a==e.ENUM_DriverType.monster?(i.monsterDic[r.getData().id+""]=r,i.monsterLen++,i.monsterIdList.push(r.getData().id),o=e.ENUM_DriverRenderLayerId.monsterLayer):a==e.ENUM_DriverType.role?(i.roleDic[r.getData().id+""]=r,i.roleIdList.push(r.getData().id),o=e.ENUM_DriverRenderLayerId.roleLayer):a==e.ENUM_DriverType.bullet&&(i.bulletDic[r.getData().id+""]=r,i.bulletIdList.push(r.getData().id),o=e.ENUM_DriverRenderLayerId.bulletLayer),n._driverLayer.addDriver(r,o),r},t.prototype.clearDriversByType=function(t){var n,a,r=this;if(t==e.ENUM_DriverType.monster){n=r.getAllMonsterLen();var o=r._sceneDta.monsterIdList.concat();for(a=0;n>a;a++){var i=r.getDriverById(o[a],e.ENUM_DriverType.monster);i&&r.removeDriver(i)}o.length=0,o=null}else if(t==e.ENUM_DriverType.role){var l=r.getAllRoles().concat();for(n=l.length,a=0;n>a;a++){var s=r.getDriverById(l[a],e.ENUM_DriverType.role);s&&r.removeDriver(s)}l.length=0,l=null}else if(t==e.ENUM_DriverType.bullet){var c=r.getAllBullet().concat();for(n=c.length,a=0;n>a;a++){var u=r.getDriverById(c[a],e.ENUM_DriverType.bullet);u&&r.removeDriver(u)}c.length=0,c=null}},t.prototype.addEffect=function(e,t,n,a){var r=this;r._driverLayer.addEffect(e,t,n,a)},t.prototype.updateWallHp=function(e,t){var n,a=this;e/t>.8&&(n=1),a._driverLayer.showWall(n)},t.prototype.removeDriverByData=function(t){var n=this,a=t.driverType,r=n._sceneDta,o=t.id+"";if(a==e.ENUM_DriverType.monster){r.monsterDic[o]=void 0,delete r.monsterDic[o];var i=r.monsterIdList.indexOf(t.id);-1!=i&&(r.monsterIdList.splice(i,1),r.monsterLen--);var l=DLG.FactoryUtils.getClass(e.UseSkillAction);l.clearDriverSkillCD(t.id)}else if(a==e.ENUM_DriverType.role){r.roleDic[o]=void 0,delete r.roleDic[o];var i=r.roleIdList.indexOf(t.id);-1!=i&&r.roleIdList.splice(i,1);var l=DLG.FactoryUtils.getClass(e.UseSkillAction);l.clearDriverSkillCD(t.id)}else if(a==e.ENUM_DriverType.bullet){r.bulletDic[o]=void 0,delete r.bulletDic[o];var i=r.bulletIdList.indexOf(t.id);-1!=i&&r.bulletIdList.splice(i,1)}var s=n.getDriverById(t.id,a);n._driverLayer.removeDriver(s),n.returnDriverByType(s)},t.prototype.removeDriver=function(t){var n=this,a=t.getData(),r=a.driverType,o=n._sceneDta,i=a.id+"";if(r==e.ENUM_DriverType.monster){o.monsterDic[i+""]=void 0,delete o.monsterDic[i+""];var l=o.monsterIdList.indexOf(a.id);-1!=l&&(o.monsterIdList.splice(l,1),o.monsterLen--);var s=DLG.FactoryUtils.getClass(e.UseSkillAction);s.clearDriverSkillCD(a.id)}else if(r==e.ENUM_DriverType.role){o.roleDic[i]=void 0,delete o.roleDic[i];var l=o.roleIdList.indexOf(a.id);-1!=l&&o.roleIdList.splice(l,1);var s=DLG.FactoryUtils.getClass(e.UseSkillAction);s.clearDriverSkillCD(a.id)}else if(r==e.ENUM_DriverType.bullet){o.bulletDic[i]=void 0,delete o.bulletDic[i];var l=o.bulletIdList.indexOf(a.id);-1!=l&&o.bulletIdList.splice(l,1)}n._driverLayer.removeDriver(t),n.returnDriverByType(t)},t.prototype.getNewDriverByType=function(t){var n,a=this;if(t==e.ENUM_DriverType.monster){if(a._monsterDriverPool.length>0)return a._monsterDriverPool.pop();n=new e.MonsterDriver}else if(t==e.ENUM_DriverType.role){if(a._roleDriverPool.length>0)return a._roleDriverPool.pop();n=new e.RoleDriver}else if(t==e.ENUM_DriverType.bullet){if(a._bulletDriverPool.length>0)return a._bulletDriverPool.pop();n=new e.BulletDriver}return n},t.prototype.returnDriverByType=function(e){var t=this;egret.is(e,"MonsterDriver")?t._monsterDriverPool.push(e):egret.is(e,"RoleDriver")?t._roleDriverPool.push(e):egret.is(e,"BulletDriver")&&t._bulletDriverPool.push(e),e.clear(),e.getData().clear(),e.setData(null)},t.prototype.getNearRangeDriverByType=function(t,n,a,r,o){var i,l,s=[],c=this;if(t==e.ENUM_DriverType.monster){i=c.getAllMonsterLen();var u=c._sceneDta.monsterIdList;for(l=0;i>l;l++){var p=c.getDriverById(u[l],e.ENUM_DriverType.monster);p&&(o?p.x>a-n&&p.x<a+n&&p.y>r-o&&p.y<r+o&&s.push(p):(9999==n||DLG.Utils.distance(a,r,p.x,p.y)<=n)&&s.push(p))}}else if(t==e.ENUM_DriverType.role){var m=c.getAllRoles();for(i=m.length,l=0;i>l;l++){var _=c.getDriverById(m[l],e.ENUM_DriverType.role);_&&(o?_.x>a-n&&_.x<a+n&&_.y>r-o&&_.y<r+o&&s.push(_):(9999==n||DLG.Utils.distance(a,r,_.x,_.y)<=n)&&s.push(_))}}else if(t==e.ENUM_DriverType.bullet){var d=c.getAllBullet();for(i=d.length,l=0;i>l;l++){var h=c.getDriverById(d[l],e.ENUM_DriverType.bullet);h&&(o?h.x>a-n&&h.x<a+n&&h.y>r-o&&h.y<r+o&&s.push(h):(9999==n||DLG.Utils.distance(a,r,h.x,h.y)<=n)&&s.push(h))}}return s},t.prototype.changeMap=function(t,n){var a=this;if(a._sceneId!=t){if(DLG.DLGCore.panel.close(e.PanelClassConfig.ID_ResultPanel),a._loadPanelShowOk=!1,a._configLoadOk=!1,n){DLG.DLGCore.panel.show(e.PanelClassConfig.ID_LoadPanel);var r=DLG.DLGCore.panel.getPanelById(e.PanelClassConfig.ID_LoadPanel);r.startLoad(1,a.loadIngPanelOk,a)}else a._loadPanelShowOk=!0;a._sceneId=t,e.MainUIManager.getInstance().sceneId=t,a.loadMap(t)}},t.prototype.loadMap=function(t){var n=this;n._sceneCfg=e.SceneTable.getCfgById(t);var a=n._sceneCfg.mapid+"";return n._mapLayer.getMapName()==a?void n.loadMapCompleteHandler():void n._mapLayer.loadMap(a,t)},t.prototype.addRole=function(t,n){var a=this,r=e.SceneData.roleStandPoint,o=a.createDriverData(e.ENUM_DriverType.role);o.x=r[t],o.y=780,o.index=t,o.attr.clear(),n.attr.clone(o.attr),o.skills=n.skills,a.addDriver(o),e.FightManager.getInstance().onInitHeroBuff(o)},t.prototype.removeRoleByIndex=function(t){var n,a,r=this,o=r.getAllRoles(),i=0,l=o.length;for(i=0;l>i;i++)if(a=r.getDriverById(o[i],e.ENUM_DriverType.role),a&&(n=a.getData(),n.index==t))return void r.removeDriver(a)},t.prototype.removeRoleById=function(t){var n,a=this,r=a.getAllRoles(),o=0,i=r.length;for(o=0;i>o;o++)if(r[o]==t)return n=a.getDriverById(r[o],e.ENUM_DriverType.role),void a.removeDriver(n)},t.prototype.removeRoleByJob=function(t){var n,a,r=this,o=r.getAllRoles(),i=0,l=o.length;for(i=0;l>i;i++)a=r.getDriverById(o[i],e.ENUM_DriverType.role),a&&(n=a.getData(),n.job==t&&r.removeDriver(a))},t.prototype.getRoleById=function(t){var n,a=this,r=a.getAllRoles(),o=0,i=r.length;for(o=0;i>o;o++)if(r[o]==t)return n=a.getDriverById(r[o],e.ENUM_DriverType.role);return null},t.prototype.getRolesByJob=function(t){var n,a,r=[],o=this,i=o.getAllRoles(),l=0,s=i.length;for(l=0;s>l;l++)n=o.getDriverById(i[l],e.ENUM_DriverType.role),n&&(a=n.getData(),a.job==t&&r.push(n));return r},t.prototype.getSceneCfg=function(){return this._sceneCfg},t.prototype.getSkillCdMap=function(){return this._skillCdMap},t.prototype.clear=function(){},t}();t.showRang=!1,t.ID=1,e.SceneManager=t,__reflect(t.prototype,"game.SceneManager")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var n=t.call(this)||this,a=n;return a.touchEnabled=!1,a._direction=e.ENUM_DriverDirection.up,a._bodySkin=new e.MovieSkin(!0),a.addChild(a._bodySkin),n}return __extends(n,t),n.prototype.init=function(){var t=this;t._bodySkin.setDirection(t._direction),t._bodySkin.setMovieName(e.GAME_PATH.MOVIE_BULLET_PATH,t._data.movieName),t.update(),t._bodySkin.setAction(0),t._bodySkin.loadMovie()},n.prototype.update=function(){var e=this,t=e._data;t&&(e.x!=t.x&&(e.x=t.x),e.y!=t.y&&(e.y=t.y),e.rotation!=t.rotation&&(e.rotation=t.rotation))},n.prototype.nextFrame=function(){var e=this;e._bodySkin.nextFrame()},n.prototype.move=function(){var t=this,n=t._data,a=n.attr.getValue(e.Enum_Attr.speed);if(t._direction==e.ENUM_DriverDirection.up)if(n.rotation){var r=Math.sin(n.rotation*Math.PI/180)*a,o=Math.cos(n.rotation*Math.PI/180)*a;n.x+=r,n.y-=o,t.y=n.y,t.x=n.x}else n.y-=a,t.y=n.y;n.rotateMove&&(t.rotation+=30)},n.prototype.setData=function(e){var t=this;t._data?(t._data=e,t.update()):(t._data=e,t.init())},n.prototype.getData=function(){return this._data},n.prototype.stand=function(){},n.prototype.attack=function(){},n.prototype.isAttack=function(){return!1},n.prototype.run=function(){},n.prototype.clear=function(){var e=this;e.rotation=0},n}(egret.Sprite);e.BulletDriver=t,__reflect(t.prototype,"game.BulletDriver",["game.IDriver"])}(game||(game={}));var DLG;!function(e){var t=function(){function e(){}return e.prototype.setData=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var a=this;a.data_dic={},a.data_dic.id={},a.data_vec=[];var r,o,i=[],l=0,s=i.length;r=e.length;var c=e[1];for(l=2;r>l;l++){var u={},p=e[l],m=0,_=c.length;for(m=0;_>m;m++)u[c[m]]=p[m];for(a.data_dic.id[u.id]=u,o=0;s>o;o++){var d=i[o],h=d.split("|"),f=void 0,g=void 0;for(g=0;g<h.length;g++)f+=u[h[g]]+"";0==f[0]?a.data_dic[d][f]=u:(void 0==a.data_dic[d][f]&&(a.data_dic[d][f]=[]),a.data_dic[d][f].push(u))}a.data_vec.push(u)}},e.prototype.getObjById=function(e){var t=this,n=t.data_dic.id;return n.hasOwnProperty(e+"")?n[e+""]:null},e.prototype.getDatavec=function(){return this.data_vec},e.prototype.getData=function(){var e=this;return e.data_dic.id},e.prototype.getVecByAny=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=null;return n},e.prototype.getObjByAny=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=null;return n},e}();e.Table=t,__reflect(t.prototype,"DLG.Table")}(DLG||(DLG={}));var game;!function(e){var t=function(t){function n(){var n=t.call(this)||this,a=n;return a._direction=e.ENUM_DriverDirection.up,n}return __extends(n,t),n.prototype.init=function(){var t=this;t._bodySkin.setDirection(t._direction),t._bodySkin.setMovieName(e.GAME_PATH.MOVIE_PLAYER_PATH,t._data.movieName),t._bodySkin.setAction(e.ENUM_DriverAction.stand),t._bodySkin.loadMovie(),t.update(),t.stand()},n.prototype.attack=function(n,a,r,o){var i=this;t.prototype.attack.call(this,n,a,r);var l=i._data;l.driverType==e.ENUM_DriverType.role&&(l.attackPx=a,l.attackPy=r);var s=DLG.FactoryUtils.getClass(e.UseSkillAction);s.useSkill(i,n)},n.prototype.onPlayFrameCallBack=function(t,n){var a=this;if(a._actionState==e.ENUM_DriverAction.attack&&t==n&&a.stand(),t==n){var r=a._data,o=r.skills,i=(o.length,DLG.FactoryUtils.getClass(e.UseSkillAction));r.job==e.ENUM_JOB_TYPE.JOB_GJS&&-1!=o.indexOf(e.SkillType.JOB_GJS_11009)&&0==i.checkSkillIsCD(r.id,e.SkillType.JOB_GJS_11009)&&(i.setSkillCdTime(r.id,e.SkillType.JOB_GJS_11009),r.infiniteArrowTimes=10)}},n.prototype.nextFrame=function(){var e=this;e._bodySkin.nextFrame()},n}(e.MonsterDriver);e.RoleDriver=t,__reflect(t.prototype,"game.RoleDriver")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this;e._wallLoadState=0,e._wallIsReLoad=!1;var n=e;return n.effectDownLayer=new egret.Sprite,n.addChild(n.effectDownLayer),n.monsterLayer=new egret.Sprite,n.addChild(n.monsterLayer),n.bulletLayer=new egret.Sprite,n.addChild(n.bulletLayer),n._wallBmp=new egret.Bitmap,n.addChild(n._wallBmp),n.roleLayer=new egret.Sprite,n.addChild(n.roleLayer),n.effectUpLayer=new egret.Sprite,n.addChild(n.effectUpLayer),e}return __extends(n,t),n.prototype.addDriver=function(t,n){var a=this;this.addChild(t),n==e.ENUM_DriverRenderLayerId.monsterLayer?a.monsterLayer.addChild(t):n==e.ENUM_DriverRenderLayerId.bulletLayer?a.bulletLayer.addChild(t):n==e.ENUM_DriverRenderLayerId.roleLayer&&a.roleLayer.addChild(t)
},n.prototype.addEffect=function(t,n,a,r){var o,i=this,l=e.EffectTable.getCfgById(t),s=l.movie;o=e.EffectMovie.createEffectMovie(s),1==l.layer?i.effectDownLayer.addChild(o):i.effectUpLayer.addChild(o),o.play(n),o.x=a,o.y=r},n.prototype.removeDriver=function(e){e.parent&&e.parent.removeChild(e)},n.prototype.showWall=function(t){var n=this;if(n._wallId!=t){n._wallLoader||(n._wallLoader=new egret.URLLoader,n._wallLoader.dataFormat=egret.URLLoaderDataFormat.TEXTURE),1==n._wallLoadState&&(n._wallLoader.removeEventListener(egret.Event.COMPLETE,this.onLoadComplete,this),n._wallLoader.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadError,this)),n._wallBmp&&n._wallBmp.texture&&(n._wallBmp.texture.dispose(),n._wallBmp.texture=null);var a=new egret.URLRequest(e.GAME_PATH.WALL_PATH+"wall_"+t+e.GAME_PATH.TYPE_PNG);n._wallLoader.addEventListener(egret.Event.COMPLETE,this.onLoadComplete,this),n._wallLoader.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadError,this),n._wallLoader.load(a)}},n.prototype.onLoadComplete=function(t){var n=this;n._wallLoadState=2,n._wallLoader.removeEventListener(egret.Event.COMPLETE,this.onLoadComplete,this),n._wallLoader.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadError,this);var a=t.target,r=a.data;n._wallBmp.texture=r,n._wallBmp.x=e.GAME_CORE.APP_WIDTH-r._bitmapWidth>>1,n._wallBmp.y=660},n.prototype.onLoadError=function(){var t=this;if(0==t._wallIsReLoad){t._wallIsReLoad=!0;var n=new egret.URLRequest(e.GAME_PATH.WALL_PATH+"wall_"+t._wallId+e.GAME_PATH.TYPE_JPG);t._wallLoader.load(n)}else sayError("城墙加载失败：",t._wallId)},n}(egret.Sprite);e.DriverRenderLayer=t,__reflect(t.prototype,"game.DriverRenderLayer")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var e=t.call(this)||this;e._loadState=0,e._isReLoad=!1;var n=e;return n._mapLoader||(n._mapLoader=new egret.URLLoader,n._mapLoader.dataFormat=egret.URLLoaderDataFormat.TEXTURE),n._mapBmp=new egret.Bitmap,n._mapBmp.x=0,n._mapBmp.y=320,n.addChild(n._mapBmp),e}return __extends(n,t),n.prototype.loadMap=function(t,n){var a=this;if(a._mapname!=t){1==a._loadState&&(a._mapLoader.removeEventListener(egret.Event.COMPLETE,this.onLoadComplete,this),a._mapLoader.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadError,this)),a._mapBmp&&a._mapBmp.texture&&(a._mapBmp.texture.dispose(),a._mapBmp.texture=null),a._sceneId=n,a._mapname=t,a._isReLoad=!1;var r=new egret.URLRequest(e.GAME_PATH.MAP_PATH+t+e.GAME_PATH.TYPE_JPG);a._mapLoader.addEventListener(egret.Event.COMPLETE,this.onLoadComplete,this),a._mapLoader.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadError,this),a._mapLoader.load(r)}},n.prototype.onLoadComplete=function(e){var t=this;t._loadState=2,t._mapLoader.removeEventListener(egret.Event.COMPLETE,this.onLoadComplete,this),t._mapLoader.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadError,this);var n=e.target,a=n.data;t._mapBmp.texture=a,t.callBack&&t.callBack.call(t.callBackTarget)},n.prototype.onLoadError=function(){var t=this;if(0==t._isReLoad){t._isReLoad=!0;var n=new egret.URLRequest(e.GAME_PATH.MAP_PATH+t._mapname+e.GAME_PATH.TYPE_JPG);t._mapLoader.load(n)}else sayError("地图加载失败：",t._mapname)},n.prototype.getMapName=function(){return this._mapname},n}(egret.DisplayObjectContainer);e.SceneMapLayer=t,__reflect(t.prototype,"game.SceneMapLayer")}(game||(game={}));var game;!function(e){var t=function(t){function n(){return t.call(this,!0)||this}return __extends(n,t),n.prototype.getTotalPlayTimes=function(){return this._totalPlayTimes},n.prototype.play=function(e){var t=this;t._totalPlayTimes!=e&&(t._currentTimes=0,t._totalPlayTimes=e,t._playEndTime=void 0,t._timeId&&(DLG.DLGCore.clock.removeTime(t._timeId,!1),t._timeId=void 0),t.loadMovie(),t._timeId=DLG.DLGCore.clock.addTime(n.EffectNextFrameTimes,0,t.nextFrame,t,null))},n.prototype.playByTime=function(e){var t=this;t._totalPlayTimes=0,t._currentTimes=void 0,t._playEndTime=DLG.DLGCore.clock.getTime()+e,t._timeId&&(DLG.DLGCore.clock.removeTime(t._timeId,!1),t._timeId=void 0),t._timeId=DLG.DLGCore.clock.addTime(n.EffectNextFrameTimes,0,t.nextFrame,t,null)},n.prototype.nextFrame=function(){var e=this;return t.prototype.nextFrame.call(this),e._playEndTime?void(DLG.DLGCore.clock.getTime()-e._playEndTime>0&&(e.removeEffect(),e.destroy(),e.onPlayEndCallBack&&e.onPlayEndCallBack.call(e.onPlayEndTaget))):void(e._loadEnd&&e._playFrame==e._totalFrame-1&&e._totalPlayTimes>0&&(e._currentTimes++,e._currentTimes==e._totalPlayTimes&&(e.removeEffect(),e.destroy(),e.onPlayEndCallBack&&e.onPlayEndCallBack.call(e.onPlayEndTaget))))},n.prototype.removeEffect=function(){var e=this;e.parent&&e.parent.removeChild(e),n.returnEffectMovie(e)},n.prototype.reset=function(){var e=this;e.clear(),e._playFrame=-1,e.goToAndStop(0)},n.prototype.clear=function(){var e=this;e._timeId&&(DLG.DLGCore.clock.removeTime(e._timeId,!1),e._timeId=void 0),e._totalPlayTimes=void 0,e._currentTimes=void 0,e._playEndTime=void 0,e.onPlayEndCallBack=void 0,e.onPlayEndTaget=void 0,e.x=0,e.y=0},n.prototype.destroy=function(){this.clear(),t.prototype.destroy.call(this)},n.createEffectMovie=function(t){var a;return a=n._effectPool.length>0?n._effectPool.shift():new n,a.setAction(0),a.setDirection(e.ENUM_DriverDirection.up),a.setMovieName(e.GAME_PATH.MOVIE_EFFECT_PATH,t),a},n.returnEffectMovie=function(e){e.destroy(),n._effectPool.push(e)},n}(e.MovieSkin);t.EffectNextFrameTimes=150,t._effectPool=[],e.EffectMovie=t,__reflect(t.prototype,"game.EffectMovie")}(game||(game={}));var game;!function(e){var t=function(){function t(){var e=this;e._josnLoader=new egret.URLLoader,e._josnLoader.dataFormat=egret.URLLoaderDataFormat.TEXT}return t.prototype.load=function(t,n,a){var r=this;r._loadCallBack=[],r._loadCallBackTarget=[],r._url=t,r._loadCallBack.push(n),r._loadCallBackTarget.push(a),r._urlRequest?r._urlRequest.url=t+e.GAME_PATH.TYPE_JSON:r._urlRequest=new egret.URLRequest(t+e.GAME_PATH.TYPE_JSON),r._jsonReLoad=!1,r._imageReLoad=!1,r._josnLoader.addEventListener(egret.Event.COMPLETE,r.onLoadJsonComplete,r),r._josnLoader.addEventListener(egret.IOErrorEvent.IO_ERROR,r.onLoadJsonError,r),r._josnLoader.load(r._urlRequest)},t.prototype.addCallBack=function(e,t){var n=this;n._loadCallBack.push(e),n._loadCallBackTarget.push(t)},t.prototype.onLoadJsonComplete=function(e){var t=this;t._josnLoader.removeEventListener(egret.Event.COMPLETE,t.onLoadJsonComplete,t),t._josnLoader.removeEventListener(egret.IOErrorEvent.IO_ERROR,t.onLoadJsonError,t);var n=e.target;t._jsonObj=JSON.parse(n.data),this.loadTexture()},t.prototype.onLoadJsonError=function(){var t=this;1==t._jsonReLoad?(t._josnLoader.removeEventListener(egret.Event.COMPLETE,t.onLoadJsonComplete,t),t._josnLoader.removeEventListener(egret.IOErrorEvent.IO_ERROR,t.onLoadJsonError,t),e.MovieLoadManager.getInstance().returnMovieLoadVo(t),t._loadCallBack=null,t._loadCallBackTarget=null,sayError("加载资源出错",t._url)):(t._jsonReLoad=!0,t._josnLoader.load(t._urlRequest))},t.prototype.loadTexture=function(){var t=this;t._imageLoader||(t._imageLoader=new egret.ImageLoader,t._imageLoader.addEventListener(egret.Event.COMPLETE,t.onLoadTextureComplete,t),t._imageLoader.addEventListener(egret.IOErrorEvent.IO_ERROR,t.onLoadTextureError,t)),t._imageLoader.load(t._url+e.GAME_PATH.TYPE_PNG)},t.prototype.onLoadTextureComplete=function(t){var n=this;n._imageLoader.removeEventListener(egret.Event.COMPLETE,n.onLoadTextureComplete,n),n._imageLoader.removeEventListener(egret.IOErrorEvent.IO_ERROR,n.onLoadTextureError,n),n._imageLoader=void 0;var a=t.target,r=a.data;e.MovieLoadManager.getInstance().addData(n._url,n._jsonObj,r);var o=0,i=n._loadCallBack.length;for(o=0;i>o;o++)n._loadCallBack[o].call(n._loadCallBackTarget[o],n._url,n._jsonObj,r);e.MovieLoadManager.getInstance().returnMovieLoadVo(n),n._loadCallBack=null,n._loadCallBackTarget=null},t.prototype.onLoadTextureError=function(){var t=this;1==t._imageReLoad?(t._imageLoader.removeEventListener(egret.Event.COMPLETE,t.onLoadTextureComplete,t),t._imageLoader.removeEventListener(egret.IOErrorEvent.IO_ERROR,t.onLoadTextureError,t),t._imageLoader=void 0,e.MovieLoadManager.getInstance().returnMovieLoadVo(t),t._loadCallBack=null,t._loadCallBackTarget=null,sayError("加载资源出错",t._url)):(t._imageReLoad=!0,t._imageLoader.load(t._url))},t}();e.MovieLoadVo=t,__reflect(t.prototype,"game.MovieLoadVo")}(game||(game={}));var DLG;!function(e){var t=function(){function e(){}return e.prototype.clear=function(){var e=this;e.id=void 0,e.doTimes=void 0,e.time=void 0,e.callBack=void 0,e.callBackObj=void 0,e.callBackParame=void 0,e.nextTime=void 0,e.endTime=void 0,e.fillFrame=void 0,e.isApply=void 0},e}();t.ID=1,e.ClockData=t,__reflect(t.prototype,"DLG.ClockData");var n=function(n){function a(){var t=n.call(this)||this,a=t,r=new Date;return a.setCurrentTime(r.getTime()),r=null,a.clockVec=[],a.clockFillFrameVec=[],a.clockDataPoolVec=[],e.DLGCore.event.addEventListener(e.DLGCore.stage,egret.Event.ENTER_FRAME,a,a.timeHandler,!1),t}return __extends(a,n),a.prototype.timeHandler=function(e){var t=this;if(t._currentTime){var n=egret.getTimer(),a=t._currentTime+n-t._startTime;t._realTime=a;var r,o=0,i=t.clockVec,l=i.length;for(o=0;l>o&&(r=i[o],r);o++)if(!(r.nextTime>a))if(-1==r.endTime){r.nextTime;r.nextTime=a+r.time,r.isApply?r.callBack.apply(r.callBackObj,r.callBackParame):r.callBack.call(r.callBackObj,r.callBackParame)}else if(a>=r.endTime&&r.doTimes>0&&(r.nextTime=a+r.time,r.doTimes--,r.isApply?r.callBack.apply(r.callBackObj,r.callBackParame):r.callBack.call(r.callBackObj,r.callBackParame),r.doTimes<=0)){i.splice(o,1),r.clear(),t.clockDataPoolVec.push(r);break}for(i=t.clockFillFrameVec,l=i.length,o=0;l>o&&(r=i[o],r);o++)if(a>=r.nextTime&&a<=r.endTime){if(r.doTimes>0){var s=Math.floor(a-r.doTimes);for(r.doTimes-=s,r.nextTime=a+r.time;s>0;)r.isApply?r.callBack.apply(r.callBackObj,r.callBackParame):r.callBack.call(r.callBackObj,r.callBackParame),s--;if(r.doTimes<=0){i.splice(o,1),r.clear(),t.clockDataPoolVec.push(r);break}}}else if(a>=r.nextTime&&-1==r.endTime&&-1==r.endTime){var s=Math.floor(a-r.doTimes);for(r.nextTime=a+r.time;s>0;)r.isApply?r.callBack.apply(r.callBackObj,r.callBackParame):r.callBack.call(r.callBackObj,r.callBackParame),s--}}},a.prototype.addTime=function(e,n,a,r,o,i,l){var s=this;if(!s._currentTime)throw new Error("clock里的currentTime还没有设置");var c;if(c=s.clockDataPoolVec.length>0?s.clockDataPoolVec.shift():new t,c.id=t.ID,0==c.id)throw new Error("clockdata_idID值出错");return t.ID++,t.ID>=Number.MAX_VALUE&&(t.ID=Number.MIN_VALUE),c.time=e,c.doTimes=n,c.callBack=a,c.callBackObj=r,c.callBackParame=o,c.isApply=i,c.nextTime=s.getTime()+c.time,0!=c.doTimes?c.endTime=s.getTime()+c.time*c.doTimes:c.endTime=-1,c.fillFrame=l?l:!1,0==c.fillFrame?s.clockVec.push(c):s.clockFillFrameVec.push(c),c.id},a.prototype.removeTime=function(e,t){var n=this;if(!n._currentTime)throw new Error("clock里的currentTime还没有设置");if(0==t||void 0==t){var a=n.clockVec,r=0,o=a.length;for(r=0;o>r;r++){var i=void 0;if(i=a[r],i.id==e)return a.splice(r,1),i.clear(),void n.clockDataPoolVec.push(i)}}if(1==t||void 0==t){var a=n.clockFillFrameVec,r=0,o=a.length;for(r=0;o>r;r++){var i=void 0;if(i=a[r],i.id==e)return a.splice(r,1),i.clear(),void n.clockDataPoolVec.push(i)}}},a.prototype.setCurrentTime=function(e){var t=this;t._currentTime=e,t._startTime=egret.getTimer(),t._realTime=t._currentTime},a.prototype.getTime=function(){return this._realTime},a}(egret.EventDispatcher);e.ClockManager=n,__reflect(n.prototype,"DLG.ClockManager")}(DLG||(DLG={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this,n=t,a=new eui.HorizontalLayout;return a.horizontalAlign=egret.HorizontalAlign.CENTER,a.gap=0,n.layout=a,n.anchorOffsetX=.5,n.anchorOffsetY=.5,n.scaleX=.6,n.scaleY=.6,t}return __extends(t,e),t.createFontBlood=function(){var e=this;return e._bloodVec.length>0?e._bloodVec.shift():new t},t.prototype.setNum=function(e){var t=this;1!=t.visible&&(t.visible=!0),t._soureUrl="Font_Num_json.Font_Num_Cut_Blood_",t._num=Math.floor(e),t.renderDraw()},t.prototype.renderDraw=function(){var e=this;if(e._soureUrl){var t=e._num+"",n=t.length,a=void 0,r=e.numChildren,o=0;for(o;n>o;o++){a=r>o?e.getChildAt(o):DLG.FactoryUtils.onCreateComp(DLG.CImage);var i=e._soureUrl+t.slice(o,o+1)+"_png";a.source=i,a.parent||e.addChild(a)}for(;e.numChildren>n;)a=e.getChildAt(o),a.onDestroy(),a.removeFromParent()}egret.callLater(e.doAnimation,e)},t.prototype.doAnimation=function(){var e=this;e.validateNow();var t=20,n=40;Math.random()>.5?(t=e.x-t,n=e.x-n):(t=e.x+t,n=e.x+n);var a=e.y;egret.Tween.get(e).to({x:t,y:a-50},200).to({x:n,y:a+40*Math.random()},200).wait(500).to({alpha:0},300).call(e.onDestroy,e)},t.prototype.onDestroy=function(){var e=this;e._soureUrl=void 0,e._num=void 0,egret.Tween.removeTweens(e),e.alpha=1,e.visible=!1,e.y=-500,t._bloodVec.push(e)},t}(DLG.CGroup);e.FontBlood=t,__reflect(t.prototype,"game.FontBlood")}(game||(game={}));var game;!function(e){var t=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.showStyle=function(e){void 0===e&&(e=1);var t=this;1==e&&(t._barBg=new egret.Bitmap(RES.getRes("Main_json.Main_HP_Bg_png")),t._bar=new egret.Bitmap(RES.getRes("Main_json.Main_HP_Red_png")),t.addChild(t._barBg),t.addChild(t._bar),t._barBg.x=-t._barBg.width/2,t._bar.x=t._barBg.x+1,t._barWidth=t._barBg.width-2)},t.prototype.setValue=function(e,t){var n=this;n._bar.width=Math.floor(e/t*n._barWidth)},t}(egret.Sprite);e.HpBar=t,__reflect(t.prototype,"game.HpBar")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var n=t.call(this)||this,a=n;return a._map=new e.SceneMapLayer,a.addChild(a._map),a._driverLayer=new e.DriverRenderLayer,a.addChild(a._driverLayer),a._effectLayer=new egret.Sprite,a.addChild(a._effectLayer),e.SceneManager.getInstance().initLayer(a._driverLayer,a._map,a._effectLayer),e.MovieRenderManager.getInstance(),ApplicationManager.topStage.addChildAt(a,0),n}return __extends(n,t),n}(egret.Sprite);e.SceneWindow=t,__reflect(t.prototype,"game.SceneWindow")}(game||(game={}));var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.setProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var Main=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isThemeLoadEnd=!1,t.isResourceLoadEnd=!1,t.isPreLoadEnd=!1,t.isShowFps=!1,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this);var t=this,n=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",n),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.setMaxLoadingThread(5),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/");var a=new eui.Theme("resource/default.thm.json",this.stage);a.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,t.onPreLoadComplete,t),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,t.onPreLoadError,t),RES.loadGroup("preload"),this.stage.addEventListener(egret.Event.RESIZE,this.onResizeHandler,this)},t.prototype.onResizeHandler=function(){var e,t=ApplicationManager.CONTENT_W,n=ApplicationManager.CONTENT_H,a=document.documentElement.clientWidth,r=document.documentElement.clientHeight,o=n/t,i=r/a;e=i>=o?a/t:r/n,ApplicationManager.globalScale=e,ApplicationManager.topStage&&(ApplicationManager.topStage.scaleX=ApplicationManager.topStage.scaleY=e,ApplicationManager.topStage.x=(a-t*e)/2,ApplicationManager.topStage.y=(r-n*e)/2)},t.prototype.onPreLoadComplete=function(e){var t=this;"preload"==e.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,t.onPreLoadComplete,t),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,t.onPreLoadError,t),t.isPreLoadEnd=!0,t.startCreateScene())},t.prototype.onPreLoadError=function(e){sayError("Group:"+e.groupName+" has failed to load")},t.prototype.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=this;t.isResourceLoadEnd=!0,t.startCreateScene()},t.prototype.onThemeLoadComplete=function(){var e=this;e.isThemeLoadEnd=!0,e.startCreateScene()},t.prototype.analysis=function(){},t.prototype.startCreateScene=function(){var e=this;if(0!=e.isThemeLoadEnd&&0!=e.isResourceLoadEnd&&0!=e.isPreLoadEnd){this.stage.dirtyRegionPolicy=egret.DirtyRegionPolicy.OFF,e.analysis(),DLG.DLGCore.init(e.stage);var t=new game.GameMain;ApplicationManager.topStage=new egret.Sprite,e.addChild(ApplicationManager.topStage),ApplicationManager.topStage.addChild(t),e.onResizeHandler();var n=DLG.FactoryUtils.getClass(game.ConnectAction);n.onExecute(!1)}},t.prototype.showAndHideFps=function(){var e=this;e.lastClickTime&&egret.getTimer()-e.lastClickTime<300&&(e.isShowFps=!e.isShowFps,showfps(this.isShowFps)),e.lastClickTime=egret.getTimer()},t}(eui.UILayer);__reflect(Main.prototype,"Main");var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,n,a){function r(e){t.call(a,e)}function o(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),n.call(a))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(e,r,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);