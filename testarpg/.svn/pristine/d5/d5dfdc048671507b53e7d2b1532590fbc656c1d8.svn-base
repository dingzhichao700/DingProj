module egret{
    /**
     * 射手
     */
    export class PlayerBowman extends ElementPlayer{
        public constructor(){
            super();
        }
        //
        /**
         * 获取攻击范围，不同职业和怪物重写
         * @returns {number}
         */
        public getAttackRange():number{
            return 300;
        }
        //
        /**
         * 释放技能
         */
        public playSkill():void {
            if (!this.scene) return;

            //职业及技能类型处理
            var playerVo:ScenePlayerVo = <ScenePlayerVo>this.data.vo;

            if(this._avatar.frameIndex == 2){
                var mageSkill:ElementMageNormalSkill = <ElementMageNormalSkill>SceneElementManager.getInstance().getElement(ElementMageNormalSkill);
                mageSkill.setMovieName(SceneElementData.getInstance().getSkillMovieName(playerVo.vocation,1));
                this.scene.addElement(mageSkill,SceneLayerType.BATTLE_EFFECT);
                mageSkill.attackTo(this.x,this.y - 50,this._attackTarget,0,-50,90);

                if(this._attackTarget){
                    var radians:Array<number> = [Math.atan2(this._attackTarget.vo.y - this.y,this._attackTarget.vo.x - this.x)];
                    var damage:any = dataManager().fightData.damage(SkillType.BOWMAN_NORMAL,[this._attackTarget]);

                    globalUpdateWindows([UpdateType.DAMAGE_HP_CHANGE],[this._attackTarget],damage.hpValues,radians);
                }
            }else if(this._avatar.frameIndex == this._avatar.frameIndexMax){
                this.checkAutoAttack2();
            }
        }
    }
}