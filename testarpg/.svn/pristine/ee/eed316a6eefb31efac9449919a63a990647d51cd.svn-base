module egret{
    /**
     * 飘血动画管理
     */
    export class HPTweenManager{
        private static _instance:HPTweenManager;
        //文本缓存
        private _textFields:Array<TextField>;

        public constructor(){
            this._textFields = [];
        }
        //
        public static getInstance():egret.HPTweenManager {
            return this._instance || (this._instance = new egret.HPTweenManager());
        }
        //
        /**
         * 飘血动画
         * @param container 文本容器
         * @param x 文本x
         * @param y 文本y
         * @param radian 飘出弧度
         * @param radius 飘出半径
         * @param text 伤害文本值
         * @param color 文本颜色
         * @param size 文本大小
         */
        public tween(container:DisplayObjectContainer,x:number,y:number,radian:number,radius:number,
                              text:string,color:number = 0xffff00,size:number = 20):void{

            var textField:TextField = this._textFields.pop();
            if(!textField)
                textField = new TextField();
            textField.text = text;
            textField.height = size;
            textField.width = 100;
            textField.textAlign = HorizontalAlign.CENTER;
            textField.textColor = color;
            textField.x = x - textField.width / 2;
            textField.y = y;
            container.addChild(textField);

            var tx:number  = Math.cos(radian) * radius + x;
            var ty:number  = Math.sin(radian) * radius + y;

            Tween.removeTweens(textField);

            Tween.get(textField).to({x:tx,y:ty},1000,egret.Ease.circInOut).call(this.randomDirComplete,this,[textField]);
        }
        //
        /**
         * 飘血动画结束，回收文本对象
         * @param textField
         */
        private randomDirComplete(textField:TextField):void{
            if(textField.parent)
                textField.parent.removeChild(textField);

            this._textFields.push(textField);
        }
    }
}