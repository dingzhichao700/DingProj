/*!
 * MCAFEE RESTRICTED CONFIDENTIAL
 * Copyright (c) 2018 McAfee, LLC
 * 
 * The source code contained or described herein and all documents related
 * to the source code ("Material") are owned by McAfee or its
 * suppliers or licensors. Title to the Material remains with McAfee
 * or its suppliers and licensors. The Material contains trade
 * secrets and proprietary and confidential information of McAfee or its
 * suppliers and licensors. The Material is protected by worldwide copyright
 * and trade secret laws and treaty provisions. No part of the Material may
 * be used, copied, reproduced, modified, published, uploaded, posted,
 * transmitted, distributed, or disclosed in any way without McAfee's prior
 * express written permission.
 * 
 * No license under any patent, copyright, trade secret or other intellectual
 * property right is granted to or conferred upon you by disclosure or
 * delivery of the Materials, either expressly, by implication, inducement,
 * estoppel or otherwise. Any license under such intellectual property rights
 * must be expressed and approved by McAfee in writing.
 * 
 * 
 */!function(e){var t={};function s(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(i,n,function(t){return e[t]}.bind(null,n));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=32)}([function(e,t,s){"use strict";s.d(t,"a",function(){return a});var i=s(19),n=s(6);const a={uid:"{0DE9E47C-871A-4F90-8440-B190C216800A}",resourceReq:null,gtiRequestor:null,resourceRootURI:null,annotationProperties:null,balloonProperties:null,reputationReqCount:5,annotationEvents:null,activeBalloonElement:null,debugMode:!1,logger:new i.a(n.a.loglevel),activeURI:null,mapSelectors:new Map,cacheStats:{},imageCounter:0,eventHandler:null,debugTitle:"",onlyShowMcAfeeSecure:!1,bkGlobals:null,isSearchPage:!1}},function(e,t,s){"use strict";s.d(t,"a",function(){return i});const i=chrome},,function(e,t,s){"use strict";var i=s(16),n=s(17),a=s(7);var o=s(20);s.d(t,"a",function(){return r});const r={messageDispatcher:null,useNativeLogger:!1,logger:null,cache:new i.b,options:new Map,blockPageMap:new Map,annotationOption:n.a.All,lastUrl:null,featureStats:new class{constructor(){this.Type=Object.freeze({PagesScanned:0,PagesBlocked:1,ItemsBlocked:2}),this.data={pagesScanned:0,pagesBlocked:0,itemsBlocked:0},this.read()}add(e){switch(e){case this.Type.PagesScanned:this.data.pagesScanned++;break;case this.Type.PagesBlocked:this.data.pagesBlocked++;break;case this.Type.ItemsBlocked:this.data.itemsBlocked++}this.save()}read(){a.a.get(a.b.POPUP_STATS,e=>{void 0!==e&&(this.data.pagesScanned=e.pagesScanned,this.data.pagesBlocked=e.pagesBlocked,this.data.itemsBlocked=e.itemsBlocked)})}save(){a.a.set(a.b.POPUP_STATS,this.data)}getData(){return this.data}},secureSearchProvider:-1,webadvisorSupportedFeatures:null,origUrlMap:new Map,ffViewports:null,tabIdToColourMap:new Map,externalExtns:new o.a,autoPlayNotificationRequired:!1,cryptojackingDisabled:!0,tabIdToLastClickTime:new Map,affid:"0",binaryVersion:"0.0.0.0",TabData:new Map,MsgQueue:new Map}},function(e,t,s){"use strict";s.d(t,"a",function(){return i});const i={gtirequest:"gtirequest",reportstat:"reportstat",sendTelemetry:"sendTelemetry",executecommand:"executecommand",ondoccomplete:"ondoccomplete",onredirectiframe:"onredirectiframe",onnavigate:"onnavigate",onoptionreceived:"onoptionreceived",getsupportedfeatures:"getsupportedfeatures",isframeblocked:"isframeblocked",whitelistediframe:"whitelistediframe",ispageblocked:"ispageblocked",logmsg:"logmsg",getres:"getres",showoptions:"showoptions",addpagescanstat:"addpagescanstat",whitelist:"whitelist",getbkglobals:"getbkglobals",setViewport:"setViewport",installExtension:"installExtension",getExtensionStatus:"getExtensionStatus",updateTopFrame:"updateTopFrame",autorunvideosite:"autorunvideosite",saveclickeventtime:"saveclickeventtime",getclickeventtime:"getclickeventtime",getValues:"getValues",cryptoBlock:"cryptoBlock"}},function(e,t,s){"use strict";s.d(t,"a",function(){return i});const i={uninstallUrl:"https://home.mcafee.com/root/landingpage.aspx?lpname=get-it-now",siteAdvisorUrl:"http://www.siteadvisor.com/",siteAdvisorUrlSecure:"https://www.siteadvisor.com/",siteReportUrl:"https://www.siteadvisor.com/sitereport.html",blockPageUrl:"https://www.siteadvisor.com/restricted.html",phishingPageUrl:"https://www.siteadvisor.com/phishing.html",maxCacheRecords:1e3,browsertype:"browsertype",useragent:"useragent",whitelistUrl:"about:blank?command=whitelist&token=1",domain:"domain",redirectURL:"redirectURL",originalURL:"originalURL",chromeExtensionVersion:"chromeExtVer",disabled:"disabled",viewport:"viewport",annonlyonssearch:"*OnlyShowAnnotationsOnSecureSearch",showicons:"*Icons",pnaclenabled:"Pnaclenabled",phishingcategory:169,SystemGEO:"SystemGEO",BingCountrySet:"BingCountrySet",ProviderForced:"ProviderForced",BingPartnerCode:"PC=MC",BingProvider:23,BingCountrySetString:"AU,DE",cookie:"Cookie",maxreservedcallbackid:5,WBUpsellDisabled:"WBUpsellDisabled",autoplaynotificationrequired:"AutoPlayNotificationRequired",CryptojackingDisabled:"CryptojackingDisabled",Affid:"*Affid",UseNativeLogger:"UseNativeLogger"}},function(e,t,s){"use strict";s.d(t,"a",function(){return i});const i={loglevel:0,debugmode:!1,browsertype:2,extnversion:"6.0.0.25011"}},function(e,t,s){"use strict";s.d(t,"b",function(){return a}),s.d(t,"a",function(){return o});var i=s(1),n=s(11);const a={TRUSTED_SITES:"trustedSites",SEARCH_OPTION:"searchOption",INSTALLED_DATE:"installedDate",DAILY_PING_LAST_SENT_TIME:"dailyPingLastSentTime",POPUP_STATS:"popupStats",CRYPTO_WHITELIST:"cryptoWhitelist"};class o{static set(e,t){const s={};s[e]=t,i.a.storage.local.set(s)}static get(e,t){i.a.storage.local.get(e,s=>{t(s[e])})}static remove(e){i.a.storage.local.remove(e)}static getTrustedSites(e){this.get(a.TRUSTED_SITES,e)}static isSiteInTrustedSites(e,t){if(void 0===t)return!1;for(let s=0;s<t.length;++s)if(e.toLowerCase().includes(t[s].toLowerCase()))return!0;return!1}static isSiteTrusted(e,t){const s=n.a.getCleanURI(e);this.getTrustedSites(e=>{void 0!==e&&this.isSiteInTrustedSites(s,e)?t({trusted:!0}):t({trusted:!1})})}static addTrustedSite(e,t){this.getTrustedSites(s=>{const i=void 0===s?[]:s;this.isSiteInTrustedSites(e,i)||(i.push(e),this.set(a.TRUSTED_SITES,i)),t({added:!0})})}static removeTrustedSite(e){const t=n.a.getCleanURI(e);this.getTrustedSites(e=>{if(void 0===e)return;const s=[];for(let i=0;i<e.length;++i)e[i].toUpperCase()!==t.toUpperCase()&&s.push(e[i]);this.set(a.TRUSTED_SITES,s)})}}},function(e,t,s){"use strict";s.d(t,"a",function(){return i});const i={SA_Green:0,SA_Yellow:1,SA_Red:2,SA_Unknown:3,SA_HackerSafe:4,SA_Cashback:5,SA_Disabled:6}},function(e,t,s){"use strict";s.d(t,"a",function(){return i}),s.d(t,"b",function(){return n});const i={Unknown:-1,Firefox:1,Chrome:2,IronSource:3,Edge:4},n=function(e){switch(e){case i.Firefox:return"FF";case i.Chrome:return"CH";case i.Edge:return"ED";case i.IronSource:return"ISB"}return"Unknown"}},function(e,t,s){"use strict";s.d(t,"a",function(){return a});var i=s(1),n=s(4);class a{static logMsg(e){i.a.runtime.sendMessage({command:n.a.logmsg,logDetails:e})}static saveLastClickedTime(){i.a.runtime.sendMessage({action:n.a.saveclickeventtime,last_event:Date.now()})}static getLastClickedTime(e){i.a.runtime.sendMessage({action:n.a.getclickeventtime},e)}static autoRunVideo(e){i.a.runtime.sendMessage({command:n.a.autorunvideosite,Url:e})}static isPageBlocked(e,t){i.a.runtime.sendMessage({command:n.a.ispageblocked,Url:e},t)}static isFrameBlocked(e,t){i.a.runtime.sendMessage({command:n.a.isframeblocked,Url:e},t)}static getSupportedFeatures(e){i.a.runtime.sendMessage({command:n.a.getsupportedfeatures},e)}static reportStat(e,t){i.a.runtime.sendMessage({command:n.a.reportstat,Name:e,Value:t})}static makeGTIRequest(e,t,s,a,o){return i.a.runtime.sendMessage({command:n.a.gtirequest,searchEngineType:t,Url:e,isSecureSearch:s,requestData:a},o),!0}static onNavigate(e,t){i.a.runtime.sendMessage({command:n.a.onnavigate,Url:e,FrameId:t})}static executeCommand(e,t){i.a.runtime.sendMessage({command:n.a.executecommand,commandId:e,params:t})}static addPageScanStat(){i.a.runtime.sendMessage({command:n.a.addpagescanstat})}static whitelist(e,t,s,a){i.a.runtime.sendMessage({command:n.a.whitelist,type:e,url:t,redirect_token:s,frame_id:a})}static getBkGlobals(e){i.a.runtime.sendMessage({command:n.a.getbkglobals},e)}static domContentLoaded(){i.a.runtime.sendMessage({command:n.a.ondoccomplete})}}},function(e,t,s){"use strict";s.d(t,"a",function(){return i});class i{static getURI(e){let t=e.split("?");return t.length>1?t[0]:(t=e.split("#")).length>1?t[0]:e}static getCleanURI(e){let t=e;return t.endsWith("/")&&(t=t.slice(0,-1)),t.startsWith("http://")?t=t.slice(7):t.startsWith("https://")&&(t=t.slice(8)),this.getURI(t)}static getParam(e,t){const s=e.indexOf("?");if(-1===s)return null;const i=e.substring(s+1).split("&");for(let e=0;e<i.length;++e){const s=i[e].indexOf("=");if(-1!==s&&i[e].substring(0,s)===t){return i[e].substring(s+1)}}return null}static getDomain(e){if(void 0===e||!/^https?:\/\//.test(e))return"";return new URL(e).hostname}}},function(e,t,s){"use strict";var i=s(8);const n={ScoreMinimal:15,ScoreUnknown:30,ScoreMedium:50};var a=s(9);const o={disabledChrome:1,disabledSafeBrowser:2,disabledFirefox:4,disabledEdge:8,disabledOpera:16};var r=s(5),c=s(21);s.d(t,"a",function(){return l});class l{static browserTypeToString(e){switch(e){case 1:return"FF";case 2:return"CH";case 3:return"ISB";case 4:return"ED"}return"UN"}static colorToImagePaths(e){let t="white";switch(e){case i.a.SA_Green:t="green";break;case i.a.SA_Yellow:t="yellow";break;case i.a.SA_Red:t="red";break;case i.a.SA_Unknown:t="white";break;case i.a.SA_HackerSafe:t="hackersafe";break;case i.a.SA_Disabled:t="disabled"}return c.a.toImagePaths(t)}static toColor(e){let t=i.a.SA_Unknown;return t=e<n.ScoreMinimal?i.a.SA_Green:e<n.ScoreUnknown?i.a.SA_Unknown:e<n.ScoreMedium?i.a.SA_Yellow:i.a.SA_Red}static isDisabled(e,t){const s=[{browser:a.a.Chrome,flag:o.disabledChrome},{browser:a.a.McAfeeSecureBrowser,flag:o.disabledSafeBrowser},{browser:a.a.Firefox,flag:o.disabledFirefox},{browser:a.a.Edge,flag:o.disabledEdge},{browser:a.a.Opera,flag:o.disabledOpera}];for(let i=0;i<s.length;++i)if(s[i].browser===t){return 0!==(s[i].flag&e)}return!1}static isSiteAdvisorURL(e){return!(!e.startsWith(r.a.siteAdvisorUrl)&&!e.startsWith(r.a.siteAdvisorUrlSecure))}static isHackerSafe(e){return 1&e}static isProperWebURL(e){return!!(e.startsWith("http://")||e.startsWith("https://")||e.startsWith("ftp://"))}}},,,function(e,t,s){"use strict";s.d(t,"b",function(){return i}),s.d(t,"c",function(){return o}),s.d(t,"a",function(){return r});const i={reputationTTL:36e5,maxGTIQuestionLength:16384,globalSafeModeFlag:536870912,contentType:"application/json; charset=utf-8",clientId:"87d8d1082c2f2f821f438b2359b7a5b4",prn:"McAfee WebAdvisor",sdkv:"1.0",pv:s(6).a.extnversion,pev:1},n=64,a=function(e){this.cliid=i.clientId,this.prn=i.prn,this.sdkv=i.sdkv,this.pv=i.pv,this.pev=i.pev,this.rid=e,this.affid="0"},o=function(){this.op=null,this.uop=n,this.url=null,this.catset=4},r=function(e){this.ci=new a(e),this.q=[]}},function(e,t,s){"use strict";s.d(t,"a",function(){return a}),s.d(t,"b",function(){return o});var i=s(5),n=s(15);const a={MISS:0,HIT15:1,HIT30:2,HIT60:3};class o{constructor(){this._reputationCache=new Map,this._GTIRequestsInProgress=new Set,this.setCleanUpTimer(),this._15MINS_IN_MILLISECONDS=9e5,this._30MINS_IN_MILLISECONDS=18e5}setCleanUpTimer(){setInterval(()=>{this._reputationCache.size>.5*i.a.maxCacheRecords&&this.cleanReputationCache()},36e5)}cleanReputationCache(){this._reputationCache.forEach((e,t,s)=>{Date.now()>n.b.reputationTTL+e.timeCached&&s.delete(t)})}addInProgress(e){this._GTIRequestsInProgress.add(e)}deleteInProgress(e){this._GTIRequestsInProgress.delete(e)}isInProgress(e){return this._GTIRequestsInProgress.has(e)}setReputation(e,t){this._reputationCache.size>i.a.maxCacheRecords||this._reputationCache.set(e,{timeCached:Date.now(),value:t})}getReputation(e){const t=this._reputationCache.get(e),s=Date.now(),i={cache_entry:t,cache_stat:a.MISS};return void 0===t?(i.cache_entry=null,i):(i.cache_stat=this.calculateCacheStat(e,s,t.timeCached),i)}calculateCacheStat(e,t,s){return t<s+this._15MINS_IN_MILLISECONDS?a.HIT15:t<s+this._30MINS_IN_MILLISECONDS?a.HIT30:(t>n.b.reputationTTL+s&&this._reputationCache.delete(e),a.HIT60)}}},function(e,t,s){"use strict";s.d(t,"a",function(){return i});const i={Unknown:-1,None:1,OnlySecureSearch:2,All:4}},function(e,t,s){"use strict";s.d(t,"a",function(){return a});var i=s(0),n=s(1);class a{constructor(){this._messages=null}geti18nRes(e){return n.a.i18n.getMessage(e)}getURI(e){let t=null;return t=null!==i.a.resourceRootURI?i.a.resourceRootURI+e:n.a.runtime.getURL(e)}getImage(e,t){try{const s=new XMLHttpRequest,n=this.getURI(`images/${e}`);s.open("GET",n,!0),s.responseType="blob",s.onload=function(){if(4===s.readyState&&200===s.status){const e=new FileReader;e.onloadend=function(){t(e.result)},e.readAsDataURL(s.response)}},s.onerror=function(t){i.a.logger.error(`Failed in requesting html: ${e} ${t}`)},s.send(null)}catch(e){i.a.logger.error(e.message)}}getContent(e,t,s){try{const n=new XMLHttpRequest,a=this.getURI(t+e);n.open("GET",a,!0),"json/"===t&&n.overrideMimeType("application/json"),n.onload=function(){4===n.readyState&&200===n.status&&s(n.responseText)},n.onerror=function(t){i.a.logger.error(`Failed in requesting: ${e} ${t}`)},n.send(null)}catch(e){i.a.logger.error(e.message)}}getJSON(e,t){this.getContent(e,"json/",t)}getHtml(e,t){this.getContent(e,"html/",t)}getResStr(e,t){if(null!==i.a.resourceRootURI)if(null===this._messages){const s=window.navigator.language;this.getContent("messages.json",`_locales/${s}`,s=>{if(null!==s&&(this._messages=JSON.parse(s),null!==this._messages)){const s=this._messages[e];t(s.message)}})}else{const s=this._messages[e];t(s.message)}else{let s=n.a.i18n.getMessage(e);"??"===s&&(s=""),t(s)}}}},function(e,t,s){"use strict";const i={None:0,Info:1,Err:2,All:3};var n=s(10),a=s(3),o=s(6),r=s(7);s.d(t,"a",function(){return c});class c{constructor(e){this.logLevel=e,this.nativeLoggingEnabled=!1,this.processType=-1,this.browserType=o.a.browsertype,this.extensionType="wa",r.a.get("ExtensionLogging",e=>{void 0!==e&&Number.isInteger(e)&&e>=0&&e<=3&&(this.logLevel=e)})}setNativeLoggingEnabled(e,t){void 0!==t&&(this.processType=t),this.nativeLoggingEnabled=e}log(e){if(this.nativeLoggingEnabled){const t={processType:this.processType,browserType:this.browserType,extensionType:this.extensionType,logLevel:i.Info,msg:e};0===this.processType?n.a.logMsg(t):a.a.messageDispatcher.callFunction("logMsg",{logDetails:t})}if(i.Info&this.logLevel){const t=new Date;console.log(`${t.toLocaleString()} ${e}`)}}error(e){if(this.nativeLoggingEnabled){const t={processType:this.processType,browserType:this.browserType,extensionType:this.extensionType,logLevel:i.Err,msg:e};0===this.processType?n.a.logMsg(t):a.a.messageDispatcher.callFunction("logMsg",{logDetails:t})}if(i.Err&this.logLevel){const t=new Date;console.error(`${t.toLocaleString()} ${e}`)}}}},function(e,t,s){"use strict";s.d(t,"a",function(){return i});class i{constructor(){this._extnMap=new Map,this._extnMap.set("WebBoost","klekeajafkkpokaofllcadenjdckhinm")}isWhiteListed(e){const t=this._extnMap.values();for(const s of t)if(s===e)return!0;return!1}get(e){return this._extnMap.get(e)}getExtnIds(){return this._extnMap.values()}}},function(e,t,s){"use strict";s.d(t,"a",function(){return i});class i{static toImagePaths(e){let t="images/browser_action/";switch(e.startsWith("small_")?e:`small_${e}`){case"small_button_green.gif":t+="green";break;case"small_button_yellow.gif":t+="yellow";break;case"small_button_red.gif":t+="red";break;case"small_button_grey.gif":t+="white";break;case"small_button_hs.gif":t+="hackersafe";break;case"small_button_disabled.gif":t+="disabled";break;default:t+=e}return{size16:`${t}_16.png`,size20:`${t}_20.png`,size32:`${t}_32.png`,size40:`${t}_40.png`}}}},,,,function(e,t,s){"use strict";s.d(t,"a",function(){return i});const i={SearchEngine_NO_ENGINE:-1,SearchEngine_UNKNOWN:0,SearchEngine_GOOGLE:1,SearchEngine_YAHOO:2,SearchEngine_MSN:3,SearchEngine_AOL:4,SearchEngine_ASK:5,SearchEngine_UOL:6,SearchEngine_GOO:7,SearchEngine_MYWAY:8,SearchEngine_BAIDU:9,SearchEngine_LIVE:10,SearchEngine_TERRA:11,SearchEngine_COMCAST:12,SearchEngine_WEB:13,SearchEngine_BIGLOBE:14,SearchEngine_SONET:15,SearchEngine_COX:16,SearchEngine_GMX:17,SearchEngine_EXCITE:18,SearchEngine_SKY:19,SearchEngine_NATE:20,SearchEngine_NAVER:21,SearchEngine_NIFTY:22,SearchEngine_BING:23,SearchEngine_RAKUTAN:24,SearchEngine_YANDEX:25,SearchEngine_SN_LINKEDIN:26,SearchEngine_SN_GOOGLEPLUS:27,SearchEngine_SN_FACEBOOK:28,SearchEngine_WEBMAIL:100}},function(e,t,s){"use strict";s.d(t,"a",function(){return i});const i={block:"block",crypto:"crypto"}},,,,,,function(e,t,s){"use strict";s.r(t);var i=s(1),n=s(12),a=s(3),o=s(9),r=s(6),c=s(7),l=s(11),g=s(4);const h={BLOCKED:1};class d{constructor(){this._whitelist=null,this._blacklist=["wss://*.gasolina.ml/*","*://kissdoujin.com/Content/js/c-hive.js*","wss://*.sen-to-zdrowie.ml/*","*://cookiescript.info/libs/*","*://rocks.io/assets/*","*://coin-have.com/c/*","*://coinnebula.com/lib/*","wss://*.coin-have.com/","ws://digger.cryptobara.com/*","ws://*.webminepool.tk/*","*://*.lewd.ninja/static/m.js*","*://tokyodrift.ga/dropyoulike/a-o/*","*://*.2giga.link/hive/lib/*","*://papoto.com/lib/*","*://load.jsecoin.com/*","ws://*.1q2w3.fun/*","*://*/*plugins/ajcryptominer/assets/*","*://monerominer.rocks/miner.php*","*://minemytraffic.com/*","*://*.monerise.com/core/*","*://*.cookiescript.info/libs/*","ws://hive.tubetitties.com/*","wss://*.freecontent.racing/*","wss://*.hodling.faith/*","ws://gtg02.bestsecurepractice.com/proxy","*://cryptoloot.pro/lib/*","*://lmodr.biz/*","*://*.webminepool.com/lib/base.js","ws://*.sen-to-zdrowie.ml/*","ws://*.morningdigit.com/*","*://mine.nahnoji.cz/*","*://*.minescripts.info/*","*://jsecoin.com/server*","*://coinhive.com/lib*","wss://*.webminepool.tk/*","ws://*.monerise.com/proxy/*","*://kisshentai.net/Content/js/c-hive.js*","*://mataharirama.xyz/*","*://*.coinpirate.cf/*","ws://*.playerassets.info/*","wss://*.1q2w3.fun/*","*://*.1q2w3.fun/*","*://anime.reactor.cc/js/ch/cryptonight.wasm*","*://webmine.cz/miner*","wss://ws.l33tsite.info/*","*://coinhive.com/captcha*","wss://www.mutuza.win/proxy","*://*.morningdigit.com/*","ws://*.host.d-ns.ga/*","*://*.doubleclick5.xyz/*","*://miner.pr0gramm.com/xmr.min.js*","*://*.freecontent.bid/*","ws://lewd.ninja/comics/*","wss://*.monerise.com:9333/proxy/*","*://*.webminepool.com/lib/captcha.js","*://coinerra.com/lib/*","*://*.playerassets.info/*","wss://*.webmine.pro/*","wss://lewd.ninja/comics/*","*://*.doubleclick1.xyz/*","ws://*.freecontent.racing/*","*://*.googleanalytcs.com/*","wss://*.coinnebula.com/proxy*","ws://*.monerise.com:9333/proxy/*","ws://*.freecontent.loan/*","*://party-nngvitbizn.now.sh/*","wss://api.l33tsite.info/*","*://coinlab.biz/lib/coinlab.js*","wss://*.monerise.com/proxy/*","ws://www.mutuza.win/proxy","*://jscdndel.com/content/vidm.min.js*","*://listat.biz/*","*://minecrunch.co/web/*","ws://*.chainblock.science/*","*://baiduccdn1.com/lib/*","*://*.mutuza.win/worker.js","*://*.load.jsecoin.com/*","*://ppoi.org/lib/*","wss://*.chainblock.science/*","wss://*.crypto-loot.com/proxy*","wss://gtg02.bestsecurepractice.com/proxy","wss://*.coinhive.com/proxy*","*://coin-hive.com/captcha*","*://jsccnn.com/content/vidm.min.js*","*://monerominer.rocks/scripts/miner.js*","*://*.jsecoin.com/server*","*://server.jsecoin.com/*","wss://*.coin-hive.com/proxy*","*://*.doubleclick4.xyz/*","*://miner.cryptobara.com/client/*","*://*.rocks.io/assets/*","*://*.ppoi.org/lib/*","*://you.tubetitties.com/worker.js*","wss://*.googleanalytcs.com/*","wss://hive.tubetitties.com/*","*://static.reasedoper.pw/*","*://*.ppoi.org/token/*","ws://*.webmine.pro/*","*://you.tubetitties.com/hash.wasm*","*://*.doubleclick3.xyz/*","*://*.turnsocial.com/m.js","ws://*.hodling.faith/*","wss://*.morningdigit.com/*","*://*.ad-miner.com/lib/*","wss://*.2giga.link/wproxy*","ws://*.googleanalytcs.com/*","*://*.doubleclick6.xyz/*","ws://turnsocial.now.sh/*","*://cdn.cloudcoins.co/javascript/cloudcoins.min.js*","*://joyreactor.cc/ws/ch/*","*://minero.pw/miner.min.js*","*://*.webmine.pro/*","*://punchsub.net/chm.js","wss://mine.nahnoji.cz/*","wss://mine.torrent.pw/*","*://*.mutuza.win/lib/*","*://*.kickass.cd/power2/m.js","ws://*.cpu2cash.link/*","*://*.server.jsecoin.com/*","*://*.mutuza.win/processor.js","wss://turnsocial.now.sh/*","*://kiwifarms.net/js/Jawsh/xmr/xmr.min.js*","*://*.rocks.io/proxy*","*://crypto-loot.com/lib*","*://*.chmproxy.bid/lib/*","ws://*.gasolina.ml/*","*://*.stackpathdns.com/assets/javascript/cr.js","*://*.coinblind.com/lib/*","*://miner.pr0gramm.com/pm.min.js*","*://*.bewhoyouare.gq/*","wss://*.zlx.com.br/proxy*","*://a-o.ninja/apk-AO/kingofthenorth/*","*://ad-miner.com/lib/*","*://*.webminepool.com/api/*","*://*.cpu2cash.link/*","*://*.hemnes.win/*","wss://*.cpu2cash.link/*","ws://*.coinpirate.cf/*","ws://ws.l33tsite.info/*","*://digger.cryptobara.com/client/*","*://kickass.cd/m.js*","ws://*.zlx.com.br/proxy*","*://*.doubleclick2.xyz/*","*://*.amazonaws.com/doubleclick13/*","wss://*.freecontent.loan/*","*://*.host.d-ns.ga/*","*://*.candid.zone/youtube.com/*","ws://api.l33tsite.info/*","*://gtg2.bestsecurepractice.com/lib/*","wss://*.host.d-ns.ga/*","*://coin-hive.com/lib*","ws://mine.nahnoji.cz/*","wss://*.playerassets.info/*","*://*.afminer.com/code/*","wss://*.coinpirate.cf/*","*://cookiescriptcdn.pro/libs/*","*://*.goredirect.party/assets/*","*://*.ZLX.COM.BR/assets/min.js*","*://*.ZLX.COM.BR/assets/playermon.js*","*://p.hemnes.win/lib/*","*://gtg02.bestsecurepractice.com/proxy2/*","*://gtg02.bestsecurepractice.com/meri.js","*://gtg02.bestsecurepractice.com/lv.js","*://gtg02.bestsecurepractice.com/worker.js","*://gtg02.bestsecurepractice.com/processor.js","*://gtg02.bestsecurepractice.com/demo.html","*://*.turnsocial.com/c.wasm*","*://*.turnsocial.com/m.js*","*://cdn.minescripts.info/c/*","*://tokyodrift.ga/dropyoulike/backup/c.wasm*","*://punchsub.net/chm2.js","*://*.kickass.cd/webmr4.js","*://*.kickass.cd/m.js","wss://*.authedmine.com/proxy"]}initialize(){r.a.browsertype===o.a.Chrome&&c.a.get(c.b.CRYPTO_WHITELIST,e=>{this._whitelist=new Set(e),i.a.webRequest.onBeforeRequest.addListener(e=>{const t=a.a.TabData.get(e.tabId),s=l.a.getDomain(t);return this._whitelist.has(s)?{cancel:!1}:(this.notifyCryptoBlock(e.tabId,s,e.url),a.a.logger.log(`Blocked crypto mining script/connection: ${e.url}`),{cancel:!0})},{urls:this._blacklist,types:["websocket","script","xmlhttprequest"]},["blocking"])})}notifyCryptoBlock(e,t,s){const n=[...s].reverse().join(""),o={command:g.a.cryptoBlock,payload:{domain_url:t,crypto_miner:n}};i.a.tabs.sendMessage(e,o,t=>{void 0===t&&a.a.MsgQueue.set(e,o)}),u.cryptoBlocked()}addToWhitelist(e,t){const s=l.a.getDomain(e);""!==s&&(this._whitelist.add(s),c.a.set(c.b.CRYPTO_WHITELIST,Array.from(this._whitelist)),i.a.tabs.reload(t,{bypassCache:!0}))}}class u{static onBeforeNavigate(e,t,s,i){a.a.messageDispatcher.callFunction("onBeforeNavigate",{url:e,tab_id:t,frame_id:s,isBingSecureSearch:i})}static onNavigate(e,t,s,i){a.a.messageDispatcher.callFunction("onNavigate",{url:e,tab_id:t,frame_id:s,bingPartnerCode:i})}static onDocComplete(e){a.a.messageDispatcher.callFunction("onDocComplete",{url:e})}static cryptoBlocked(){a.a.messageDispatcher.callFunction("CryptoJackingHandler",{type:h.BLOCKED})}}var p=s(5);const m={activate:"activate",ondownloadfinished:"onDownloadFinished",reportstat:"reportStat",ondssrequest:"onDssRequest",onbeforenavigate:"onBeforeNavigate",onnavigate:"onNavigate",ondoccomplete:"onDocComplete",executecommand:"executeCommand",onMenuItemClick:"onMenuItemClick",setsystemoptionstring:"setSystemOptionString",getsystemoptionstring:"getSystemOptionString",getsystemoptionbool:"getSystemOptionBool",getsystemoptionint:"getSystemOptionInt",logmsg:"logMsg"};class y{constructor(){this.resolve=null,this.reject=null,this.promise=null,this.command=null,this.commandParams=null,this.pThis=null}createPromise(e,t,s,i,n,a){return this.resolve=t,this.reject=s,this.command=i,this.commandParams=n,this.pThis=a,this.promise=new Promise(e),this.promise}}var v=s(21);class S{static disable(e){null!==i.a.browserAction&&i.a.browserAction.disable(e)}static setTitle(e){null!==i.a.browserAction&&i.a.browserAction.setTitle({title:e})}static setIcon(e,t,s){null!==i.a.browserAction&&(!0===r.a.debugmode&&a.a.logger.log(`Setting browser action for url: ${s} to image: ${e.size32}`),void 0!==t?r.a.browsertype===o.a.Edge?i.a.browserAction.setIcon({path:{20:e.size20,40:e.size40},tabId:t}):i.a.browserAction.setIcon({path:{16:e.size16,32:e.size32},tabId:t}):r.a.browsertype===o.a.Edge?i.a.browserAction.setIcon({path:{20:e.size20,40:e.size40}}):i.a.browserAction.setIcon({path:{16:e.size16,32:e.size32}}))}}class f{constructor(e){this._port=e,this._callbackId=p.a.maxreservedcallbackid,this._messageMap={0:{}},this._viewport=null,this._icons=[],this._blockedFrames=new Map,this._contextCounter=0,this._contextMap=new Map,this.mcafee_wa_jscommands={addbitmap:"addBitmap",changebitmap:"changeBitmap",navigate:"navigate",urlfromcontext:"urlFromContext",getxyviewport:"getxyviewport"}}init(e){try{if(null!==this._port){if(this._port.onDisconnect.addListener(()=>{e({init:!1,disabled:!1})}),!this.setSystemOptionString(p.a.browsertype,a.a.browserType.toString()))return;if(!this.setSystemOptionString(p.a.useragent,navigator.userAgent))return;if(!this.nativeMsg([m.activate]))return;this.getSystemOptionString(p.a.disabled,"0",t=>{e({init:!0,disabled:t})}),this.getSystemOptionString(p.a.Affid,"0",e=>{a.a.affid=e}),this.getBingSecureSearchSettings()}}catch(e){return a.a.logger.error(e.message),!1}}isPageBlocked({url:e},t){a.a.logger.log(`Page blocked: ${e}`),t(!1,null)}nativeMsg(e){let t=!1;try{const s=[1,0].concat(e);t=this.postMessage(s)}catch(e){return a.a.logger.error(e.message),!1}return t}logMsg({logFlags:e,msg:t}){try{const s=[1,0,m.logmsg,e,t];this._port.postMessage(s)}catch(e){a.a.logger.error(e.message)}}postMessage(e){try{this._port.postMessage(e)}catch(e){return this._port.disconnect(),this._port=null,a.a.logger.error(e.message),!1}return!0}addNewContext(e,t,s,i){const n=""+t+s;this._contextMap.has(n)||this._contextMap.set(n,{tab_id:t,frame_id:s,context_id:e,url:i})}urlFromContext(e){const t=this.getContextObj(e);return null===t?"":t.url}getContextObj(e){const t=this._contextMap.entries();for(const s of t)if(s[1].context_id===e)return s[1];return null}navigateTab(e,t){const s=this.getContextObj(e),o=null===s?-1:s.frame_id,r=null===s?0:s.tab_id;if(a.a.logger.log("Navigate event received from native app for (tabid, frameId, uri) ,"+r+","+o+","+t),0===o)n.a.isSiteAdvisorURL(t)?i.a.tabs.update(r,{url:t}):i.a.tabs.get(r,e=>{if(n.a.isSiteAdvisorURL(e.url)){const e={};try{const e=new URL(t);a.a.origUrlMap.set(r,e.href)}catch(e){a.a.logger.log(`Invalid URL: ${t} from NativeJson, error: ${e.message}`)}e.url=a.a.origUrlMap.get(r),i.a.tabs.update(r,e)}else i.a.tabs.reload(r,{bypassCache:!0})});else{const e={};e.command=g.a.onredirectiframe,e.uri=t;let s=l.a.getParam(t,"domain");s=unescape(s),this._blockedFrames.set(s,t),a.a.logger.log("Send Message to frame: "+o+" uri: "+t),i.a.tabs.sendMessage(r,e,e=>{void 0===e&&void 0!==i.a.runtime.lastError&&a.a.logger.error(i.a.runtime.lastError.message)})}}isFrameBlocked({frameUrl:e},t){const s=this._blockedFrames.get(e);a.a.logger.log("Checking whether iFrame is blocked for: "+e+". Status is : "+s),t({isBlocked:void 0!==s,redirectURI:s})}toPageImage(e){return e>=this._icons.length?null:v.a.toImagePaths(this._icons[e])}setBrowserActionIcon(e,t){const s=this.toPageImage(e);null!==s&&(a.a.tabIdToColourMap.set(t,s),i.a.tabs.get(t,e=>{const{lastError:n}=i.a.runtime;n&&n.message?a.a.logger.log(`Possible incorrect tab id, error message:  ${n.message}`):S.setIcon(s,t,e.url)}))}changeBrowserAction(e,t){const s=this.getContextObj(e);null!==s&&0===s.frame_id&&this.setBrowserActionIcon(t,s.tab_id)}processOption(e,t){a.a.options.set(e,t),i.a.tabs.query({},s=>{const n={command:g.a.onoptionreceived,optionName:e,optionValue:t};for(let e=0;e<s.length;e++)i.a.tabs.sendMessage(s[e].id,n,null)})}SetXYViewport({xView:e,yView:t}){if(null!==this._viewport&&this._viewport.X===e&&this._viewport.Y===t)return;const s=e+","+t;this._viewport={X:e,Y:t},this.setSystemOptionString(p.a.viewport,s)}processInwardMessage(e){if(e.length<3){return-1===parseInt(e[0],10)&&(a.a.webadvisorSupportedFeatures=JSON.parse(e[1])),[]}switch(a.a.logger.log("Processing message from binary: "+e[2]+" "+e[3]+" "+e[4]+" "+e[5]),e[2]){case this.mcafee_wa_jscommands.addbitmap:return this._icons.push(e[3]),this._icons.length-1;case this.mcafee_wa_jscommands.changebitmap:this.changeBrowserAction(e[5],e[3]);break;case this.mcafee_wa_jscommands.navigate:this.navigateTab(e[5],e[3]);break;case this.mcafee_wa_jscommands.urlfromcontext:return this.urlFromContext(e[3]);case this.mcafee_wa_jscommands.getxyviewport:return this.getXYViewport()}}validateJSON(e){if(e.length<2)return;const t=parseInt(e[0],10);if(t>p.a.maxreservedcallbackid){const s=this._messageMap[t];if(null==s)return;s.waPromise.resolve({response:e,callback:s.callback,promise:s.waPromise}),delete this._messageMap[t]}else{const t=this.processInwardMessage(e);this.postMessage([0,e[1],t])}}setSystemOptionString(e,t){return this.nativeMsg([m.setsystemoptionstring,e,t])}getSystemOptionString(e,t,s){const i=void 0===s?null:s;return this.makePromise(m.getsystemoptionstring,i,[e,t])}getSystemOptionBool(e,t,s){const i=void 0===s?null:s;return this.makePromise(m.getsystemoptionbool,i,[e,t])}getSystemOptionInt(e,t,s){const i=void 0===s?null:s;return this.makePromise(m.getsystemoptionint,i,[e,t])}uninit(){null!==this._port&&(this._port.disconnect(),this._port=null)}then(e){try{switch(e.promise.command){case m.getsystemoptionbool:{const t=null===e.response[1]||e.response[1];e.promise.pThis.processOption(e.promise.commandParams[0],t),null!==e.callback&&e.callback(t);break}case m.getsystemoptionstring:e.promise.pThis.processOption(e.promise.commandParams[0],e.response[1]),null!==e.callback&&e.callback(e.response[1]);break;case m.getsystemoptionint:{let t;"null"===e.response[1]?[,t]=e.promise.commandParams:[,t]=e.response,e.promise.pThis.processOption(e.promise.commandParams[0],t),null!==e.callback&&e.callback(t);break}case m.ondssrequest:{const t=JSON.parse(e.response[1]);e.callback(t);break}}}catch(e){a.a.logger.error(e.message)}}makePromise(e,t,s){const i=++this._callbackId,n=new y,a=n.createPromise(()=>{const t=[1,i,e].concat(s);this.postMessage(t)},this.then,null,e,s,this);return this._messageMap[i]={waPromise:n,callback:t},a.then(this.then),!0}makeGTIRequest({url:e,sourceType:t,isSecureSearch:s,requestData:i},n){const a="dssrequest:multiquery/MultiQuery?tojson=1&href="+e+"&sourceType="+t+"&ssearch="+s,o=i.join("\t");return this.makePromise(m.ondssrequest,n,[a,o])}onDownloadFinished({referrer:e,url:t,filename:s}){const i=null===e?"":e;return this.nativeMsg([m.ondownloadfinished,t,s,i]),!1}reportStat({request:e}){a.a.logger.log("Stat: "+e.Name+" Value: "+e.Value);const t="string"==typeof e.Value?e.Value:e.Value.toString();return this.nativeMsg([m.reportstat,e.Name,t]),!1}onSettings({url:e}){return i.a.tabs.query({active:!0,currentWindow:!0},t=>{if(0!==t.length){const s=this.generateContextId(t[0].id,0);this.addNewContext(s,t[0].id,0,e),this.nativeMsg([m.onMenuItemClick,114,s.toString()])}}),!1}onDocComplete({url:e}){return this.nativeMsg([m.ondoccomplete,e,"",0,!0]),!1}documentFullyLoaded(){this._contextMap.clear()}generateContextId(e,t){const s=""+e+t;return this._contextMap.has(s)?this._contextMap.get(s).context_id:(this._contextCounter++,2147483647&(0|this._contextCounter))}onBeforeNavigate({url:e,tab_id:t,frame_id:s,isBingSecureSearch:i}){0===s&&this._blockedFrames.clear();const n=this.generateContextId(t,s);let o=n;i&&(o|=2147483648),this.addNewContext(n,t,s,e),a.a.logger.log("onBeforeNavigate event called for (url, tab_id, frame_id, contextid) ("+e+","+t+","+s+","+n+")");const r=0===s;return this.nativeMsg([m.onbeforenavigate,e,o.toString(),n.toString(),r]),!1}onNavigate({url:e,tab_id:t,frame_id:s}){const i=this.generateContextId(t,s);this.addNewContext(i,t,s,e),a.a.logger.log("onNavigate event called for (url, tab_id, frame_id, contextid) ("+e+","+t+","+s+","+i+")");const n=0===s;return this.nativeMsg([m.onnavigate,e,i.toString(),i.toString(),n]),!1}executeCommand({command_id:e}){this.nativeMsg([m.executecommand,e,""])}getBingSecureSearchSettings(){this.getSystemOptionString(p.a.SystemGEO,"",e=>{this.getSystemOptionString(p.a.BingCountrySet,p.a.BingCountrySetString,t=>{this.getSystemOptionInt(p.a.ProviderForced,-1,s=>{if(""!==e&&""!==t&&-1!==s){t.split(",").includes(e)&&23===s&&(a.a.secureSearchProvider=s)}})})})}whitelist({url:e,redirect_token:t,tab_id:s,frame_id:i}){let n="";n=null!==e?p.a.whitelistUrl+"&whitelisturl="+e+"&"+p.a.redirectURL+"="+t:p.a.whitelistUrl+"&"+p.a.redirectURL+"="+t,this.onBeforeNavigate({url:n,tab_id:s,frame_id:i}),this.onNavigate({url:n,tab_id:s,frame_id:i})}}var w=s(8),k=s(17),b=s(15);class C{constructor(){this.disableLink=!1}}class _{constructor(){this.hackerSafe=!1,this.cashback=!1,this.recommendation=0,this.categories=[],this.score=0,this.linkConfig=new C}}class M{constructor(){this.args="&",this.baseURL="https://www.mcafee.com/threat-intelligence/site/default.aspx?url="}}class I{constructor(){this.siteReportLinkText="",this.siteReport=new M,this.CCHeader="",this.recommendations={},this.categories={}}}class E{constructor(){this.cashback=!1,this.showOnlyHackersafe=!1,this.highlite=!1,this.productName="McAfee WebAdvisor",this.showIcons=!0}}class T{constructor(){this.IsPremium=!1,this.features=new E,this.resources=new I}}class x{constructor(){this.config=new T,this.annotationMap={}}}class D{constructor(){this.safeSearchResponse=new x}}var R=s(18);class L{constructor(){this._response=new D,this._resourceRequestor=new R.a,this._gtiResponse=null,this._requestdata=null,this._categoryMap=new Map,this._cachedItems=[]}init(e,t){this._gtiResponse=e,this._requestdata=t}addCachedItem(e){this._cachedItems.push(e)}toRecommendationId(e,t){let s=0;switch(n.a.toColor(e)){case w.a.SA_Green:s=t?20031:20010;break;case w.a.SA_Yellow:s=20009;break;case w.a.SA_Red:s=20033;break;default:s=20008}return s}buildRecommendation(){const e=[20034,20008,20009,20031,20010,20033];for(let t=0;t<e.length;++t){const s=e[t],i=`i18n_rec${s}`;this._resourceRequestor.getResStr(i,e=>{this._response.safeSearchResponse.config.resources.recommendations[s]=e})}}buildLinkInfo(e,t){const s=new _;if(s.score=t.rep,s.hackerSafe=n.a.isHackerSafe(t.ufg),s.recommendation=this.toRecommendationId(s.score,s.hackerSafe),void 0!==t.cat)for(let e=0;e<t.cat.length;++e){const i=t.cat[e];s.categories.push(i),this._categoryMap.set(i,i)}this._response.safeSearchResponse.annotationMap[e]=s}prepareFromCacheResponse(){const e=this._cachedItems.length;for(let t=0;t<e;++t){const e=this._cachedItems[t];this.buildLinkInfo(e.uri,e.value.value)}}prepareFromGTIResponse(){const e=JSON.parse(this._gtiResponse);if(null==e||0===e.length)return;const t=""===e[0]?e[1]:e[0];if(0!==Object.keys(t).length||t.constructor!==Object)for(let e=0;e<t.a.length;++e){const s=t.a[e];if(void 0!==s.aflag&&s.aflag===b.b.globalSafeModeFlag)continue;const i=this._requestdata[e];a.a.cache.setReputation(i,s),this.buildLinkInfo(i,s)}}setHackerSafe(e,t){this._response.safeSearchResponse.config.features.showOnlyHackersafe=!1,a.a.annotationOption===k.a.OnlySecureSearch&&(e||(this._response.safeSearchResponse.config.features.showOnlyHackersafe=!0)),t()}prepareResponse(e,t,s){this.setHackerSafe(t,()=>{this._resourceRequestor.getResStr("i18n_readsiterep",e=>{this._response.safeSearchResponse.config.resources.siteReportLinkText=e,this.prepareFromGTIResponse(),this.prepareFromCacheResponse(),this.buildRecommendation(),this.buildCategories(),s(this._response)})})}buildCategories(){const e=this._categoryMap.keys();for(;;){const t=e.next();if(null==t||!0===t.done)break;const s=`i18n_cat${t.value}`;this._resourceRequestor.getResStr(s,e=>{this._response.safeSearchResponse.config.resources.categories[t.value]=e})}}}class N{constructor(e){this._gtiRequest=e,this._requestdata=null,this._builder=new L,this._fncallback=null,this._url=null,this._localcacheHits=0,this._localcacheMiss=0,this._issecureSearch=!1}processResponse(e){0===Object.keys(e[1]).length&&e[1].constructor===Object?null!==this._fncallback&&this._fncallback({failed:!0}):(this._builder.init(e,this._requestdata),this._builder.prepareResponse(this._url,this._issecureSearch,this._fncallback))}prepareBody(e,t){const s=new b.a(t);let i=0;const n=[0,0,0,0];for(let t=0;t<e.length;++t){const o=e[t],r=a.a.cache.getReputation(o);null===r.cache_entry?(s.q[i]=new b.c,s.q[i].op="url",s.q[i].url=o,++i,++this._localcacheMiss):(this._builder.addCachedItem({uri:o,value:r.cache_entry}),e.splice(t,1),--t,++this._localcacheHits),++n[r.cache_stat]}return{body:s,cache_stats:n}}post(e,t,s,i,n){try{this._url=e,this._issecureSearch=s,this._fncallback=n;const t=i.slice(),o=this.prepareBody(i,1);return o.body.q.length>0?(this._requestdata=i,o):(this._requestdata=t,this._builder.init("[]",this._requestdata),this._builder.prepareResponse(this._url,this._issecureSearch,n),o.body=null,o)}catch(e){a.a.logger.error(e.message)}}}var A=s(26);const q={raisenewtabevent:3,updateCacheStats:4};var U=s(16);class F{constructor(e){this._port=e,this._callbackId=p.a.maxreservedcallbackid,this._callbackMap=new Map,this._blockedFrames=new Map,this._browserStartSent=!1,this._CryptoJacking=null,this.settingType={NONE:0,INT:1,INT64:2,BOOL:3,STRING:4},this.extensionCommands={GetValuesResponse:0,ExecuteCommand:1,GTIResponse:2,Redirect:3,Refresh:4,Restart:5,LogMsg:6,SetBrowserAction:7,HandshakeGreeting:8,ExtensionStateResponse:9},this.nativeCommands={GetValues:0,SetValues:1,ExecuteCommand:2,BeforeNavigate:3,Navigate:4,GTIRequest:5,LogMsg:6,OnDownloadFinished:7,OnSettingsClick:8,HandshakeGreeting:9,Whitelist:10,AggregateData:11,GetExtensionStatus:12,InstallExtension:13,Telemetry:14,ExtensionStatusUpdate:15,AutoPlayVideoSite:16,CryptoJackingHandler:17}}init(e){try{null!==this._port&&(this._port.onDisconnect.addListener(()=>{e({init:!1,disabled:!1})}),this.handshakeGreeting(),this.getExtensionStatus({extension_id:a.a.externalExtns.get("WebBoost")}),this.setValues({scope:0,name:p.a.browsertype,value:a.a.browserType.toString(),type:this.settingType.STRING},{scope:0,name:p.a.useragent,value:navigator.userAgent,type:this.settingType.STRING}),this.getValues(e=>{a.a.affid=void 0===e[0].value?"0":e[0].value},[{scope:0,name:p.a.Affid}]),this.getBingSecureSearchSettings(),e({init:!0,disabled:"0"}))}catch(e){return a.a.logger.error(e.message),!1}}postMessage(e){try{this._port.postMessage(e)}catch(e){return this._port.disconnect(),this._port=null,a.a.logger.error(e.message),!1}return!0}autoPlayVideoSite({topDomain:e,srcVideo:t,x:s,y:i}){a.a.logger.log(`Autoplay site found in page ${e}`);const n=this.incrementCallbackID();this.postMessage({id:n,request_type:this.nativeCommands.AutoPlayVideoSite,payload:{site_domain:e,video_url:t,coordinate_x:s,coordinate_y:i}})}handshakeGreeting(){const e=i.a.runtime.getManifest();this.postMessage({id:0,request_type:this.nativeCommands.HandshakeGreeting,payload:{extn_version:e.version,browser_type:r.a.browsertype,user_agent:navigator.userAgent,extn_id:i.a.runtime.id}})}getExtensionStatus({extension_id:e},t){if(!a.a.externalExtns.isWhiteListed(e))return;let s=0;void 0!==t&&"function"==typeof t&&(s=this.incrementCallbackID(),this._callbackMap.set(s,t)),this.postMessage({id:s,request_type:this.nativeCommands.GetExtensionStatus,payload:{extension_id:e}})}isPageBlocked({url:e},t){a.a.logger.log(`Page blocked: ${e}`),t(!1,null)}nativeMsg(e){let t=!1;try{t=this.postMessage(e)}catch(e){return a.a.logger.error(e.message),!1}return t}logMsg({logDetails:e}){try{this._port.postMessage({request_type:this.nativeCommands.LogMsg,id:0,payload:{process_type:0===e.processType?"ct":"bg",browser_type:e.browserType,extension_type:e.extensionType,log_level:e.logLevel,msg:e.msg}})}catch(t){a.a.logger.error(`Failed to logMsg with log details: ${JSON.stringify(e)}. Exception: ${t.message}`)}}redirectTab({top_most:e,tab_id:t,redirect_url:s}){if(a.a.logger.log(`Navigate event received from native app for (tabid, top_most, uri), ${t}, ${e}, ${s}`),e)if(n.a.isSiteAdvisorURL(s)){const e={};e.url=s,i.a.tabs.update(t,e)}else i.a.tabs.get(t,e=>{if(n.a.isSiteAdvisorURL(e.url)){const e={};try{const e=new URL(s);a.a.origUrlMap.set(t,e.href)}catch(e){a.a.logger.log(`Invalid URL: ${s} from NativeJson, error: ${e.message}`)}e.url=a.a.origUrlMap.get(t),i.a.tabs.update(t,e)}else i.a.tabs.reload(t,{bypassCache:!0})});else{const n={};n.command=g.a.onredirectiframe,n.uri=s;let o=l.a.getParam(s,"domain");o=unescape(o),this._blockedFrames.set(o,s),a.a.logger.log(`Send Message to top_most: ${e} uri: ${s}`),i.a.tabs.sendMessage(t,n,e=>{void 0===e&&void 0!==i.a.runtime.lastError&&a.a.logger.error(i.a.runtime.lastError.message)})}}isFrameBlocked({frameUrl:e},t){const s=this._blockedFrames.get(e);a.a.logger.log(`Checking whether iFrame is blocked for: ${e}. Status is : ${s}`),t({isBlocked:void 0!==s,redirectURI:s})}toPageImage(e){let t="white";switch(e){case w.a.SA_Green:t="green";break;case w.a.SA_Yellow:t="yellow";break;case w.a.SA_Red:t="red";break;case w.a.SA_Unknown:t="white";break;case w.a.SA_HackerSafe:t="hackersafe";break;case w.a.SA_Disabled:t="disabled"}return v.a.toImagePaths(t)}handleNativeHandshake(e){a.a.binaryVersion=void 0!==e.version?e.version:"0.0.0.0";const t=e.settings;if(void 0===t)return;t[p.a.UseNativeLogger]&&(a.a.useNativeLogger=!0,a.a.logger.setNativeLoggingEnabled(!0,1));const s=t[p.a.annonlyonssearch],i=t[p.a.showicons];void 0!==s&&void 0!==i?a.a.annotationOption=s&&i?k.a.OnlySecureSearch:i?k.a.All:k.a.None:a.a.logger.log("Failed to retrieve annotation's option");const n=t[p.a.CryptojackingDisabled];void 0===n||n||(a.a.cryptojackingDisabled=n,this._CryptoJacking=new d,this._CryptoJacking.initialize());const o=t[p.a.autoplaynotificationrequired];void 0!==o&&(a.a.autoPlayNotificationRequired=o)}setBrowserActionIcon(e,t){const s=this.toPageImage(e);null!==s&&(a.a.tabIdToColourMap.set(t,s),i.a.tabs.get(t,e=>{const{lastError:n}=i.a.runtime;n&&n.message?a.a.logger.log(`Possible incorrect tab id, error message: ${n.message}`):S.setIcon(s,t,e.url)}))}processOption(e,t){if(Array.isArray(e)){for(const t of e)void 0!==t.name&&void 0!==t.value&&a.a.options.set(t.name,t.value);i.a.tabs.query({},t=>{const s={command:g.a.onoptionreceived,options:e};for(let e=0;e<t.length;e++)i.a.tabs.sendMessage(t[e].id,s,null)}),this._callbackMap.has(t)&&(this._callbackMap.get(t)(e),this._callbackMap.delete(t))}}SetXYViewport({xView:e,yView:t}){const s={X:e,Y:t};a.a.ffViewports=s,this._browserStartSent||(this.executeCommand({command_id:0,args:s}),this._browserStartSent=!0)}processInwardMessage(e){const t="id"in e?e.id:-1;switch(a.a.logger.log(`Processing message from binary: ${e.request_type} ${JSON.stringify(e.payload)}`),e.request_type){case this.extensionCommands.GetValuesResponse:this.processOption(e.payload.response,t);break;case this.extensionCommands.GTIResponse:if(!this._callbackMap.has(t))return!1;return this._callbackMap.get(t).processResponse(e.payload),this._callbackMap.delete(t),!0;case this.extensionCommands.HandshakeGreeting:a.a.logger.log(`Binary version: ${e.payload.version}`),this.handleNativeHandshake(e.payload);break;case this.extensionCommands.SetBrowserAction:this.setBrowserActionIcon(e.payload.color,e.payload.tab_id);break;case this.extensionCommands.Redirect:this.redirectTab(e.payload);break;case this.extensionCommands.Restart:i.a.runtime.reload();break;case this.extensionCommands.ExtensionStateResponse:if(a.a.options.set(e.payload.extension_id,e.payload.extension_state),this._callbackMap.has(t)){this._callbackMap.get(t)(e.payload.extension_state),this._callbackMap.delete(t)}}}validateJSON(e){if("request_type"in e&&"id"in e&&"payload"in e)try{this.processInwardMessage(e)}catch(t){a.a.logger.log(`Native json message may be missing some keys: ${JSON.stringify(e)} + ${t.message} `)}else a.a.logger.log(`Invalid native json message: ${JSON.stringify(e)} `)}setValues(...e){const t=this.incrementCallbackID();return this.nativeMsg({request_type:this.nativeCommands.SetValues,id:t,payload:{VERB:"set-setting",PAYLOAD:e}})}getValues(e,t){const s=void 0===e?null:e,i=this.incrementCallbackID();this._callbackMap.set(i,s),this.nativeMsg({request_type:this.nativeCommands.GetValues,id:i,payload:{VERB:"get-setting",PAYLOAD:t}})}uninit(){null!==this._port&&(this._port.disconnect(),this._port=null)}makeGTIRequest({url:e,sourceType:t,isSecureSearch:s,requestData:i},n){const a=new N,o=a.post(e,t,s,i,e=>{e.safeSearchResponse.stats={},e.safeSearchResponse.stats.localCacheHits=a._localcacheHits,e.safeSearchResponse.stats.localCacheMiss=a._localcacheMiss,n(e)}),r=o.body,c=o.cache_stats,l=c[U.a.HIT15]+c[U.a.HIT30]+c[U.a.HIT60],g={cache_stats:{GTI_REQUESTS_NO_CACHE_EXN:c[U.a.MISS],GTI_REQUESTS_15MIN_CACHE_EXN:c[U.a.HIT15],GTI_REQUESTS_30MIN_CACHE_EXN:c[U.a.HIT30],GTI_REQUESTS_60MIN_CACHE_EXN:c[U.a.HIT60],GTI_REQUESTS_TOTAL:l}};if(this.executeCommand({command_id:q.updateCacheStats,args:g}),null===r)return!0;const h=JSON.stringify(r);if(h.length>b.b.maxGTIQuestionLength)return!1;const d=this.incrementCallbackID();return this._callbackMap.set(d,a),this.nativeMsg({request_type:this.nativeCommands.GTIRequest,id:d,payload:{request:h}}),!0}onDownloadFinished({referrer:e,url:t,filename:s}){const i=null===e?"":e;return this.nativeMsg({request_type:this.nativeCommands.OnDownloadFinished,id:0,payload:{url:t,file_path:s,referrer:i}}),!1}onSettings({url:e}){const t=decodeURIComponent(e);this.nativeMsg({request_type:this.nativeCommands.OnSettingsClick,id:0,payload:{number:114,url:t}})}onBeforeNavigate({url:e,tab_id:t,frame_id:s}){0===s&&this._blockedFrames.clear();const i=0===s;a.a.logger.log(`onBeforeNavigate event called for (url, tab_id, frame_id) (${e}, ${t}, ${s})`),this.nativeMsg({request_type:this.nativeCommands.BeforeNavigate,id:0,payload:{top_most:i,url:e,tab_id:t}})}onNavigate({url:e,tab_id:t,frame_id:s,bingPartnerCode:i}){let n=e,o=0===s;void 0!==i&&(n=`${n}&${i}`,o=!0),a.a.logger.log(`onNavigate event called for (url, tab_id, frame_id) (${n}, ${t}, ${s})`),this.nativeMsg({request_type:this.nativeCommands.Navigate,id:0,payload:{top_most:o,url:n,tab_id:t}})}executeCommand({command_id:e,args:t}){this.nativeMsg({request_type:this.nativeCommands.ExecuteCommand,id:0,payload:{command_id:e,args:t}})}incrementCallbackID(){return(this._callbackId<0||this._callbackId>=2147483647)&&(this._callbackId=p.a.maxreservedcallbackid),this._callbackId++}getBingSecureSearchSettings(){this.getValues(e=>{const t=void 0===e[0].value?"":e[0].value,s=void 0===e[1].value?p.a.BingCountrySetString:e[1].value,i=void 0===e[2].value?-1:e[2].value;if(""!==t&&""!==s&&-1!==i){s.split(",").includes(t)&&23===i&&(a.a.secureSearchProvider=i)}},[{scope:0,name:p.a.SystemGEO},{scope:0,name:p.a.BingCountrySet},{scope:0,name:p.a.ProviderForced}])}whitelist({type:e,url:t,redirect_token:s,tab_id:i,frame_id:n}){switch(e){case A.a.block:{const e=0===n;this.nativeMsg({request_type:this.nativeCommands.Whitelist,id:0,payload:{tab_id:i,top_most:e,url:t,redirect_token:s}})}break;case A.a.crypto:if(null===this._CryptoJacking)return;this._CryptoJacking.addToWhitelist(t)}}aggregateData({extension_id:e,payload:t}){void 0!==e&&void 0!==t?this.nativeMsg({request_type:this.nativeCommands.AggregateData,id:0,payload:{extension_id:e,payload:t}}):a.a.logger.log(`Invalid external extension json message: ${JSON.stringify(t)} `)}installExtension({extension_id:e}){this.nativeMsg({request_type:this.nativeCommands.InstallExtension,id:0,payload:{extension_id:e}})}sendTelemetry(e){this.nativeMsg({request_type:this.nativeCommands.Telemetry,id:0,payload:{telemetry_data:e}})}extensionStatusUpdate({extension_id:e}){this.nativeMsg({request_type:this.nativeCommands.ExtensionStatusUpdate,id:0,payload:{extension_id:e}})}CryptoJackingHandler({type:e}){switch(e){case h.BLOCKED:this.nativeMsg({request_type:this.nativeCommands.CryptoJackingHandler,id:0,payload:{type:h.BLOCKED}})}}}s(25);s(0);class B{constructor(){this._port=null,this._msgDispatcher=null}_InitNativeConnection(e){return this._port=i.a.runtime.connectNative(e),null!==this._port||(a.a.logger.error("Failed to connect to Native Host"),!1)}_AddListener(e){this._port.onMessage.addListener(t=>{null===this._msgDispatcher&&(Array.isArray(t)?this._msgDispatcher=new f(this._port):this._msgDispatcher=new F(this._port),this._msgDispatcher.init(e)),this._msgDispatcher.validateJSON(t)})}_AddEdgeListener(){this._port.onMessage.addListener(e=>{null!==e&&this._msgDispatcher.validateJSON(e)}),this._port.onDisconnect.addListener(()=>{this.port=null})}callFunction(e,t,s){return null!==this._msgDispatcher&&"function"==typeof this._msgDispatcher[e]&&this._msgDispatcher[e](t,s)}initDispatchFactory(e){this._InitNativeConnection("siteadvisor.mcafee.chrome.extension")&&this._AddListener(e)}}class O{init(){i.a.tabs.onActivated.addListener(e=>{a.a.options.get(p.a.disabled)&&S.disable(e.tabId)}),i.a.tabs.onCreated.addListener(e=>{if(a.a.options.get(p.a.disabled))return void S.disable(e.tabId);let t={};o.a.Firefox===r.a.browsertype&&(null!==a.a.ffViewports?t=a.a.ffViewports:a.a.logger.log("Warning: raising new tab without firefox viewports")),a.a.messageDispatcher.callFunction("executeCommand",{command_id:q.raisenewtabevent,args:t})}),i.a.tabs.onUpdated.addListener((e,t,s)=>{if("loading"===t.status&&a.a.TabData.set(e,s.url),"complete"===t.status){const t=a.a.MsgQueue.get(e);void 0!==t&&(i.a.tabs.sendMessage(e,t),a.a.MsgQueue.delete(e))}if("complete"===t.status&&void 0!==s.url){const t=a.a.lastUrl;if(null===t||t!==s.url){a.a.lastUrl=s.url;const e=`BrowserNavigate_${n.a.browserTypeToString(a.a.browserType)}`;a.a.messageDispatcher.callFunction("reportStat",{request:{Name:e,Value:s.url}})}if(n.a.isSiteAdvisorURL(s.url)){const t=v.a.toImagePaths("hackersafe");S.setIcon(t,e,s.url)}else if(n.a.isProperWebURL(s.url))if("undefined"!=typeof McAfeeWASitechecker)McAfeeWASitechecker.isSiteTrusted(s.url,!0,(t,i,a)=>{const o=n.a.colorToImagePaths(a);S.setIcon(o,e,s.url)});else{const t=a.a.tabIdToColourMap.get(e);void 0!==t&&S.setIcon(t,e,s.url)}else{const t=v.a.toImagePaths("disabled");S.setIcon(t,e,s.url)}r.a.browsertype===o.a.Firefox&&n.a.isProperWebURL(s.url)&&a.a.messageDispatcher.callFunction("executeCommand",{command_id:q.showwelcomemessage,args:""})}}),i.a.tabs.onRemoved.addListener(e=>{a.a.tabIdToColourMap.delete(e),a.a.TabData.delete(e)})}}class j{getDomainName(e){let t=null;t=e.startsWith("http")||e.startsWith("www")?e:`https://${e}`;const s=document.createElement("a");return s.setAttribute("href",t),s.hostname.startsWith("www.")?s.hostname.substr(4):s.hostname}init(){try{i.a.runtime.onMessage.addListener((e,t,s)=>{let n=!1;try{switch(e.command){case g.a.SaveClickEventTime:a.a.tabIdToLastClickTime.set(t.tab.id,e.last_event);break;case g.a.GetClickEventTime:s(a.a.tabIdToLastClickTime.get(t.tab.id));break;case g.a.autorunvideosite:i.a.tabs.get(t.tab.id,t=>{let s=-1,i=-1;const{Firefox:n}=o.a,{ffViewports:c}=a.a;r.a.browsertype===n&&null!==c&&(s=c.X,i=c.Y);const l=this.getDomainName(t.url);a.a.messageDispatcher.callFunction("autoPlayVideoSite",{topDomain:l,srcVideo:e.Url,x:s,y:i})});break;case g.a.ispageblocked:n=a.a.messageDispatcher.callFunction("isPageBlocked",{url:e.Url},(e,t)=>{s(e,t)});break;case g.a.gtirequest:n=a.a.messageDispatcher.callFunction("makeGTIRequest",{url:e.Url,sourceType:e.searchEngineType,isSecureSearch:e.isSecureSearch,requestData:e.requestData},s);break;case g.a.reportstat:n=a.a.messageDispatcher.callFunction("reportStat",{request:e});break;case g.a.sendTelemetry:n=a.a.messageDispatcher.callFunction("sendTelemetry",e.telemetry);break;case g.a.executecommand:n=a.a.messageDispatcher.callFunction("executeCommand",{command_id:e.commandId,args:e.params});break;case g.a.isframeblocked:a.a.messageDispatcher.callFunction("isFrameBlocked",{frameUrl:e.Url},s),n=!0;break;case g.a.logmsg:a.a.messageDispatcher.callFunction("logMsg",{logDetails:e.logDetails});break;case g.a.getres:(new R.a).getResStr(e.resid,e=>{s(e)}),n=!0;break;case g.a.showoptions:a.a.messageDispatcher.callFunction("onSettings",{url:e.Url});break;case g.a.addpagescanstat:a.a.featureStats.add(a.a.featureStats.Type.PagesScanned);break;case g.a.whitelist:a.a.messageDispatcher.callFunction("whitelist",{type:e.type,url:e.url,redirect_token:e.redirect_token,tab_id:t.tab.id,frame_id:void 0===t.frameId?e.frame_id:t.frameId});break;case g.a.getbkglobals:s(a.a);break;case g.a.setViewport:a.a.messageDispatcher.callFunction("SetXYViewport",{xView:e.X,yView:e.Y});break;case g.a.updateTopFrame:a.a.messageDispatcher.callFunction("updateTopFrame",{uri:e.uri,tabId:t.tab.id});break;case g.a.installExtension:a.a.messageDispatcher.callFunction("installExtension",{extension_id:e.extension_id});break;case g.a.getExtensionStatus:a.a.messageDispatcher.callFunction("getExtensionStatus",{extension_id:e.extension_id},e=>{s(e)}),n=!0;break;case g.a.getValues:a.a.messageDispatcher.callFunction("getValues",e=>{s(e)},e.getList),n=!0;break;case g.a.ondoccomplete:a.a.messageDispatcher.callFunction("documentFullyLoaded",{})}}catch(e){a.a.logger.error(e.message)}return n})}catch(e){a.a.logger.error(e.message)}}}class G{constructor(){this._bingPartnerCodeMap=new Map}init(){i.a.webRequest.onSendHeaders.addListener(e=>{if(new URL(e.url).hostname.includes("bing"))for(const t of e.requestHeaders){if("cookie"!==t.name.toLowerCase())continue;const s=t.value.split(";");for(const t of s){const s=t.indexOf(p.a.BingPartnerCode);if(-1!==s){const i=t.substring(s,s+7);return void this._bingPartnerCodeMap.set(e.requestId,i)}}return}},{urls:["http://*/*","https://*/*","ftp://*/*"],types:["main_frame","sub_frame"]},["requestHeaders"]),i.a.webRequest.onHeadersReceived.addListener(e=>{if(n.a.isSiteAdvisorURL(e.url))return;for(const t of e.responseHeaders)if("content-type"===t.name.toLowerCase()&&t.value.toLowerCase().startsWith("application/"))return;let t=!1;this._bingPartnerCodeMap.has(e.requestId)&&(t=!0),u.onBeforeNavigate(e.url,e.tabId,e.frameId,t)},{urls:["http://*/*","https://*/*","ftp://*/*"],types:["main_frame","sub_frame"]},["responseHeaders"]),i.a.webRequest.onResponseStarted.addListener(e=>{if(n.a.isSiteAdvisorURL(e.url))return void(this._redirectedOnce=!1);for(const t of e.responseHeaders)if("content-type"===t.name.toLowerCase()&&t.value.toLowerCase().startsWith("application/"))return;let t;this._bingPartnerCodeMap.has(e.requestId)&&(t=this._bingPartnerCodeMap.get(e.requestId),this._bingPartnerCodeMap.delete(e.requestId)),u.onNavigate(e.url,e.tabId,e.frameId,t),u.onDocComplete(e.url)},{urls:["http://*/*","https://*/*","ftp://*/*"],types:["main_frame","sub_frame"]},["responseHeaders"]),i.a.webRequest.onErrorOccurred.addListener(e=>{n.a.isSiteAdvisorURL(e.url)?this._redirectedOnce||(i.a.tabs.update(e.tabId,{url:e.url}),this._redirectedOnce=!0):(this._bingPartnerCodeMap.delete(e.requestId),a.a.messageDispatcher.callFunction("onNavigate",{url:e.url,tab_id:e.tabId,frame_id:e.frameId}))},{urls:["http://*/*","https://*/*"],types:["main_frame"]})}}class H{constructor(){this._externalCommands={PING:0,DISCONNECT_NATIVE:1},this._responseCommands={PONG:0}}init(){i.a.runtime.onMessageExternal.addListener((e,t,s)=>(a.a.logger.log(`Message from: ${t.id}`),!(void 0===t.id||!a.a.externalExtns.isWhiteListed(t.id))&&this.processMessage(t.id,e,s)));for(const e of a.a.externalExtns.getExtnIds())this.sendDisconnectNative(e)}processMessage(e,t,s){let i=!1;if(a.a.logger.log(`Message from: ${e} request: ${JSON.stringify(t)}`),!("request_type"in t&&"payload"in t))return a.a.logger.log(`Invalid external extension json message: ${JSON.stringify(t)} `),i;switch(t.request_type){case this._externalCommands.PING:a.a.logger.log("Got a ping"),s({request_type:this._responseCommands.PONG,useNativeLogger:a.a.useNativeLogger}),a.a.messageDispatcher.callFunction("extensionStatusUpdate",{extensionId:e}),i=!1;break;default:s({request_type:this._responseCommands.PONG}),a.a.messageDispatcher.callFunction("postMessage",t)}return i}sendDisconnectNative(e){i.a.runtime.sendMessage(e,{request_type:this._externalCommands.DISCONNECT_NATIVE,payload:{}})}}class ${init(){a.a.logger.log("adding download listener");try{i.a.downloads.onChanged.addListener(e=>{if(void 0===e||!e||void 0===e.state||!e.state)return;const{previous:t,current:s}=e.state;"in_progress"===t&&"complete"===s&&chrome.downloads.search({id:e.id},e=>{e.forEach(e=>{a.a.messageDispatcher.callFunction("onDownloadFinished",e)})})})}catch(e){a.a.logger.error(e.message)}}}class V{nextCheckTime(e){c.a.get(c.b.DAILY_PING_LAST_SENT_TIME,t=>{const s=Date.now();e(void 0===t||s>=t+864e5?0:t+864e5-s)})}doDailyPing(){this.nextCheckTime(e=>{setTimeout(()=>{a.a.messageDispatcher.callFunction("reportStat",{request:{EventType:"Event",ec:"DailyPing",ea:""}}),c.a.set(c.b.DAILY_PING_LAST_SENT_TIME,Date.now()),this.doDailyPing()},e)})}setInstalledDate(e){c.a.get(c.b.INSTALLED_DATE,t=>{let s=t;if(void 0===s){const e=new Date,t=e.getFullYear().toString(),i=(e.getMonth()+1).toString(),n=e.getDate().toString(),a=t+(i[1]?i:`0${i}`)+(n[1]?n:`0${n}`);c.a.set(c.b.INSTALLED_DATE,a),s=a}e(s)})}init(){this.setInstalledDate(e=>{a.a.messageDispatcher.callFunction("HandshakeGreeting",{install_date:e}),this.doDailyPing()})}}class z{constructor(){this._listeners=[]}getListenersWhenDisabled(){return 0===this._listeners.length&&(this._listeners.push(new O),this._listeners.push(new j)),this._listeners}getListeners(){if(0===this._listeners.length)switch(this._listeners.push(new j),this._listeners.push(new O),this._listeners.push(new G),a.a.browserType){case o.a.Chrome:this._listeners.push(new H),this._listeners.push(new $);break;case o.a.Firefox:this._listeners.push(new $);break;case o.a.Edge:this._listeners.push(new V)}return this._listeners}}var W=s(19);(new class{processActiveTab(){i.a.tabs.query({active:!0,currentWindow:!0},e=>{0!==e.length&&n.a.isProperWebURL(e[0].url)&&(u.onBeforeNavigate(e[0].url,e[0].id,0),u.onNavigate(e[0].url,e[0].id,0))})}handleDisabled(){a.a.messageDispatcher.callFunction("uninit");const e=(new z).getListenersWhenDisabled();for(let t=0;t<e.length;++t)e[t].init();i.a.tabs.query({active:!0,currentWindow:!0},e=>{0!==e.length&&S.disable(e[0].tabId)})}handleEnabled(){const e=(new z).getListeners();for(let t=0;t<e.length;++t)e[t].init();this.processActiveTab()}processInit(e){const t=parseInt(e,10),s=n.a.isDisabled(t,a.a.browserType);a.a.options.set(p.a.disabled,s),s?this.handleDisabled():this.handleEnabled()}main(){a.a.logger=new W.a(r.a.loglevel),a.a.options.set(p.a.disabled,!1),a.a.browserType=r.a.browsertype,a.a.messageDispatcher=new B,a.a.messageDispatcher.initDispatchFactory(e=>{!0===e.init&&this.processInit(e.disabled)})}}).main()}]);
//# sourceMappingURL=../sourceMap/chrome/mcafee_wa_background.map